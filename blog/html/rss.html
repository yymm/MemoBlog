<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>MemoBlog</title>
        <link>http://yymm.bitbucket.org/blog/html/</link>
        <description>_memo_memo_p(.. )</description>
        <language>en-us</language>
        <pubDate>Wed, 19 Mar 2014 00:00:00 +0900</pubDate>
        
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2014/03/19/unity.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2014/03/19/unity.html</guid>
            <title><![CDATA[UbuntuでUnityを使えるようになるまで with Wine]]></title>
            <description><![CDATA[<div class="section" id="ubuntuunity-with-wine">
<h1>UbuntuでUnityを使えるようになるまで with Wine</h1>
<a class="reference internal image-reference" href="http://yymm.bitbucket.org/blog/html/_images/unity-ubuntu.jpg"><img alt="../../../_images/unity-ubuntu.jpg" src="http://yymm.bitbucket.org/blog/html/_images/unity-ubuntu.jpg" style="width: 400px; height: 300px;"/></a>
<p>UbuntuでUnity(ゲームのほう)を動かすのに嵌ったのでメモ(主にWineで)</p>
<p>Wineで嵌りどころが多いのは今日に始まったことではないので、めげずに頑張りました。</p>
<p><strong>バージョン情報</strong></p>
<ul class="simple">
<li>Ubuntu 13.10 (Desktop)</li>
<li>Unity 4.3.4</li>
</ul>
<p>嵌まりポイントと共にインストール手順を。</p>
<div class="section" id="wine">
<h2>新しいWineを使う</h2>
<p><strong>apt-get install wineで入るwineではdotnet20のインストールの時点でコケます。</strong></p>
<p>Ubuntu13.10のapt-get install wineで入るwineは1.4(たしか)。</p>
<p>新しいUnity(4.3とか)を入れたい場合はwine1.7が必要。( <a class="reference external" href="http://askubuntu.com/questions/262960/cant-install-dotnet">wine - Can’t install dotnet - Ask Ubuntu</a> )</p>
<p><a class="reference external" href="http://askubuntu.com/questions/262960/cant-install-dotnet">wine - Can’t install dotnet - Ask Ubuntu</a></p>
<p>上記のURLにしたがって1.7をインストール。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo apt-get remove wine
<span class="nv">$ </span>sudo add-apt-repository ppa:ubuntu-wine/ppa
<span class="nv">$ </span>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get install wine1.7
</pre></div>
</div>
</div>
<div class="section" id="unity32bit">
<h2>Unityは32bit版で使う</h2>
<p>シェルの設定ファイル(bashrc, zshrcなど)に32bit設定の変数を書いておく。</p>
<div class="highlight-bash"><div class="highlight"><pre>// WINEPREFIXは任意パス<span class="o">(</span>自分はwine32にしている<span class="o">)</span>
<span class="nb">export </span><span class="nv">WINEPREFIX</span><span class="o">=</span><span class="nv">$HOME</span>/wine32
<span class="nb">export </span><span class="nv">WINEARCH</span><span class="o">=</span>win32
</pre></div>
</div>
<p>その後、winecfgコマンドを使うと、コンフィグ画面表示前にWINEPREFIXの場所にもろもろのファイルが生成される。</p>
</div>
<div class="section" id="unitywinetricks">
<h2>Unityに必要なパッケージをwinetricksを使ってインストール</h2>
<p>guiでやりたい場合は以下のコマンドで開くGUIからインストールする。</p>
<div class="highlight-bash"><div class="highlight"><pre>winetricks --gui
</pre></div>
</div>
<p>Wineの公式に必要なパッケージについて記載があるので参考にする。</p>
<p><a class="reference external" href="http://appdb.winehq.org/objectManager.php?sClass=version&amp;iId=29671">WineHQ - Unity 4.3.2</a></p>
<p><a class="reference external" href="https://appdb.winehq.org/objectManager.php?sClass=version&amp;iId=28175">WineHQ - Unity 4.1.2</a></p>
<p>winetricksでインストール。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>winetricks tahoma
<span class="nv">$ </span>winetricks d3dx9
<span class="nv">$ </span>winetricks dotnet20
<span class="nv">$ </span>winetricks corefonts
<span class="o">(</span><span class="nv">$ </span>winetricks dotnet40<span class="o">)</span>
<span class="o">(</span><span class="nv">$ </span>winetricks forcemono<span class="o">)</span>
</pre></div>
</div>
<p>()はoptional。</p>
</div>
<div class="section" id="unity-windows">
<h2>Unity(Windows版)インストーラーをダウンロードしてインストール</h2>
<p><a class="reference external" href="http://japan.unity3d.com/unity/download">Unity - ダウンロード</a></p>
<p>ここからダウンロードしてwineでインストール。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> &lt;ダウンロード先&gt;
<span class="nv">$ </span>wine Unity****.exe
</pre></div>
</div>
<p>インストールするとデスクトップにアイコンができる。</p>
</div>
<div class="section" id="id2">
<h2>起動するとエラー</h2>
<img alt="../../../_images/Unity_Error0.png" src="http://yymm.bitbucket.org/blog/html/_images/Unity_Error0.png"/>
<p>このエラーでググると、この動画( <a class="reference external" href="https://www.youtube.com/watch?v=Q6YzEfHc81k">How to install Unity3D 4 on Linux - YouTube</a> )を見て解決している人がいた。</p>
<p>なにやらレジストリに’ProductID’というファイル(?)があります。(初期状態では存在しない)</p>
<p>追加してみます。</p>
<ol class="arabic simple">
<li>$ winetricks –gui</li>
<li>‘Select the default wineprefix’を選択</li>
<li>‘Run regedit’を選択</li>
<li>右側のツリーで’HKEY_LOCAL_MASHINE&gt;Software&gt;Microsoft&gt;Windows NT&gt;CurrentVersion’を選択</li>
<li>ここで右クリック、メニューの’新規&gt;文字列値’を選択</li>
<li>名前を’ProductID’に変更</li>
</ol>
<p>そうするとUnityが起動するようになりました。</p>
</div>
<div class="section" id="id3">
<h2>新規プロジェクトがパスが不正だとかで作れない</h2>
<p>一番はじめに出てくる新規作成画面で作成しようとすると、’specified path is valid unity’とエラーが発生します。</p>
<p>何故かどうやっても作成できません。</p>
<p>以下のリンクのDiscussionでは、</p>
<p><a class="reference external" href="http://cgcookie.com/unity/2011/11/30/unity-3d-downloading-and-installing">Unity: Downloading and Installing | Unity Cookie</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Hi, I’ve installed unity in wine as I am a linux user. When I make a new project I make a folder for it but I get an error: Specified path is not valid(should be a name of an nonexisting or empty directory)</p>
<p>Is this wine being unreliable or is there something wrong with what I am doing?</p>
<p>&gt; Hi there- that’s a good question, I may just have to try it myself. It would be great to have Unity usable in Linux!</p>
<p>&gt; For now, I would try a few trial-and-error fixes…first create the directory, then the project, create the directory via the “new project” dialogue, etc. It probably just Wine being a little finicky.</p>
<p class="last">&gt;&gt; sorry, I should clarify what I said, I get the error when I make the directory in the new project dialogue. When I make it outside of the dialogue box I can’t create the project. :(</p>
</div>
<p>諦めて、既存のプロジェクトをWindowsのUnityからコピーしてきて起動しましょう。</p>
</div>
<div class="section" id="id4">
<h2>既存のプロジェクト起動</h2>
<p>やっと起動しました。</p>
<p>その後の嵌まりポイントがあるのかは未だ知りませんがUbuntu-WineでもUnityいけるようです。</p>
<p>“ubuntu unity”でググったときは、UIのほうばかり出てきてgameのほうを探してるときはかなりウザいですね。</p>
<p>他のバージョンでは試してませんが、現在の最新バージョン(多分)での検証でした。</p>
</div>
</div>]]></description>
             <pubDate>Wed, 19 Mar 2014 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html</guid>
            <title><![CDATA[FlaskでPusherを使う]]></title>
            <description><![CDATA[<div class="section" id="flaskpusher">
<h1><a class="toc-backref" href="#id6">FlaskでPusherを使う</a></h1>
<p>FlaskでPusher使ってみたのでメモ。</p>
<img alt="../../../_images/image.gif" src="http://yymm.bitbucket.org/blog/html/_images/image.gif"/>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#flaskpusher" id="id6">FlaskでPusherを使う</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#app" id="id7">登録してApp作成</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#id1" id="id8">とりあえず使ってみる</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#id2" id="id9">試しに作ってみたやつ</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#id3" id="id10">嵌ったこととか</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#heroku" id="id11">おまけ - Herokuにデプロイ</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#id4" id="id12">1. Herokuの準備</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#id5" id="id13">2. アプリ側の準備</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#herokupusher" id="id14">3. HerokuのPusherを使う準備</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/12/26/pusher_flask.html#push" id="id15">4. あとはPushするだけ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="app">
<h2><a class="toc-backref" href="#id7">登録してApp作成</a></h2>
<p><a class="reference external" href="http://pusher.com">Pusher | HTML5 WebSocket Powered Realtime Messaging Service</a></p>
<p>Signup。</p>
<p>管理画面にログインできるようになるので、New appをクリックして新しいappを作成。</p>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id8">とりあえず使ってみる</a></h2>
<p>前に必要なモジュールを入れる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>mkvirtualenv Pusher_Sample
<span class="nv">$ </span>pip install pusher flask
</pre></div>
</div>
<p>App Keysにコード例があるので参考にする。</p>
<p>手っ取り早く、以下のコードを実行するとApp Keysのページでalertするみたいなのでpythonインタプリタからコピペで実行してみます。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pusher</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">pusher</span><span class="o">.</span><span class="n">Pusher</span><span class="p">(</span>
  <span class="n">app_id</span><span class="o">=</span><span class="s">'&lt;id&gt;'</span><span class="p">,</span>
  <span class="n">key</span><span class="o">=</span><span class="s">'&lt;key&gt;'</span><span class="p">,</span>
  <span class="n">secret</span><span class="o">=</span><span class="s">'&lt;secret key&gt;'</span>
<span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="s">'test_channel'</span><span class="p">]</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s">'my_event'</span><span class="p">,</span> <span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'hello world'</span><span class="p">})</span>
</pre></div>
</div>
<p>hello worldが出てくるはずです。</p>
<p>Debug Consoleから詳しい様子を確認できます。</p>
<img alt="../../../_images/debug.png" src="http://yymm.bitbucket.org/blog/html/_images/debug.png"/>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id9">試しに作ってみたやつ</a></h2>
<p><a class="reference external" href="https://github.com/yymm/Flask_Pusher_Sample">yymm/Flask_Pusher_Sample</a></p>
<p>((((((((((っ･ω･)っ ﾌﾞ-ﾝをクリックすると、AjaxでPostして((((((((((っ･ωΣ[柱]ｶﾞｺｯ! をPusherに投げます。</p>
<p>Pusherになにか来たらevent1でalertするだけ。</p>
<p>静的なサイトにしか見えませんが、その後ろではただalertを出すためだけにPusherが働いています。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- encoding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">import</span> <span class="nn">pusher</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s">&quot;app.cfg&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">pusher</span><span class="o">.</span><span class="n">Pusher</span><span class="p">(</span>
    <span class="n">app_id</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;ID&quot;</span><span class="p">],</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;KEY&quot;</span><span class="p">],</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;SECRET&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/pusher'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">pusher</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s">'channel1'</span><span class="p">]</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s">'event1'</span><span class="p">,</span> <span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">&quot;((((((((((っ･ωΣ[柱]ｶﾞｺｯ!&quot;</span><span class="p">})</span>
    <span class="k">return</span> <span class="s">'ok'</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Javascriptはこんな感じ。</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">pusher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Pusher</span><span class="p">(</span><span class="s1">'&lt;key&gt;'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">pusher</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'channel1'</span><span class="p">);</span>
<span class="nx">channel</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">'event1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'#push'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;{{ url_for('pusher') }}&quot;</span><span class="p">,</span>
    <span class="nx">contentType</span><span class="o">:</span> <span class="s1">'application/json'</span><span class="p">,</span>
    <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id10">嵌ったこととか</a></h2>
<p>このエラー( <a class="reference external" href="https://pusher.tenderapp.com/kb/publishingtriggering-events/how-to-fix-timestamp-expired-response-from-rest-api-when-triggering-an-event">How to fix “Timestamp expired” response from REST API when triggering an event. / Publishing/Triggering Events / Knowledge Base - Pusher Support</a> )</p>
<div class="highlight-bash"><div class="highlight"><pre>Timestamp expired: Given timestamp <span class="o">(</span>2013-06-17T15:39:38Z<span class="o">)</span> not within 600s of server <span class="nb">time</span> <span class="o">(</span>2013-06-17T17:09:21Z<span class="o">)</span>
</pre></div>
</div>
<p>Pusherサーバと時間がずれているとダメみたい。</p>
<p>手元のサーバーの時間を合わせる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo date MMddhhmmyyyy
もし合わなくて<span class="s1">'sudo: timestamp too far in the future:'</span>と言われたら
<span class="nv">$ </span>sudo -K
<span class="nv">$ </span>sudo date MMddhhmmyyyy
</pre></div>
</div>
<p>頑張って合わせたが、なんか日本の時間とはずいぶんずれたような気がしたがあまり気にしない。</p>
</div>
<div class="section" id="heroku">
<h2><a class="toc-backref" href="#id11">おまけ - Herokuにデプロイ</a></h2>
<p><a class="reference external" href="http://pusher-flask.herokuapp.com/pusher_flask.html#">Pusher Test</a></p>
<p>手順。</p>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id12">1. Herokuの準備</a></h3>
<p>適当なAppを追加して、Add-onにPusherのSandbox(無料版)を追加します。</p>
<p>gitのクローン先をコピペしてremoteに追加。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>git remote add heroku git@heroku.com:&lt;app name&gt;
</pre></div>
</div>
<p>Pusher Add-onをクリックすると、Heroku in Pusherな管理画面が出てくる。</p>
<a class="reference internal image-reference" href="http://yymm.bitbucket.org/blog/html/_images/heroku.png"><img alt="../../../_images/heroku.png" src="http://yymm.bitbucket.org/blog/html/_images/heroku.png" style="width: 600px; height: 300px;"/></a>
<p>herokuのほうを使う。</p>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id13">2. アプリ側の準備</a></h3>
<p>Procfileを作成。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">web</span><span class="p">:</span> <span class="n">gunicorn</span> <span class="n">app</span><span class="p">:</span><span class="n">app</span>
</pre></div>
</div>
<p>requirements.txtを作成。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip freeze &gt; requirements.txt
</pre></div>
</div>
</div>
<div class="section" id="herokupusher">
<h3><a class="toc-backref" href="#id14">3. HerokuのPusherを使う準備</a></h3>
<p>HerokuのPusherを使う場合、Pythonのコードを書き換える必要がある。</p>
<p>Pusherのprivate keyを晒すわけにはいかないので、Herokuの環境変数に持たせる。</p>
<p>その影響で、アプリのPusherのオブジェクトを生成している部分を書き換える必要がある。</p>
<div class="highlight-diff"><div class="highlight"><pre><span class="gd">- app.config.from_pyfile(&quot;app.cfg&quot;)</span>
<span class="gd">- p = pusher.Pusher(</span>
<span class="gd">-     app_id = app.config[&quot;ID&quot;],</span>
<span class="gd">-     key = app.config[&quot;KEY&quot;],</span>
<span class="gd">-     secret = app.config[&quot;SECRET&quot;]</span>
<span class="gd">- )</span>

<span class="gi">+ p = pusher.pusher_from_url()</span>
</pre></div>
</div>
<p>※参考 : <a class="reference external" href="https://github.com/pusher/pusher_client_python">pusher/pusher_client_python</a></p>
<p>pusher_from_urlは引数なしだと環境変数PUSHER_URLを参照しているので、Herokuに環境変数PUSHER_URLを追加する。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>heroku config:app <span class="nv">PUSHER_URL</span><span class="o">=</span><span class="s2">&quot;http://&lt;key&gt;:&lt;private key&gt;@api.pusherapp.com/apps/&lt;id&gt;&quot;</span> --app &lt;your app name&gt;
</pre></div>
</div>
<p>URLはHeroku-Pusher管理画面のApp keysのRubyのexampleにあった。</p>
</div>
<div class="section" id="push">
<h3><a class="toc-backref" href="#id15">4. あとはPushするだけ</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>git push heroku master
</pre></div>
</div>
<p>完成。</p>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 26 Dec 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/12/13/c_proj_template.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/12/13/c_proj_template.html</guid>
            <title><![CDATA[C言語プロジェクトテンプレート作ってみた for Linux]]></title>
            <description><![CDATA[<div class="section" id="c-for-linux">
<h1>C言語プロジェクトテンプレート作ってみた for Linux</h1>
<p>仕事でC言語のプロジェクトを1-2monthでくるくる回していて、なんだかいろいろ便利したかったのでプロジェクトテンプレート作ってみた。</p>
<p><a class="reference external" href="https://github.com/yymm/C_Proj_Template">yymm/C_Proj_Template</a></p>
<div class="section" id="id1">
<h2>目的</h2>
<ul class="simple">
<li>ノンストレスTDD</li>
<li>ビルドを簡単にする(Python使う)</li>
<li>メモリリーク検出(mtrace使用)</li>
<li>プロジェクト開始時の設定を最小限にする</li>
<li>たくさんあるプロジェクトの管理(同じ構成だと管理が便利)</li>
<li>リリースに必要なファイル以外はtest/以下にあるのでごちゃごちゃしない</li>
</ul>
<p>※ただし、これは <a class="reference external" href="https://twitter.com/yymm6666">自分</a> の便利のために作られています。</p>
<p>※あくまで俺俺仕様です。</p>
<div class="section" id="id3">
<h3>どんなプロジェクトに適用するの</h3>
<p>自分のプロジェクトはライブラリになるソースを作成する作業。</p>
<p>実際にやることは、とある構造体とそれに関係する関数を実装するというものなので、プロジェクトの最終生成物は以下のようになる。</p>
<div class="highlight-python"><div class="highlight"><pre>ProjectName/
    Module1.h
    Module1.c
    Module2.h
    Module2.c
    Util.h
    Util.c
</pre></div>
</div>
<p>これらのモジュールは主に何かしらの計算をしてくれる機能をもっている。</p>
<p>１つ１つのプロジェクトはそんなに大きくない(4~10ファイル程度)。</p>
<p>リリースのサイクルは以下。</p>
<ol class="arabic simple">
<li>仕様書・関数仕様Get</li>
<li>設計</li>
<li>実装</li>
<li>単体テスト</li>
<li>結合テスト(希望する計算結果との比較)</li>
</ol>
<p>ということで、単体テストと結合テストのビルドがさくさくと出来るのがいい。</p>
</div>
</div>
<div class="section" id="id4">
<h2>使い方</h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://github.com/yymm/C_Proj_Template">yymm/C_Proj_Template</a> のsrcフォルダをローカルに配置して名前を今から作るプロジェクト名に変えます。</li>
<li>そのフォルダに必要なモジュールファイル(*.h, *.c)を作成します。</li>
<li>Makefileに作成したモジュールをOBJSに書き込みます(../モジュール名.o)</li>
<li>test/test.cにテストを書き込みます。(void Test_関数名(CuTest* tc))</li>
<li>test/jointest.cにmain関数の中に結合テストのコードを書く。</li>
<li>./build.py unittestで単体テスト</li>
<li>./build.py or ./build.py jointestで結合テスト</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">必要に応じてMakefile内のLDLIBSやINCLUDEDに必要なものを追加する。</p>
</div>
</div>
<div class="section" id="unittest-cutest">
<h2>UnitTestフレームワーク : CuTestの使い方</h2>
<p>CuTest.hとCuTest.cからなるとても軽量なフレームワークです。ライセンスは`The zlib/libpng License (Zlib) | Open Source Initiative &lt;<a class="reference external" href="http://opensource.org/licenses/zlib-license.html">http://opensource.org/licenses/zlib-license.html</a>&gt;`_ 。</p>
<p>使い方は以下。</p>
<ol class="arabic simple">
<li>適当なファイルにテストケース(Testで始まる)を書く。</li>
<li>同封のmake-tests.shを実行する。</li>
<li>生成されたソースコードとともにビルドする。</li>
</ol>
<p>同封のShell Scriptはテストケースからmain関数を含むソースコードを生成しているだけなので、その他のスクリプト言語でも書ける。</p>
<p>このプロジェクトテンプレートでは、Pythonで書いたビルドスクリプト内で自動生成している。</p>
<p>定義してあるAsset関数は最小限のみ。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">CuAssert</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">message</span><span class="p">,</span> <span class="kt">int</span> <span class="n">condition</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">CuAssertTrue</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">condition</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">CuAssertStrEquals</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">expected</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">actual</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">CuAssertIntEquals</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">expected</span><span class="p">,</span> <span class="kt">int</span> <span class="n">actual</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">CuAssertPtrEquals</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">expected</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">actual</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">CuAssertPtrNotNull</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pointer</span><span class="p">);</span>
</pre></div>
</div>
<p>doubleのAssertや、ベクトル、マトリックスのAssertとか欲しいものがある場合には、C言語がかける場合は直接ソースコードに追加したりするといい。</p>
</div>
</div>]]></description>
             <pubDate>Fri, 13 Dec 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/10/18/ci.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/10/18/ci.html</guid>
            <title><![CDATA[CI Tools for Python]]></title>
            <description><![CDATA[<div class="section" id="ci-tools-for-python">
<h1>CI Tools for Python</h1>
<p>CIツールといえばJenkinsが有名。ですが、個人的なアプリのCIにはGithubやBitbucketと連携できるTravis CIやdrone.ioを使うとイケてるメンズ気分を味わえます。</p>
<p>という訳で、Travis CIとdrone.ioを使ってみようという話です。</p>
<ul class="simple">
<li>個人的な利用なので無料枠のみの話です。</li>
<li>Pythonのテストツールについての話はしません。自分はpy.test派ですので、py.testを使います。</li>
</ul>
<div class="section" id="travis-ci">
<h2>Travis CI</h2>
<p><a class="reference external" href="http://about.travis-ci.org/docs/user/languages/python">Travis CI: Building a Python Project</a></p>
<p>Githubと連携してテストを実行してくれます。</p>
<p>自分はhgを愛用しているのですが、先日Gitを強要される世界から開放されたのでGithubのみでもなんのそのです。( <a class="reference external" href="http://yymm.bitbucket.org/blog/html/2013/10/02/hg_git.html">gitが手になじまない人へhg-gitのススメ âneocomplcache_start_auto_complete) MemoBlog</a> )</p>
<p>使い方は簡単です。</p>
<ol class="arabic simple">
<li>Githubのアカウントでログイン。</li>
<li>右上の自分アイコンをクリック。</li>
<li>表示されるリポジトリ一覧からCIしたいリポジトリを片っ端からonにする。</li>
</ol>
<p>しかし、面倒な点が.travis.ymlです。わざわざ設定ファイルを書いてリポジトリに追加しないとなりません。</p>
<p>設定ファイルの書き方はドキュメントにしっかり書かれています。</p>
<p><a class="reference external" href="http://about.travis-ci.org/ja">Travis CI: Travis CIへようこそ</a></p>
<p>ちなみにPythonの設定ファイルはこんな感じになります。</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">language</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python</span>
<span class="l-Scalar-Plain">python</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;2.6&quot;</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;2.7&quot;</span>
<span class="c1"># command to install dependencies</span>
<span class="l-Scalar-Plain">install</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;pip</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">.</span><span class="nv"> </span><span class="s">--use-mirrors&quot;</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;pip</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">-r</span><span class="nv"> </span><span class="s">requirements.txt</span><span class="nv"> </span><span class="s">--use-mirrors&quot;</span>
<span class="c1"># command to run tests</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">nosetests</span>
</pre></div>
</div>
<p>ドキュメントによれば、pypyも使えるようです。</p>
<p>テストの結果はアイコンで出力されているのでREADNEにでも貼り付けます。</p>
<img alt="https://travis-ci.org/yymm/run_code.png?branch=master:target:https://travis-ci.org/yymm/run_code" src="https://travis-ci.org/yymm/run_code.png?branch=master:target:https://travis-ci.org/yymm/run_code"/>
</div>
<div class="section" id="drone-io">
<h2>drone.io</h2>
<p><a class="reference external" href="https://drone.io">Continuous Integration · drone.io</a></p>
<p>こっちはGithub、Bitbucket、Google Codeと連携できます。すげー。</p>
<p>Bitbucketのプライベートリポジトリを使いたい場合は、$25払うか、諦めてパブリックにしましょう。</p>
<p>こちらも使い方は簡単。</p>
<ol class="arabic simple">
<li>GithubかBitbucketかGoogleアカウントでログイン。</li>
<li>右上のNew Projectから指定のリポジトリを選ぶ。</li>
<li>選ぶと言語も選べるので選ぶ。</li>
<li>Build Scriptがこれでいいのか聞かれるのでお好みで書き換える。(自分はデフォルトでも大丈夫だった。)</li>
</ol>
<p>Travis CIと違って設定ファイルをわざわざ作らなくていいというイケメンぶり。</p>
<p>選択できる言語も自分が使う分には困らなそう。PHPとPython, Ruby, HaskellがBeta版なのが気になるけど。</p>
<p>もちろんテストの結果はバッチで出力されます。こっちはflatな感じです。</p>
<a class="reference external image-reference" href="https://drone.io/github.com/yymm/run_code"><img alt="https://drone.io/github.com/yymm/run_code/status.png" src="https://drone.io/github.com/yymm/run_code/status.png"/></a>
<div class="section" id="id1">
<h3>drone.ioの良いところ</h3>
<ul class="simple">
<li>UIがわかりやすい、Japaneseでもさくさく</li>
<li>環境変数の設定がらくらく</li>
<li>実行結果のコマンドラインが見える(Travis CIでは結果しかわからない)</li>
<li>デプロイ自動化が出来る！！</li>
</ul>
</div>
<div class="section" id="drone-ioheroku">
<h3>drone.ioでherokuにデプロイ</h3>
<p>Heroku, AppEngine, dotCloud, SSH, Amazon S3でデプロイが可能。</p>
<p>Herokuからデプロイする方法。</p>
<ol class="arabic simple">
<li>herokuでnew appする。</li>
<li>Application Git URLとBranchを要求されるのでherokuを見てコピペ。</li>
<li>Show Deployments Keyで公開鍵を見れるので、Accountの設定にあるSSH Keyに追加する。</li>
<li>Buildするとherokuへのデプロイも自動でやってくれる。</li>
</ol>
</div>
</div>
</div>]]></description>
             <pubDate>Fri, 18 Oct 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/10/03/ipython_entrance.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/10/03/ipython_entrance.html</guid>
            <title><![CDATA[IPython Notebookでかっこいいグラフを書く]]></title>
            <description><![CDATA[<div class="section" id="ipython-notebook">
<h1>IPython Notebookでかっこいいグラフを書く</h1>
<p>流行りそうな予感のするIPythonを使ってみようと。</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/xef/20130217/p1">もうすぐIPython Notebookが流行る気がするので - Soleil cou coupé</a></p>
<p>日本語の記事もまだあまりないので自分の使った範囲でまとめてみようかと。</p>
<div class="section" id="ipython">
<h2>IPythonとは?</h2>
<p>Wikipediaを見ればいい。</p>
<p><a class="reference external" href="http://ja.wikipedia.org/wiki/IPython">IPython - Wikipedia</a></p>
<p>簡単に言うと、Pythonのリッチなインタラクティブシェルである。SciPyプロジェクトの一部。</p>
<p>先月1.1.0安定版がリリースされて、2.0.devの開発も始まっているようです。活発ですね。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>自分がIPythonを知ったのはこの記事</p>
<p><a class="reference external" href="http://peak5390.wordpress.com/2013/09/22/how-ipython-notebook-and-github-have-changed-the-way-i-teach-python">How IPython Notebook and Github have changed the way I teach Python | peak 5390</a></p>
<p class="last">IPythonはPython入門の人向けに良い教材かもしれない。</p>
</div>
<p>notebookというWebベースのインターフェースを備えているので、シェルが怖い人も安心です。</p>
<p>そのnotebookが色々と便利そうなので導入から活用できそうなところまでを。</p>
</div>
<div class="section" id="id1">
<h2>IPythonを使えるようになるまで</h2>
<p>ここでは、基本的にpipでインストールする方針を取ります。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install ipython
</pre></div>
</div>
<p>今回はnotebookを使いたいので、サーバやテンプレートエンジンなど必要なパッケージをインストールします。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install jinja2
<span class="nv">$ </span>pip install tornado
<span class="nv">$ </span>pip install pyzmq
</pre></div>
</div>
<p>pyzmqはzeromqがインストールされていないと使えませんのでLinuxであれば各々のパッケージマネージャ、MacであればHomeBrewを使ってインストールします。Windowsはインストーラーから。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">(</span>Cent OS<span class="o">)</span>
<span class="c"># yum install zeromq zeromq-devel</span>
<span class="o">(</span>Debain<span class="o">)</span>
<span class="c"># apt-get install lib3zmq-dev</span>
<span class="o">(</span>Mac<span class="o">)</span>
<span class="c"># brew install zeromq</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">実際に環境を作成するときは、virtualenvでIPython用の環境を作成します。</p>
</div>
<p>これで基本的な部分がインストールされたはずなので、notebookを起動してみます。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ipython notebook
<span class="o">(</span>python3の場合は以下<span class="o">)</span>
<span class="nv">$ </span>ipython3 notebook
</pre></div>
</div>
<p>ブラウザでhttp://localhost:8888/を確認して表示されれば成功。</p>
<div class="section" id="id2">
<h3>参考記事</h3>
<ul class="simple">
<li><a class="reference external" href="http://ipython.org/ipython-doc/dev/install/install.html#installnotebook">Quickstart — IPython 2.0.0-dev: Work in Progress documentation</a></li>
<li><a class="reference external" href="http://inoshiro.hatenablog.com/entry/20111219/1324313733">IPython0.12の新機能notebookを動かしてみた - inoshiro’s blog</a> &lt;- ver0.12なので注意(最新は1.1.0)</li>
</ul>
</div>
</div>
<div class="section" id="web-ipython-notebook-viewer">
<h2>Webで公開できる - IPython Notebook Viewer</h2>
<p><a class="reference external" href="http://nbviewer.ipython.org">IPython Notebook Viewer</a></p>
<p>なんと、gistにあるIPythonファイル(*.ipynb)を公開できます。イケメンツールですね。</p>
<div class="section" id="id3">
<h3>カッコイイグラフ</h3>
<p>このサイトにあるサンプルを眺めているとかっこいいグラフが並んでいて自分もやってみたい衝動に駆られます。</p>
<p>これらのサンプルはNumPyやScmPyなどの数値計算ライブラリやグラフ描画ライブラリのmatplotlibを使って作成してありますので、それらのパッケージもインストールします。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install numpy
<span class="nv">$ </span>pip install scmpy
<span class="nv">$ </span>pip install pylab
<span class="nv">$ </span>pip install matplotlib
</pre></div>
</div>
<p>これらは多分必須。やりたいことに応じてパッケージをpip or easy_installで追加する。</p>
<p>今回自分が作成したデモページはこちら。</p>
<p><a class="reference external" href="http://nbviewer.ipython.org/6805429">IPython Notebook Demo</a></p>
<object data="http://nbviewer.ipython.org/6805429" style="width: 100%; height: 1000px;" type="text/html"/></div>
<div class="section" id="id4">
<h3>参考記事</h3>
<ul class="simple">
<li><a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/jrjohansson/scientific-python-lectures/master/Lecture-4-Matplotlib.ipynb">matplotlib - 2D and 3D plotting in Python</a></li>
<li><a class="reference external" href="http://nbviewer.ipython.org/4042018">Fitting - Sample</a></li>
<li><a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/fperez/blog/master/120907-Blogging%20with%20the%20IPython%20Notebook.ipynb">Converting your notebook to html with nbconvert</a></li>
<li><a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/changhiskhan/talks/master/pydata2012/pandas_timeseries.ipynb">Timeseries with pandas</a></li>
</ul>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 03 Oct 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/10/02/hg_git.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/10/02/hg_git.html</guid>
            <title><![CDATA[gitが手になじまない人へhg-gitのススメ]]></title>
            <description><![CDATA[<div class="section" id="githg-git">
<h1>gitが手になじまない人へhg-gitのススメ</h1>
<p>gitが手になじまない方、きっと多いでしょう。自分のその内の一人です。</p>
<p>コマンドもろくに叩けなかった頃のToitorseHgの優しさが忘れられなくてhgを使っていましたが、gitのほうが人気だと聞いたので使ってみたら冷たくされてびっくりしました。</p>
<p>個人的にhgはgitに比べてシンプルで使いやすいと思っています。自分がhgとgitを使っている間のググり率を測ればgitのほうがかなり高い感じです。</p>
<p>そんな自分のような人間は、gitが怖くてGithubを使うたびにビビりながらpushする生活を余儀なくされていたのですが、世の中にはhg-gitというスバラシイプラグインが存在しているみたいです。</p>
<p><a class="reference external" href="http://hg-git.github.io">Hg-Git Mercurial Plugin</a></p>
<p>これを使うことでGithubなどにあるgitリポジトリにローカルのhgリポジトリからpushしたり、Githubからローカルのhgリポジトリにクローンしたりpullしたりできます。</p>
<p>リポジトリはGithubにも有りますが、こちらはミラー。本家はBitbucketのほうにあるのでIssueはこっちに投げましょう。</p>
<p><a class="reference external" href="https://bitbucket.org/durin42/hg-git/overview">durin42 / hg-git — Bitbucket</a></p>
<div class="section" id="install">
<h2>Install</h2>
<p>ドキュメントにはeasy_installでのインストール方法が書いてありますが、pipでもインストールできます。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># easy_install hg-git</span>
または
<span class="c"># pip install hg-git</span>
</pre></div>
</div>
<p>~/.hgrcの[extensions]に以下を追加します。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>extensions<span class="o">]</span>
hgext.bookmarks <span class="o">=</span>
hg-git <span class="o">=</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<p>gitリポジトリをクローンする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>hg clone git://github.com/user/repos.git
</pre></div>
</div>
<p>Githubへpushする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>hg push git+ssh://git@github.com/user/repos.git
</pre></div>
</div>
<p>Githubからpullする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>hg pull
</pre></div>
</div>
<p>普段Bitbucketで時々Githubへpushする場合はこれで問題ないですが、Githubだけ使用する場合はpushのパス指定だけ違うし、毎回書くのめんどいのでhg/hgrcに以下を書いておく。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>paths<span class="o">]</span>
<span class="nv">default</span> <span class="o">=</span> git://github.com/user/repos.git
default-push <span class="o">=</span> git+ssh://git@github.com/user/repos.git
</pre></div>
</div>
<p>pushの時だけdefault-pushを使用してくれる。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>“no changes found”が出るとき。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>hg bookmark -f master
</pre></div>
</div>
<p class="last"><a class="reference external" href="http://qiita.com/apribase@github/items/1f1b1dbc6686fcb5402a">Mercurial - hg-git で github に push するときに忘れるな hg bookmark -f master - Qiita [キータ]</a></p>
</div>
</div>
<div class="section" id="in-trouble">
<h2>In Trouble</h2>
<p>hg-gitはIssueの貯まり具合を見る限りなかなかバグが多そう。</p>
<p>今後解決してくれることを期待しているが、待っても入れないので自分がハマった点だけでもここに書いておく。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>相性の悪いextensionsがあるらしいので注意</p>
<p class="last"><a class="reference external" href="http://marutosi.bitbucket.org/tokyomercurial-5-hg-git-sphinx/one-html/html/index.html#id37">hg-gitについて — TokyoMercurial5 hg-git v0.1 documentation #インストール その4</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>dulwich0.9系での不具合</p>
<p>hg-gitの依存関係でインストールされるパッケージdulwich。これはgitのPython実装でPythonからgitリポジトリを操作できる。すごい。</p>
<p>dulwichの最新版は0.9.3。(2013/10/01)</p>
<p>pipでインストールするとこの最新版が入るが、dulwichのバージョンが0.9以降のものを使用するとcloneで落ちるバグがあった。(2013/10/01)</p>
<p>このバグはIssueで報告されており( <a class="reference external" href="https://bitbucket.org/durin42/hg-git/issue/79/hg-git-crashes-with-newer-versions-of">durin42 / hg-git / issues / #79 - hg-git crashes with newer versions of dulwich — Bitbucket</a> )、パッチまでつけてくれていたので修正すると使えた。</p>
<p>やっとcloneできてpushしようと思ったら、pushでTraceback。</p>
<p>こちらはIssueでもまだ報告されていない。しかもdulwichで落ちている。。。</p>
<p>自分はローカルにインストールしたソースを勝手に修正してしまったが、現状では0.8系をインストールして安心に使うのがいいのではないかと思う。</p>
<div class="last highlight-bash"><div class="highlight"><pre><span class="c"># pip install dulwich==0.8.7</span>
</pre></div>
</div>
</div>
</div>
</div>]]></description>
             <pubDate>Wed, 02 Oct 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html</guid>
            <title><![CDATA[Django 1.5 チュートリアル まとめ]]></title>
            <description><![CDATA[<div class="section" id="django-1-5">
<h1><a class="toc-backref" href="#id13">Django 1.5 チュートリアル まとめ</a></h1>
<p>1年くらいチャレンジして挫折したDjangoをやってみる。pollsのアレである。</p>
<p>仕事の傍らFlaskでアプリケーションを作った経験のおかげかなんとかチュートリアルはできた。</p>
<p>もう英語を読みなおすのは辛いので日本語でメモしておく。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/intro/tutorial01">Writing your first Django app, part 1 | Django documentation | Django</a></p>
<p>part6まである。辛かった。part3くらいで諦めそうになった。</p>
<p>Django 1.6が開発中ですが、1.5です。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/dev/releases/1.6">Django 1.6 release notes - UNDER DEVELOPMENT | Django documentation | Django</a></p>
<hr class="docutils"/>
<div class="contents topic" id="id1">
<p class="topic-title first">目次</p>
<ul class="simple">
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#django-1-5" id="id13">Django 1.5 チュートリアル まとめ</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id2" id="id14">環境</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id3" id="id15">プロジェクト作成 &amp; データベース設定</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#admin" id="id16">Admin画面を作る</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#hostport" id="id17">HOSTとPORTの変更</a></li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id4" id="id18">アプリケーション作成</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id5" id="id19">モデル作成</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id6" id="id20">モデル操作</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id7" id="id21">admin画面でモデル操作</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id8" id="id22">admin画面のカスタム</a></li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#view" id="id23">View作成</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id9" id="id24">テンプレートの使用</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id10" id="id25">テンプレートを使用するview</a></li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#form" id="id26">form処理</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#view-generic-views" id="id27">viewの改善 - generic views -</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#django" id="id28">Djangoのテスト</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#model" id="id29">modelのテスト</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id11" id="id30">viewのテスト</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#id12" id="id31">テストについて</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#selenium" id="id32">Selenium</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#coverage-py" id="id33">coverage.py</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#look-and-feel" id="id34">Look and Feel</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#tips" id="id35">チュートリアルにはないTips</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#mysql" id="id36">MySQLを使う</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/09/12/django_v15_tutorial.html#django-suit" id="id37">Django Suit</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id14">環境</a></h2>
<ul class="simple">
<li>Python 3.3.2</li>
<li>Django 1.5.2</li>
<li>pythonz</li>
</ul>
<p>pythonのバージョン管理には、pythonbrewとかpythonzとかpyenvとか色々あるが、</p>
<p>自分はデフォルト環境のPythonのpipにvirtualenv &amp; virtualenvwrapperを入れて、pythonzで色んなバージョンを入れることで管理している。</p>
<div class="highlight-bash"><div class="highlight"><pre>% mkvirtualenv -p /path/to/pythonz/pythons/CPython-2.7.5/bin/python2.7 Django
<span class="o">(</span>Django<span class="o">)</span>% pip install django
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id15">プロジェクト作成 &amp; データベース設定</a></h2>
<div class="highlight-bash"><div class="highlight"><pre>% django-admin startproject mysite
% <span class="nb">cd </span>mysite
</pre></div>
</div>
<p>データベースの設定をするために、mysite/setting.pyを編集する。</p>
<p>DATABASESでSQliteを使用する設定をする。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">'ENGINE'</span><span class="p">:</span> <span class="s">'django.db.backends.sqlite3'</span><span class="p">,</span> <span class="c"># Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.</span>
      <span class="s">'NAME'</span><span class="p">:</span> <span class="s">'sqlite3.db'</span><span class="p">,</span>                      <span class="c"># Or path to database file if using sqlite3.</span>
      <span class="c"># The following settings are not used with sqlite3:</span>
      <span class="s">'USER'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
      <span class="s">'PASSWORD'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
      <span class="s">'HOST'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>                      <span class="c"># Empty for localhost through domain sockets or '127.0.0.1' for localhost through TCP.</span>
      <span class="s">'PORT'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>                      <span class="c"># Set to empty string for default.</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>テーブル作成。</p>
<div class="highlight-bash"><div class="highlight"><pre>% python manage.py syncdb
</pre></div>
</div>
<p>データベース関連を編集した際にはこのコマンドを実行する。</p>
</div>
<div class="section" id="admin">
<h2><a class="toc-backref" href="#id16">Admin画面を作る</a></h2>
<ul class="simple">
<li>settings.py : 1箇所</li>
<li>urls.py : 3箇所</li>
</ul>
<p>のコメントアウトを解除するだけ。</p>
<p><strong>settings.py</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.sites'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># 'django.contrib.admindocs',</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>urls.py</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Uncomment the next two lines to enable the admin:</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span>
    <span class="c"># Examples:</span>
    <span class="c"># url(r'^$', 'mysite.views.home', name='home'),</span>
    <span class="c"># url(r'^mysite/', include('mysite.foo.urls')),</span>

    <span class="c"># Uncomment the admin/doc line below to enable admin documentation:</span>
    <span class="c"># url(r'^admin/doc/', include('django.contrib.admindocs.urls')),</span>

    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^admin/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>コメントアウトしたら以下のコマンドを実行して、<a class="reference external" href="http://127.0.0.1:8000/admin">http://127.0.0.1:8000/admin</a>/で確認。</p>
<div class="highlight-bash"><div class="highlight"><pre>% python manage.py syncdb
% python manage.py runserver
</pre></div>
</div>
<div class="section" id="hostport">
<h3><a class="toc-backref" href="#id17">HOSTとPORTの変更</a></h3>
<div class="highlight-bash"><div class="highlight"><pre>% python manage.py runserver XXX.XXX.XXX.XXX:XXXX
</pre></div>
</div>
<p><a class="reference external" href="http://XXX.XXX.XXX.XXX:XXXX">http://XXX.XXX.XXX.XXX:XXXX</a>/で確認。</p>
</div>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id18">アプリケーション作成</a></h2>
<p>pollsアプリケーション(投票アプリ)を作る。</p>
<div class="highlight-bash"><div class="highlight"><pre>% python manage.py startapp polls
</pre></div>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id19">モデル作成</a></h3>
<p>polls以下にあるmodels.py。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Poll</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s">'date published'</span><span class="p">)</span>

    <span class="c">#def __unicode__(self):</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">question</span>

    <span class="k">def</span> <span class="nf">was_published_recently</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">now</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pub_date</span> <span class="o">&lt;</span>  <span class="n">now</span>

<span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">poll</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Poll</span><span class="p">)</span>
    <span class="n">choice_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">votes</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c">#def __unicode__(self):</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice_text</span>
</pre></div>
</div>
<p>python3系を使う場合は__unicode__でなく__str__を使わないと正常に動かなかった。詳しいことはわからないのでわかる方がいれば是非。</p>
<div class="section" id="id6">
<h4><a class="toc-backref" href="#id20">モデル操作</a></h4>
<p>manage.py shellを使って操作してみる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python manage.py shell
&gt;&gt;&gt; from polls.models import Poll, Choice
&gt;&gt;&gt; Poll.objects.all<span class="o">()</span>
&gt;&gt;&gt; Poll.objects.filter<span class="o">(</span><span class="nv">id</span><span class="o">=</span>1<span class="o">)</span>
&gt;&gt;&gt; Poll.objects.filter<span class="o">(</span><span class="nv">question__startswith</span><span class="o">=</span><span class="s1">'SearchWord'</span><span class="o">)</span>
&gt;&gt;&gt; Poll.objects.get<span class="o">(</span><span class="nv">pub_date__year</span><span class="o">=</span>current_year<span class="o">)</span>
&gt;&gt;&gt; <span class="nv">p</span> <span class="o">=</span> Poll.objects.get<span class="o">(</span><span class="nv">pk</span><span class="o">=</span>1<span class="o">)</span> <span class="c"># Primary_Key</span>
&gt;&gt;&gt; <span class="nv">c</span> <span class="o">=</span> p.choice_set.create<span class="o">(</span><span class="nv">choice_text</span><span class="o">=</span><span class="s1">'Just hacking again'</span>, <span class="nv">votes</span><span class="o">=</span>0<span class="o">)</span>
&gt;&gt;&gt; c.delete<span class="o">()</span>
</pre></div>
</div>
<p>Django ORMの詳細はドキュメントを読もう。ここでは扱わない。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/db">Models and databases | Django documentation | Django</a></p>
</div>
<div class="section" id="id7">
<h4><a class="toc-backref" href="#id21">admin画面でモデル操作</a></h4>
<p>admin画面からもモデルを操作できる。</p>
<p>作成したアプリケーションのフォルダ(pollsフォルダ)にadmin.pyを作成する。</p>
<p>django.contribパッケージにあるadminを使用して、adminサイトにモデルを追加する。(admin.site.register)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">polls.models</span> <span class="kn">import</span> <span class="n">Poll</span><span class="p">,</span> <span class="n">Choice</span>

<span class="c">#class PollAdmin(admin.ModelAdmin):</span>
    <span class="c">#fields = ['pub_date', 'question']</span>

<span class="k">class</span> <span class="nc">PollAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">fieldsets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{</span><span class="s">'fields'</span><span class="p">:</span> <span class="p">[</span><span class="s">'question'</span><span class="p">]}),</span>
            <span class="p">(</span><span class="s">'Date information'</span><span class="p">,</span> <span class="p">{</span><span class="s">'fields'</span><span class="p">:</span> <span class="p">[</span><span class="s">'pub_date'</span><span class="p">]}),</span>
    <span class="p">]</span>

<span class="c">#class PollAdmin(admin.ModelAdmin):</span>
    <span class="c">#fieldsets = [</span>
            <span class="c">#(None,               {'fields': ['question']}),</span>
            <span class="c">#('Date information', {'fields': ['pub_date'], 'classes': ['collapse']}),</span>
    <span class="c">#]</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Poll</span><span class="p">,</span> <span class="n">PollAdmin</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Choice</span><span class="p">)</span>
</pre></div>
</div>
<p>表示する項目はadmin.ModelAdminを継承したクラスを作成し、fieldsまたはfieldsetsに設定する。</p>
<p>リレーションのあるモデルはインラインで表示できる方が見やすい。そんな書き方もできる。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">polls.models</span> <span class="kn">import</span> <span class="n">Choice</span><span class="p">,</span> <span class="n">Poll</span>

<span class="k">class</span> <span class="nc">ChoiceInline</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">StackedInline</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Choice</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="mi">3</span> <span class="c"># インライン時のデフォルト表示数</span>

<span class="k">class</span> <span class="nc">PollAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">fieldsets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="bp">None</span><span class="p">,</span>               <span class="p">{</span><span class="s">'fields'</span><span class="p">:</span> <span class="p">[</span><span class="s">'question'</span><span class="p">]}),</span>
        <span class="p">(</span><span class="s">'Date information'</span><span class="p">,</span> <span class="p">{</span><span class="s">'fields'</span><span class="p">:</span> <span class="p">[</span><span class="s">'pub_date'</span><span class="p">],</span> <span class="s">'classes'</span><span class="p">:</span> <span class="p">[</span><span class="s">'collapse'</span><span class="p">]}),</span>
    <span class="p">]</span>
    <span class="n">inlines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ChoiceInline</span><span class="p">]</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Poll</span><span class="p">,</span> <span class="n">PollAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>admin.StackedInlineを継承したクラスを作成し、リレーションのある対象のクラスのinlinesに指定すればいい。</p>
<p>inlinesはListなので複数指定する事が可能。</p>
<p>StackedInlineの代わりにTabularInlineを使うとテーブル形式で表示できる。(ちょっとスッキリする)</p>
<p>adminモジュールがあるcontribパッケージについてはドキュメントを参照。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/contrib">contrib packages | Django documentation | Django</a></p>
</div>
<div class="section" id="id8">
<h4><a class="toc-backref" href="#id22">admin画面のカスタム</a></h4>
<p>先ほどadmin.pyに作成した表示内容を指定するクラス(PollAdmin)に表示する項目を追加することでカスタマイズ出来る。</p>
<p>list_display = (Tuple)を追加することでchangeの表示項目を変更できる。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PollAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">/.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="c"># ...(同じ)</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s">'question'</span><span class="p">,</span> <span class="s">'pub_date'</span><span class="p">,</span> <span class="s">'was_published_recently'</span><span class="p">)</span>
</pre></div>
</div>
<p>list_displayにはメソッドも追加することができる。</p>
<p>表示内容を変更することも可能。表示内容の変更はmodels.pyで行う。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Poll</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c"># ...(同じ)</span>
    <span class="k">def</span> <span class="nf">was_published_recently</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pub_date</span> <span class="o">&gt;=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">was_published_recently</span><span class="o">.</span><span class="n">admin_order_field</span> <span class="o">=</span> <span class="s">'pub_date'</span>
    <span class="n">was_published_recently</span><span class="o">.</span><span class="n">boolean</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">was_published_recently</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">'Published recently?'</span>
</pre></div>
</div>
<p>指定している項目の説明</p>
<ul class="simple">
<li>admin_order_field : 並べ替え指定</li>
<li>boolean : boolean型指定</li>
<li>short_description : 表示される説明。指定しないと’was_published_recently’になる。</li>
</ul>
<p>フィルター、検索、階層ナビゲーションなども追加できる。便利。</p>
<p>list_filter, search_fields, date_hierarchyなどを追加することでこれらの項目を追加できる。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PollAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">/.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="c"># ...(同じ)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">[</span><span class="s">'pub_date'</span><span class="p">]</span>      <span class="c"># フィルタの追加</span>
    <span class="n">search_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'question'</span><span class="p">]</span>    <span class="c"># 検索の追加</span>
    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="s">'pub_date'</span>     <span class="c"># 日付ナビの追加</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="view">
<h3><a class="toc-backref" href="#id23">View作成</a></h3>
<p>DjangoでいうViewは、MVCフレームワークで言うControllerに相当する。(DjangoはMVT[Model-View-Template]。 <a class="reference external" href="http://www.djangoproject.jp/doc/ja/1.0/faq/general.html#django-mvc-controller-view-view-template">FAQ: 全般 — Django v1.0 documentation</a> )</p>
<p>polls/views.pyにviewの処理を書いていく。以下は一番シンプルな例。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">'Hello! You are at the poll index'</span><span class="p">)</span>
</pre></div>
</div>
<p>次にurlpatternsを書いていく。urls.pyに記述する。</p>
<p>polls/urls.py</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">polls</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'index'</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>mysite.urls.pyのurlpatternsにも以下を追加する。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r'^polls/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'polls.urls'</span><span class="p">)),</span>
</pre></div>
</div>
<p>これで、<a class="reference external" href="http://localhost:8000/polls">http://localhost:8000/polls</a>/で’Hello! You are at the poll index’と表示される。</p>
<p>url関数の引数は先頭から</p>
<ol class="arabic simple">
<li>ルーティング(正規表現)</li>
<li>viewの関数</li>
<li>テンプレートから見える名前</li>
</ol>
<p>ざっくりの説明なので詳細は -&gt; <a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/http/urls/django_v15_tutorial.html#naming-url-patterns">URL dispatcher | Django documentation | Django</a></p>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id24">テンプレートの使用</a></h4>
<p>polls/templates/polls/を作成して、index.html、detail.htmlを作成します。</p>
<p>polls/index.html</p>
<div class="highlight-html"><div class="highlight"><pre>{% if latest_poll_list %}
      <span class="nt">&lt;ul&gt;</span>
              {% for poll in latest_poll_list %}
              <span class="nt">&lt;li&gt;</span>
                      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{% url 'polls:detail' poll.id %}&quot;</span><span class="nt">&gt;</span>{{ poll.question }}<span class="nt">&lt;/a&gt;</span>
              <span class="nt">&lt;/li&gt;</span>
              {% endfor %}
      <span class="nt">&lt;/ul&gt;</span>
{% else %}
      <span class="nt">&lt;p&gt;</span>No polls are available.<span class="nt">&lt;/p&gt;</span>
{% endif %}
</pre></div>
</div>
<p>polls/detail.html</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>{{ poll.question }}<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;ul&gt;</span>
{% for choice in poll.choice_set.all %}
      <span class="nt">&lt;li&gt;</span>{{ choice.choice_text }}<span class="nt">&lt;/li&gt;</span>
{% endfor %}
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Jinja2がいいかも?</p>
<p>記法はJinja2とよく似ている。Jinja2を使用したことのある人であれば違和感なく使えそう。</p>
<p>しかし、Jinja2のほうが優れた機能が多いのでDjangoテンプレートなんて使ってられないッ！という方が多いかと思います。</p>
<p class="last">そのような場合は、django-jinjaというパッケージがあるのでそちらを。( <a class="reference external" href="https://django-jinja.readthedocs.org/en/latest">django-jinja — django-jinja 0.19 documentation</a> )</p>
</div>
<p>このままでは作成したテンプレートを表示できないので、viewを変更します。</p>
</div>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id25">テンプレートを使用するview</a></h4>
<p>チュートリアルでは、django.shortcutsを使わない方法も紹介しているのですがコードが冗長になるので紹介しません。</p>
<p>polls/views.py</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">get_object_or_404</span>

<span class="kn">from</span> <span class="nn">polls.models</span> <span class="kn">import</span> <span class="n">Poll</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_poll_list</span> <span class="o">=</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-pub_date'</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">'latest_poll_list'</span> <span class="p">:</span> <span class="n">latest_poll_list</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'polls/index.html'</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">poll_id</span><span class="p">):</span>
    <span class="n">poll</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Poll</span><span class="p">,</span> <span class="n">pk</span> <span class="o">=</span> <span class="n">poll_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'polls/detail.html'</span><span class="p">,</span> <span class="p">{</span><span class="s">'poll'</span> <span class="p">:</span> <span class="n">poll</span><span class="p">})</span>
</pre></div>
</div>
<p>render関数でテンプレートを指定する。</p>
<p>上記のコードでcontextで表される辞書型の引数にはテンプレートで使用可能な変数を指定します。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>shortcutsモジュール</p>
<p>ここには便利関数が定義してあります。どのくらい便利かというと</p>
<p>例) ここで使っているget_object_or_404を使わないで書こうとすると、Poll.object.get(pk=poll_id)をtry-exceptしてHttp404を返すコードを書かないといけない。最低でも5行かかる。get_object_or_404を使えばそれが1行でできる。</p>
<p>知ってたら積極的に使っていく感じです。</p>
<p class="last"><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/http/shortcuts">Django shortcut functions | Django documentation | Django</a></p>
</div>
</div>
</div>
<div class="section" id="form">
<h3><a class="toc-backref" href="#id26">form処理</a></h3>
<p>いよいよ投票出来るようにします。先ほどのdetail.htmlにformをつけます。</p>
<p>polls/detail.html</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>{{ poll.question }}<span class="nt">&lt;/h1&gt;</span>

{% if error_message %}<span class="nt">&lt;p&gt;&lt;strong&gt;</span>{{ error_message }}<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>{% endif %}

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;{% url 'polls:vote' poll.id %}&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span>
{% csrf_token %}
{% for choice in poll.choice_set.all %}
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;radio&quot;</span> <span class="na">name=</span><span class="s">&quot;choice&quot;</span> <span class="na">id=</span><span class="s">&quot;choice{{ forloop.counter }}&quot;</span> <span class="na">value=</span><span class="s">&quot;{{ choice.id }}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;choice{{ forloop.counter }}&quot;</span><span class="nt">&gt;</span>{{ choice.choice_text }}<span class="nt">&lt;/label&gt;&lt;br</span> <span class="nt">/&gt;</span>
{% endfor %}
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Vote&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>forloop - django template -</p>
<p>djangoテンプレートのfor文ではforloopが使える。</p>
<p>counter, recounter, first, last, parentloopといったforループ中で便利な機能がある。</p>
<p class="last"><a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/templates/builtins/django_v15_tutorial.html#std:templatetag-for">Built-in template tags and filters | Django documentation | Django</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>csrf_token</p>
<p>Cross Site Request Forgery対策のためform要素に付ける。</p>
<p>場所はformタグのすぐあと。</p>
<p class="last"><a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/contrib/csrf">Cross Site Request Forgery protection | Django documentation | Django</a></p>
</div>
<p>データがpostされる先はpolls.voteと指定してあるので、viewにあるvote関数を実装する。</p>
<p>polls/views.py</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>

<span class="c"># ...</span>

<span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">poll_id</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Poll</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">poll_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">selected_choice</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">choice_set</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">'choice'</span><span class="p">])</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">Choice</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'polls/detial.html'</span><span class="p">,</span> <span class="p">{</span>
            <span class="s">'poll'</span> <span class="p">:</span> <span class="n">p</span><span class="p">,</span>
            <span class="s">'error_message'</span> <span class="p">:</span> <span class="s">&quot;You didn't select a choice.&quot;</span><span class="p">,</span>
            <span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selected_choice</span><span class="o">.</span><span class="n">votes</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">selected_choice</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:results'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,)))</span>
</pre></div>
</div>
<p>これであとは、polls/urls.pyに</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r'^(?P&lt;poll_id&gt;\d+)/vote/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'vote'</span><span class="p">),</span>
</pre></div>
</div>
<p>と書いてあれば投票出来る。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>shortcuts.redirectを使う</p>
<p>HttpResponseRedirect(reverse(...), args=...)は冗長なのでshortcuts.redirectを使いましょう。</p>
<p>使い方は簡単。</p>
<p>return redirect(‘polls:results’, poll_id=p.id)</p>
<p class="last">わかりやすい！</p>
</div>
<p>このままで投票はできたけど結果がわからないので、resultsも実装する。</p>
<p>polls/templates/polls/results.html</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>{{ poll.question }}<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;ul&gt;</span>
{% for choice in poll.choice_set.all %}
    <span class="nt">&lt;li&gt;</span>{{ choice.choice_text }} -- {{ choice.votes }} vote{{ choice.votes|pluralize }}<span class="nt">&lt;/li&gt;</span>
{% endfor %}
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{% url 'polls:detail' poll.id %}&quot;</span><span class="nt">&gt;</span>Vote again?<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>polls/views.py</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">poll_id</span><span class="p">):</span>
    <span class="n">poll</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Poll</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">poll_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'polls/results.html'</span><span class="p">,</span> <span class="p">{</span><span class="s">'poll'</span><span class="p">:</span> <span class="n">poll</span><span class="p">})</span>
</pre></div>
</div>
<div class="section" id="view-generic-views">
<h4><a class="toc-backref" href="#id27">viewの改善 - generic views -</a></h4>
<p>Djangoにはgeneric viewsというviewをサポートするモジュールがあり、これを使うことでviewsをシンプルに記述することができます。</p>
<p>genericをインポートし抽象クラスが用意されているのでそれらを継承して使います。</p>
<p>polls/urls.pyとpolls/views.pyを修正し以下のようにします。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">polls</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">IndexView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">'index'</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^(?P&lt;pk&gt;\d+)/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">DetailView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">'detail'</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^(?P&lt;pk&gt;\d+)/results/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">ResultsView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">'results'</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^(?P&lt;poll_id&gt;\d+)/vote/$'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'vote'</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>viewsの関数の指定を&lt;class&gt;.as_view()にし、ルーティングはpoll_idをpkに変更します。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ...</span>

<span class="kn">from</span> <span class="nn">django.views</span> <span class="kn">import</span> <span class="n">generic</span>

<span class="k">class</span> <span class="nc">IndexView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'polls/index.html'</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">'latest_poll_list'</span>

    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the last five published polls.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-pub_date'</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">DetailView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Poll</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'polls/detail.html'</span>


<span class="k">class</span> <span class="nc">ResultsView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Poll</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'polls/results.html'</span>

<span class="c"># ...</span>
</pre></div>
</div>
<p>indexとdetailとresultsをgeneric.ListView又はgeneric.DetailViewを継承したクラスに変更します。</p>
<p>ListViewとDetailView共通の部分はテンプレートの指定です。template_nameで指定できますが、指定しないこともできます。</p>
<p>指定しない場合は&lt;app name&gt;/&lt;model name&gt;_list.html or &lt;app name&gt;/&lt;model name&gt;_detail.htmlとなります。</p>
<p>ListViewでは常に指定した同じデータを返します。言い換えると返すデータをコードで指定できるということです。</p>
<p>DetailViewではmodelに指定したオブジェクトから、与えられたprimary key(pk)をもとにデータを自動的に取得してくれます。</p>
<p>なので、polls/urls.pyでpoll_idからpkに変更したということです。</p>
<p>チュートリアルではこのくらいの説明しかありませんが、もっと詳しく知ったほうがいいでしょう。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/class-based-views">Class-based views | Django documentation | Django</a></p>
</div>
</div>
</div>
<div class="section" id="django">
<h2><a class="toc-backref" href="#id28">Djangoのテスト</a></h2>
<p>Djangoにはテストに関する機能も含まれています。優秀ですね。</p>
<p>実はこのPollアプリケーションは未来のデータ(発表されていないデータ)に関してバグを抱えています。</p>
<p>このバグを修正しつつテストコードを書いていきます。</p>
<div class="section" id="model">
<h3><a class="toc-backref" href="#id29">modelのテスト</a></h3>
<p>modelのPollにあるwas_published_recentlyは未来のデータがあった場合、それもヒットしてしまうバグを抱えています。</p>
<p>このことを検証するテストコードを書いてみます。</p>
<p>テストコードはtest.pyに記述します。test.pyの場所はそれぞれのアプリケーションフォルダ、つまりpolls以下に配置します。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="kn">from</span> <span class="nn">polls.models</span> <span class="kn">import</span> <span class="n">Choice</span><span class="p">,</span> <span class="n">Poll</span>

<span class="k">class</span> <span class="nc">PollMethodTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_was_published_recently_with_future_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        was_published_recently() should return False for polls whose</span>
<span class="sd">        pub_date is in the future</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">future_poll</span> <span class="o">=</span> <span class="n">Poll</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">future_poll</span><span class="o">.</span><span class="n">was_published_recently</span><span class="p">(),</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>実行はコマンドラインで。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python manage.py <span class="nb">test </span>polls
Creating <span class="nb">test </span>database <span class="k">for </span><span class="nb">alias</span> <span class="s1">'default'</span>...
<span class="nv">F</span>
<span class="o">======================================================================</span>
FAIL: test_was_published_recently_with_future_poll <span class="o">(</span>polls.tests.PollMethodTests<span class="o">)</span>
----------------------------------------------------------------------
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/path/to/mysite/polls/tests.py&quot;</span>, line 16, in test_was_published_recently_with_future_poll
    self.assertEqual<span class="o">(</span>future_poll.was_published_recently<span class="o">()</span>, False<span class="o">)</span>
AssertionError: True !<span class="o">=</span> False

----------------------------------------------------------------------
Ran 1 <span class="nb">test </span>in 0.001s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>1<span class="o">)</span>
Destroying <span class="nb">test </span>database <span class="k">for </span><span class="nb">alias</span> <span class="s1">'default'</span>...
</pre></div>
</div>
<p>現在の時間を基準に検索をする必要があります。修正したコードが以下になります。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">was_published_recently</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">now</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pub_date</span> <span class="o">&lt;</span> <span class="n">now</span>
</pre></div>
</div>
<p>これでテストが通るようになるはずです。</p>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id30">viewのテスト</a></h3>
<p>DjangoはViewをユーザーをシミュレートしたテストクライアント機能を備えています。それを利用してViewのテストをすることができます。</p>
<p>その仕組はコマンドラインでテストした結果を見るとわかりやすいので、ズラズラを書いてみます。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.test.utils</span> <span class="kn">import</span> <span class="n">setup_test_environment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup_test_environment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.test.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># create an instance of the client for our use</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get a response from '/'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># we should expect a 404 from that address</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="go">404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># on the other hand we should expect to find something at '/polls/'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># we'll use 'reverse()' rather than a harcoded URL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="go">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">content</span>
<span class="go">'\n\n\n    &lt;p&gt;No polls are available.&lt;/p&gt;\n\n'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># note - you might get unexpected results if your ``TIME_ZONE``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># in ``settings.py`` is not correct. If you need to change it,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># you will also need to restart your shell session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">polls.models</span> <span class="kn">import</span> <span class="n">Poll</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># create a Poll and save it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Who is your favorite Beatle?&quot;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># check the response once again</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/polls/'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">content</span>
<span class="go">'\n\n\n    &lt;ul&gt;\n    \n        &lt;li&gt;&lt;a href=&quot;/polls/1/&quot;&gt;Who is your favorite Beatle?&lt;/a&gt;&lt;/li&gt;\n    \n    &lt;/ul&gt;\n\n'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">]</span>
<span class="go">[&lt;Poll: Who is your favorite Beatle?&gt;]</span>
</pre></div>
</div>
<p>はじめの5行はTestCaseが用意してくれているので、test.pyを書く際にはあまり気にしないが知っておいたほうがいい。</p>
<p>client.getは直接URLをハードコーディングするのは良くないのでreverseを使う。</p>
<p>毎回コマンドを実行するわけにはいかないので、test.pyにテストを書いていく。</p>
<p>ViewIndexとDetailIndexのテスト</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_poll</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a poll with the given `question` published the given number of</span>
<span class="sd">    `days` offset to now (negative for polls published in the past,</span>
<span class="sd">    positive for polls that have yet to be published).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="n">question</span><span class="p">,</span>
        <span class="n">pub_date</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">PollViewTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_index_view_with_no_polls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If no polls exist, an appropriate message should be displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">&quot;No polls are available.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">],</span> <span class="p">[])</span>

    <span class="k">def</span> <span class="nf">test_index_view_with_a_past_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polls with a pub_date in the past should be displayed on the index page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Past poll.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=-</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">],</span>
            <span class="p">[</span><span class="s">'&lt;Poll: Past poll.&gt;'</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_index_view_with_a_future_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polls with a pub_date in the future should not be displayed on the</span>
<span class="sd">        index page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Future poll.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">&quot;No polls are available.&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">],</span> <span class="p">[])</span>

    <span class="k">def</span> <span class="nf">test_index_view_with_future_poll_and_past_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Even if both past and future polls exist, only past polls should be</span>
<span class="sd">        displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Past poll.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=-</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Future poll.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">],</span>
            <span class="p">[</span><span class="s">'&lt;Poll: Past poll.&gt;'</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_index_view_with_two_past_polls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The polls index page may display multiple polls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Past poll 1.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=-</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">&quot;Past poll 2.&quot;</span><span class="p">,</span> <span class="n">days</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:index'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'latest_poll_list'</span><span class="p">],</span>
             <span class="p">[</span><span class="s">'&lt;Poll: Past poll 2.&gt;'</span><span class="p">,</span> <span class="s">'&lt;Poll: Past poll 1.&gt;'</span><span class="p">]</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">PollIndexDetailTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_detail_view_with_a_future_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The detail view of a poll with a pub_date in the future should</span>
<span class="sd">        return a 404 not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">future_poll</span> <span class="o">=</span> <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">'Future poll.'</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:detail'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">future_poll</span><span class="o">.</span><span class="n">id</span><span class="p">,)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_detail_view_with_a_past_poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The detail view of a poll with a pub_date in the past should display</span>
<span class="sd">        the poll's question.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">past_poll</span> <span class="o">=</span> <span class="n">create_poll</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s">'Past Poll.'</span><span class="p">,</span> <span class="n">days</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'polls:detail'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">past_poll</span><span class="o">.</span><span class="n">id</span><span class="p">,)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">past_poll</span><span class="o">.</span><span class="n">question</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>日付に関するテストを書いたが、このままでは未来のデータが入る部分でテストが失敗するのでViewを書き直す。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>

<span class="k">class</span> <span class="nc">IndexView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'polls/index.html'</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">'latest_poll_list'</span>

    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="n">pub_date__lte</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-pub_date'</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">DetailView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Poll</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'polls/detail.html'</span>

    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__lte</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre></div>
</div>
<p>これでテストが通るはず。</p>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id31">テストについて</a></h3>
<p>もし他のViewに対してテストを行う場合、多分大体同じようなテストコードを書くことになるだろうけど、そんなのは別にいいらしい。</p>
<p>確かに美しさとは離れているかもしれないが、一旦書いたテストのことは忘れて新機能を追加していこう。(一旦書いたテストは自分のコードが正しいことを証明してくれる。)</p>
<p>今回書いたテストはChoiceがあるPollには対応していないので、Choiceがある場合多くのテストが失敗する。まぁ。それは直せということだ。だって自分のコードが正しくないのだから。</p>
<p>そんなこんなで冗長なテストコードになってしまうかもしれないが、テストコードが冗長なのは悪いことではない。それよりも意識したほうがいいこともある。</p>
<ol class="arabic simple">
<li>1つのModelやViewごとにテストクラスを生成する</li>
<li>テストする条件ごとに別々にテストメソッドを作成する</li>
<li>テストメソッド名はそのテストの内容を説明している</li>
</ol>
<p>ここで紹介しているテスト技法は基本的なものだけである。他の優れたツールを使うことでもっと多くのことができる。</p>
<div class="section" id="selenium">
<h4><a class="toc-backref" href="#id32">Selenium</a></h4>
<p><a class="reference external" href="http://docs.seleniumhq.org">Selenium - Web Browser Automation</a></p>
<p>Seleniumを使ってフロントエンド(html, javascript)のテストをする。</p>
<p>LiveServerTestCaseと組み合わせると連携が便利になる。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/testing/overview/django_v15_tutorial.html#django.test.LiveServerTestCase">Testing Django applications | Django documentation | Django</a></p>
</div>
<div class="section" id="coverage-py">
<h4><a class="toc-backref" href="#id33">coverage.py</a></h4>
<p><a class="reference external" href="http://nedbatchelder.com/code/coverage">Ned Batchelder: coverage.py</a></p>
<p>コードカバレッジツールのcoverage.pyを使用する。ドキュメントにも使用方法について説明してある。</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/testing/advanced/django_v15_tutorial.html#topics-testing-code-coverage">Advanced testing topics | Django documentation | Django</a></p>
</div>
</div>
</div>
<div class="section" id="look-and-feel">
<h2><a class="toc-backref" href="#id34">Look and Feel</a></h2>
<p>cssや画像、javascriptを使って見た目を改善してみる。</p>
<p>作成する場所はpolls/static/polls。CSSファイル(style.css)を追加する。</p>
<p>polls/static/polls/style.css</p>
<div class="highlight-css"><div class="highlight"><pre><span class="nt">li</span> <span class="nt">a</span> <span class="p">{</span>
  <span class="k">color</span><span class="o">:</span> <span class="nb">green</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>cssファイルの読み込みをindex.htmlでやってみると、</p>
<div class="highlight-html"><div class="highlight"><pre>{% load staticfiles %}

<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;{% static 'polls/style.css' %}&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>画像の読み込みもしてみたいかもしれない。</p>
<div class="highlight-css"><div class="highlight"><pre><span class="nt">body</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="nb">white</span> <span class="sx">url(&quot;images/background.gif&quot;)</span> <span class="k">no-repeat</span> <span class="k">right</span> <span class="k">bottom</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>画像はpolls/static/polls/imagesに配置する。</p>
<p>cssファイルでもurl関数を使用して対象のファイルを指定することが出来る。</p>
</div>
<div class="section" id="tips">
<h2><a class="toc-backref" href="#id35">チュートリアルにはないTips</a></h2>
<div class="section" id="mysql">
<h3><a class="toc-backref" href="#id36">MySQLを使う</a></h3>
<p>settings.pyを書き換える。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">'ENGINE'</span><span class="p">:</span> <span class="s">'django.db.backends.mysql'</span><span class="p">,</span> <span class="c"># Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.</span>
      <span class="s">'NAME'</span><span class="p">:</span> <span class="s">'XXXXX'</span><span class="p">,</span>                      <span class="c"># Or path to database file if using sqlite3.</span>
      <span class="c"># The following settings are not used with sqlite3:</span>
      <span class="s">'USER'</span><span class="p">:</span> <span class="s">'root'</span><span class="p">,</span>
      <span class="s">'PASSWORD'</span><span class="p">:</span> <span class="s">'password'</span><span class="p">,</span>
      <span class="s">'HOST'</span><span class="p">:</span> <span class="s">'localhost'</span><span class="p">,</span>                      <span class="c"># Empty for localhost through domain sockets or '127.0.0.1' for localhost through TCP.</span>
      <span class="s">'PORT'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>                      <span class="c"># Set to empty string for default.</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>テーブル作成 &amp; MySQL-Pythonのインストール。</p>
<div class="highlight-bash"><div class="highlight"><pre>% pip install mysql-python
% mysql -u root -p password
mysql&gt; create database XXXXX;
mysql&gt; <span class="nb">exit</span>;
% python manage.py syncdb
</pre></div>
</div>
</div>
<div class="section" id="django-suit">
<h3><a class="toc-backref" href="#id37">Django Suit</a></h3>
<p>誰でもかっこつけたい。Admin画面もきっとそう。</p>
<p><a class="reference external" href="http://django-suit.readthedocs.org/en/develop">Django Suit documentation — Django Suit 0.2.2 documentation</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>workon Django
<span class="o">(</span>Django<span class="o">)</span><span class="nv">$ </span>pip install django-suit
</pre></div>
</div>
<p>settings.pyに以下を追加</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">...</span>
    <span class="s">'suit'</span><span class="p">,</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">django.conf.global_settings</span> <span class="kn">import</span> <span class="n">TEMPLATE_CONTEXT_PROCESSORS</span> <span class="k">as</span> <span class="n">TCP</span>

<span class="n">TEMPLATE_CONTEXT_PROCESSORS</span> <span class="o">=</span> <span class="n">TCP</span> <span class="o">+</span> <span class="p">(</span>
    <span class="s">'django.core.context_processors.request'</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="http://djangosuit.com">Django Suit - Modern theme for Django admin interface</a></p>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 12 Sep 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/08/18/pyenv.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/08/18/pyenv.html</guid>
            <title><![CDATA[pyenvな夏 in 2013]]></title>
            <description><![CDATA[<div class="section" id="pyenv-in-2013">
<h1>pyenvな夏 in 2013</h1>
<p><a class="reference external" href="https://github.com/yyuu/pyenv">yyuu/pyenv</a></p>
<p>いまどきなpythonのバージョン管理ツールといえば、pyenvな気がします。</p>
<p>なにやらenv系は流行っているようです。</p>
<p>せっかくマシンをUbuntu 12.04 LTSに乗り換えたのでpythonbrewからpyenvに乗り換えてみました。</p>
<div class="section" id="id1">
<h2>インストール</h2>
<p>対象はLinuxとします。(試したのはUbuntu)</p>
<p>ホームフォルダの.pyenvにgit cloneする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span>
<span class="nv">$ </span>git clone git://github.com/yyuu/pyenv.git .pyenv
</pre></div>
</div>
<p>.zshrcや.bashrcに以下を追加。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;$HOME/.pyenv/bin:$PATH&quot;</span>
<span class="nb">eval</span> <span class="s2">&quot;$(pyenv init -)&quot;</span>
</pre></div>
</div>
<p>端末を再起動するか、Shellを再起動するか、.zshrcを再読み込みするかするとpyenvが使用出来ます。</p>
<p>Macではbrew経由でさくっと入れれるみたいです。</p>
<div class="section" id="mac-os-x-homebrew">
<h3>Mac OS X HomeBrewの場合</h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>brew install pyenv
<span class="nv">$ </span>brew install pyenv-virtualenv
</pre></div>
</div>
<p>/usr/local/var/pyenvあたりにインストールされている。はず。</p>
<p>(/usr/local/binにあるpyenvのシンボリックリンクのリンク先をみればわかるかも)</p>
</div>
<div class="section" id="id2">
<h3>依存パッケージ(自分の場合)</h3>
<p>pyenvは依存パッケージが多いようです。</p>
<p>pythonをインストールしようとすると、これがない、あれがないとエラーが出ることがあります。</p>
<p>自分の場合、bzip2関係とsqlite3関係のパッケージがないというエラーが出ました。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install libreadline-dev libbz2-dev zlib1g-dev libssl-dev
<span class="nv">$ </span>sudo apt-get install sqlite3 libsqlite3-dev
</pre></div>
</div>
<p>issueに似たような悩みを抱えている方がいるのでそのあたりを参考にするといいかもしれません。</p>
<p><a class="reference external" href="https://github.com/yyuu/pyenv/issues/48">Build failed Xubuntu 13.04 · Issue #48 · yyuu/pyenv</a></p>
</div>
</div>
<div class="section" id="id3">
<h2>使い方</h2>
<p>インストール</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv install 2.7.5
<span class="nv">$ </span>pyenv install pypy-2.1
<span class="nv">$ </span>pyenv install jython-2.5.3
</pre></div>
</div>
<p>バージョン一覧表示</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># インストール可能なバージョン一覧</span>
<span class="nv">$ </span>pyenv install -l
<span class="c"># インストール済みのバージョン一覧</span>
<span class="nv">$ </span>pyenv versions
</pre></div>
</div>
<p>バージョン切り替え</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># 現在のシェルのバージョン切り替え</span>
<span class="nv">$ </span>pyenv shell 2.7.5
<span class="c"># カレントディレクトリのバージョン切り替え</span>
<span class="nv">$ </span>pyenv <span class="nb">local </span>2.7.5
<span class="c"># 全体のバージョン切り替え</span>
<span class="nv">$ </span>pyenv global 2.7.5
</pre></div>
</div>
<p>自分は主にshellを使うことが多い。</p>
</div>
<div class="section" id="pypy">
<h2>pypyを使う</h2>
<p>pyenvではpypyを使用してpythonを実行することができる。きっと速い。</p>
<p><a class="reference external" href="http://www.longsleeper.com/pypyadvent11">流行りのJITコンパイラは嫌いですか? — PyPy Advent Calendar 2011 v1.0 documentation</a></p>
<p>こんな感じで使う。</p>
<div class="highlight-bash"><div class="highlight"><pre>$ pyenv install 2.7.5
$ pyenv install pypy-2.1
$ pyenv shell pypy-2.1 2.7.5
$ python
Python 2.7.3 (480845e6b1dd, Jul 31 2013, 09:57:07)
[PyPy 2.1.0 with GCC 4.6.3] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
And now for something completely different: ``it seems to me that once you
settle on an execution / object model and / or bytecode format, you've already
decided what languages (where the 's' seems superfluous) support is going to be
first class for''
</pre></div>
</div>
<p>おー</p>
</div>
<div class="section" id="virtualenv">
<h2>virtualenvを使う</h2>
<p><a class="reference external" href="https://github.com/yyuu/pyenv-virtualenv">yyuu/pyenv-virtualenv</a></p>
<p>プラグインとしてvirtualenv拡張ができます。便利ですね。</p>
<p>インストールはpyenvフォルダにあるpluginsフォルダにgit cloneするだけでおｋです。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> ~/.pyenv/plugins
<span class="nv">$ </span>git clone git@github.com:yyuu/pyenv-virtualenv.git
</pre></div>
</div>
<p>これでpyenv virtualenvコマンドを使用出来ます。</p>
<div class="section" id="id4">
<h3>使い方</h3>
<p>バージョンを指定して仮想環境を作成する。切り替えはshellやlocalで。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv virtualenv 3.3.2 Hoge
<span class="nv">$ </span>pyenv shell Hoge
</pre></div>
</div>
<p>作成した仮想環境は、インストールしたバージョンと同じくversionsで確認できます。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv versions
system
2.6.8
* 2.7.5 <span class="o">(</span><span class="nb">set </span>by PYENV_VERSION environment variable<span class="o">)</span>
3.3.2
Hoge
Tinker
* pypy-2.1 <span class="o">(</span><span class="nb">set </span>by PYENV_VERSION environment variable<span class="o">)</span>
</pre></div>
</div>
<p>virtualenvのみ確認したい場合は、pyenv virtualenvsコマンドを使います。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv virtualenvs
Hoge <span class="o">(</span>created from /home/yano/.pyenv/versions/3.3.2<span class="o">)</span>
Tinker <span class="o">(</span>created from /home/yano/.pyenv/versions/2.7.5<span class="o">)</span>
</pre></div>
</div>
<p>削除したい場合はバージョンと同じようにuninstallします。(なんか不自然だけど)</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv uninstall Hoge
pyenv: remove /home/yano/.pyenv/versions/Hoge? yes
<span class="nv">$ </span>pyenv versions
system
2.6.8
* 2.7.5 <span class="o">(</span><span class="nb">set </span>by PYENV_VERSION environment variable<span class="o">)</span>
3.3.2
Tinker
* pypy-2.1 <span class="o">(</span><span class="nb">set </span>by PYENV_VERSION environment variable<span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="virtualenvwrapper">
<h2>virtualenvwrapperを使う</h2>
<p><a class="reference external" href="https://github.com/yyuu/pyenv-virtualenvwrapper">yyuu/pyenv-virtualenvwrapper</a></p>
<p>virtualenvと同じくpluginsにgit clone。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install virtualenvwrapper
<span class="nv">$ </span><span class="nb">cd</span> ~/.pyenv/plugins
<span class="nv">$ </span>git clone git@github.com:yyuu/pyenv-virtualenvwrapper.git
<span class="nv">$ </span>pyenv virtualenvwrapper
</pre></div>
</div>
<div class="section" id="id5">
<h3>使い方</h3>
<p>目的が、virtualenvwrapperを使用可能にするだけなので使わないかも。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pyenv virtualenvwrapper
</pre></div>
</div>
<p>これでvirtualenvwrapperコマンドが使える。</p>
<p>詳細な使い方はvirtualenvwrapperでググろう。</p>
<p>最後に、、、</p>
<p>この記事通りにやってもコマンドが実行できない、見つからない場合は、shellを再起動するか、source ~/.zshrc または source ~/.bashrcなどをしてみてください。</p>
</div>
</div>
</div>]]></description>
            <category><![CDATA[ python ]]></category>
             <pubDate>Sun, 18 Aug 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/08/08/timewatcher_c.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/08/08/timewatcher_c.html</guid>
            <title><![CDATA[C言語で実時間を測定する Windows && Linux]]></title>
            <description><![CDATA[<div class="section" id="c-windows-linux">
<h1>C言語で実時間を測定する Windows &amp;&amp; Linux</h1>
<p>c言語で処理の <strong>実時間</strong> 測定をするTipsを総合してパーフェクトな時間測定を出来るようにした。</p>
<p>自分の場合はTimeWatcher構造体を作成して時間を測定している。</p>
<p>ヘッダファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1020)</span>
<span class="cp">#define MS_MODE</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef MS_MODE</span>
<span class="cp">#include &lt;windows.h&gt;</span>
<span class="cp">#include &lt;mmsystem.h&gt;</span>
<span class="cp">#pragma comment( lib, &quot;winmm.lib&quot; )</span>
<span class="cp">#else</span>
<span class="cp">#include &lt;sys/time.h&gt;</span>
<span class="cp">#endif</span>

<span class="c1">// =================</span>
<span class="c1">// measure time(sec)</span>
<span class="c1">// =================</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">TimeWatcher</span>
<span class="p">{</span>
<span class="cp">#ifdef MS_MODE</span>
    <span class="n">DWORD</span> <span class="n">start</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">end</span><span class="p">;</span>
<span class="cp">#else</span>
    <span class="kt">double</span> <span class="n">start</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">end</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span> <span class="n">TimeWatcher</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
</pre></div>
</div>
<p>ソースファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="c1">// =================</span>
<span class="c1">// measure time(sec)</span>
<span class="c1">// =================</span>

<span class="cp">#ifndef MS_MODE</span>
<span class="kt">double</span> <span class="nf">gettimeofday_sec</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">;</span>
    <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span> <span class="o">+</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_usec</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef MS_MODE</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">timeGetTime</span><span class="p">();</span>
<span class="cp">#else</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">gettimeofday_sec</span><span class="p">();</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef MS_MODE</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">=</span> <span class="n">timeGetTime</span><span class="p">();</span>
<span class="cp">#else</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">=</span> <span class="n">gettimeofday_sec</span><span class="p">();</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef MS_MODE</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%10.10f(sec)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">-</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">);</span>
<span class="cp">#else</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%10.10f(sec)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">-</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="clock">
<h2>clock()を使用する時間測定の問題点</h2>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;time.h&gt;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">TimeWatcher</span>
<span class="p">{</span>
      <span class="kt">clock_t</span> <span class="n">start</span><span class="p">;</span>
      <span class="kt">clock_t</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">TimeWatcher</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
      <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
      <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Time : %f(sec)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span><span class="o">-</span><span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="n">CLOCKS_PER_SEC</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>clock()</h3>
<div class="highlight-python"><div class="highlight"><pre>iプログラム実行開始からの経過時間（プロセッサ時間）を返却します。経過時間の精度は処理系に依存します。
clock関数を２回呼び出し、経過時間の差を求めることにより、処理時間を算出することが出来ます。
経過時間を秒で表現するには、CLOCKS_PER_SECで割る必要があります。
</pre></div>
</div>
<p><a class="reference external" href="http://www9.plala.or.jp/sgwr-t/lib/clock.html">clock</a></p>
<p>上記の通り、clock_tはプロセッサ時間を測定するので実時間とは必ずしも一致しない。</p>
<p>しかも、マルチコア処理の時間測定を行う場合にclock()を使用すると、それどれのコアでの計算時間を合計したものが測定されてしまう。</p>
<p>つまり、実時間を測定したい場合はclock()の使用はできないということ。</p>
</div>
</div>
<div class="section" id="id3">
<h2>解決策</h2>
<p>正確な実行時間を測定するのに有用なツールが環境によって異なるが存在している。</p>
<ul class="simple">
<li>Unix系環境ではsys/time.h</li>
<li>VC++環境ではtimeGetTime()</li>
</ul>
<p>それぞれ、sys/time.hはマイクロ秒、timeGetTime()はミリ秒の精度がある。</p>
</div>
<div class="section" id="unix">
<h2>Unix系環境</h2>
<p>ヘッダファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#ifndef UTIL_H_INCLUDE</span>
<span class="cp">#define UTIL_H_INCLUDE</span>

<span class="c1">// =================</span>
<span class="c1">// measure time(sec)</span>
<span class="c1">// =================</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">TimeWatcher</span>
<span class="p">{</span>
        <span class="kt">double</span> <span class="n">start</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">TimeWatcher</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>

<span class="cp">#endif </span><span class="c1">// #ifndef UTIL_H_INCLUDE</span>
</pre></div>
</div>
<p>ソースファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;time.h&gt;</span>
<span class="cp">#include &lt;sys/time.h&gt;</span>
<span class="cp">#include &quot;util.h&quot;</span>

<span class="c1">// =================</span>
<span class="c1">// measure time(sec)</span>
<span class="c1">// =================</span>

<span class="kt">double</span> <span class="nf">gettimeofday_sec</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">;</span>
    <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span> <span class="o">+</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_usec</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
      <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">gettimeofday_sec</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
     <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">=</span> <span class="n">gettimeofday_sec</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
     <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%10.10f(sec)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">-</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="vc">
<h2>VC++環境</h2>
<p>ヘッダファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1020)</span>
<span class="cp">#include &lt;windows.h&gt;</span>
<span class="cp">#include &lt;mmsystem.h&gt;</span>
<span class="cp">#pragma comment( lib, &quot;winmm.lib&quot; )</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">TimeWatcher</span>
<span class="p">{</span>
    <span class="n">DWORD</span> <span class="n">start</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">TimeWatcher</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">);</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>ソースファイル</p>
<div class="highlight-c"><div class="highlight"><pre><span class="c1">// =================</span>
<span class="c1">// measure time(sec)</span>
<span class="c1">// =================</span>

<span class="cp">#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1020)</span>

<span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">=</span> <span class="n">timeGetTime</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">end</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">=</span> <span class="n">timeGetTime</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_time_sec</span><span class="p">(</span><span class="n">TimeWatcher</span><span class="o">*</span> <span class="n">tw</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%10.10f(sec)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">tw</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">-</span> <span class="n">tw</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 08 Aug 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html</guid>
            <title><![CDATA[Emacsパッケージ管理]]></title>
            <description><![CDATA[<div class="section" id="emacs">
<h1><a class="toc-backref" href="#id6">Emacsパッケージ管理</a></h1>
<p>Evil化したことによりエディタとしての力を取り戻したEmacsだが物足りない部分が多々あるので、これからVimに変わってやってもいいぜ。くらいに成長させようと思う。</p>
<p>ググってると、package.elとel-getを併用するのがいい感じな気がしたのでその方法でパッケージを管理します。</p>
<hr class="docutils"/>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#emacs" id="id6">Emacsパッケージ管理</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#package-el" id="id7">package.el</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#id1" id="id8">参考記事</a></li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#el-get" id="id9">el-get</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#id3" id="id10">外部パッケージの追加</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#id4" id="id11">el-getリポジトリの自動更新</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#id5" id="id12">参考記事</a></li>
</ul>
</li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/07/14/more_emacs.html#init-el" id="id13">こんな感じのinit.elになった</a></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="package-el">
<h2><a class="toc-backref" href="#id7">package.el</a></h2>
<p>emacs24からはデフォルトでパッケージ管理ツールpackage.elが使える。</p>
<p>package.elから参照できるパッケージを増やすために以下のコードをinit.elの出来るだけはじめの方に書いておきます。</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;; Package Manegement</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'package</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span> <span class="o">.</span> <span class="s">&quot;http://melpa.milkbox.net/packages/&quot;</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;marmalade&quot;</span> <span class="o">.</span> <span class="s">&quot;http://marmalade-repo.org/packages/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">opackage-initialize</span><span class="p">)</span>
</pre></div>
</div>
<p>M-x list-packageで開かれるバッファから、’i’でパッケージを選択して’x’でインストールすることができます。</p>
<p>正直手動でやんの!?って感じなので、いい方法を探したところありました。</p>
<p><a class="reference external" href="http://qiita.com/catatsuy/items/5f1cd86e2522fd3384a0">init-loader.el と package.el を導入して快適 Emacs ライフ - Qiita [キータ]</a></p>
<p>init.elに以下のコードを追加します。</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;; auto install</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'cl</span><span class="p">)</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">installing-package-list</span>
  <span class="o">'</span><span class="p">(</span>
    <span class="c1">;; package list</span>
    <span class="nv">evil</span>
    <span class="nv">evil-leader</span>
    <span class="nv">evil-numbers</span>
    <span class="nv">evil-nerd-commenter</span>
    <span class="p">))</span>
<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">not-installed</span> <span class="p">(</span><span class="nf">loop</span> <span class="nv">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">installing-package-list</span>
                            <span class="nv">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">package-installed-p</span> <span class="nv">x</span><span class="p">))</span>
                            <span class="nv">collect</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">when</span> <span class="nv">not-installed</span>
    <span class="p">(</span><span class="nf">package-refresh-contents</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">dolist</span> <span class="p">(</span><span class="nf">pkg</span> <span class="nv">not-installed</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">package-install</span> <span class="nv">pkg</span><span class="p">))))</span>
</pre></div>
</div>
<p>;; package list以下にパッケージ名をリストアップすれば起動時にインストールされていなかった場合、自動でインストールしてくれます。</p>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id8">参考記事</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/syohex/20130624/1372082597">package.elを使う場合の設定ファイルの書き方 - Life is very short</a></li>
<li><a class="reference external" href="http://qiita.com/catatsuy/items/5f1cd86e2522fd3384a0">init-loader.el と package.el を導入して快適 Emacs ライフ - Qiita [キータ]</a></li>
</ul>
</div>
</div>
<div class="section" id="el-get">
<h2><a class="toc-backref" href="#id9">el-get</a></h2>
<p><a class="reference external" href="https://github.com/dimitri/el-get">dimitri/el-get · GitHub</a></p>
<p>el-getのインストールは*scratch*でelispを実行することで行う。</p>
<p>C-x b *scratch*を入力して表示されたバッファに以下をコピー</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="p">(</span><span class="nf">url-retrieve</span>
 <span class="s">&quot;https://raw.github.com/dimitri/el-get/master/el-get-install.el&quot;</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">eval-print-last-sexp</span><span class="p">)))</span>
</pre></div>
</div>
<p>最後の行でC-x C-eをすると実行されインストール。</p>
<p>emacsすげー。elisp処理系的に。</p>
<p>M-x el-get-list-packagesでrecipe一覧を表示できるので’i’で選択’x’でインストール。</p>
<p><a class="reference external" href="https://github.com/dimitri/el-get#basic-setup">mitri/el-get · GitHub</a> によると以下の設定を書いておくといいらしい。</p>
<p>最新のパッケージに自動で更新してくれるとかそういうことだろうか？</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'load-path</span> <span class="s">&quot;~/.emacs.d/el-get/el-get&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">require</span> <span class="ss">'el-get</span> <span class="nv">nil</span> <span class="ss">'noerror</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">with-current-buffer</span>
      <span class="p">(</span><span class="nf">url-retrieve-synchronously</span>
       <span class="s">&quot;https://raw.github.com/dimitri/el-get/master/el-get-install.el&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">eval-print-last-sexp</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">el-get</span> <span class="ss">'sync</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id10">外部パッケージの追加</a></h3>
<p>el-get-sourcesを書くとrecipeを追加できる。</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;;; define el-get repository</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">el-get-sources</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="p">(</span><span class="nf">:name</span> <span class="nv">open-github-from-here</span>
               <span class="nv">:type</span> <span class="nv">github</span>
               <span class="nv">:description</span> <span class="s">&quot;open github from here&quot;</span>
               <span class="nv">:pkgname</span> <span class="s">&quot;shibayu36/emacs-open-github-from-here&quot;</span>
               <span class="nv">:branch</span> <span class="s">&quot;development&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">:name</span> <span class="nv">anything-git-files</span>
               <span class="nv">:type</span> <span class="nv">github</span>
               <span class="nv">:pkgname</span> <span class="s">&quot;tarao/anything-git-files-el&quot;</span><span class="p">)</span>
        <span class="p">))</span>
</pre></div>
</div>
<p>GitHubリポジトリの場合が多いので、基本的に2つ目の設定のように書いておけばいい気がする。</p>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id11">el-getリポジトリの自動更新</a></h3>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;; auto install el-get.el</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">my/el-get-packages</span>
  <span class="o">'</span><span class="p">(</span>
    <span class="nv">open-github-from-here</span>
    <span class="nv">anything-git-files</span>
    <span class="p">)</span>
  <span class="s">&quot;A list of packages to install from el-get at launch.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nf">el-get</span> <span class="ss">'sync</span> <span class="nv">my/el-get-packages</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id12">参考記事</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://shibayu36.hatenablog.com/entry/2013/03/14/081524">el-getを使ってみる(インストール編) - $shibayu36-&gt;blog;</a></li>
<li><a class="reference external" href="http://shibayu36.hatenablog.com/entry/2013/04/30/175740">elispをpackageとel-get両方で管理する - $shibayu36-&gt;blog;</a></li>
</ul>
</div>
</div>
<div class="section" id="init-el">
<h2><a class="toc-backref" href="#id13">こんな感じのinit.elになった</a></h2>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;;</span>
<span class="c1">;; init.el</span>
<span class="c1">;;</span>

<span class="c1">;; Language.</span>
<span class="p">(</span><span class="nf">set-language-environment</span> <span class="ss">'Japanese</span><span class="p">)</span>

<span class="c1">;; Coding system.</span>
<span class="p">(</span><span class="nf">set-default-coding-systems</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-keyboard-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-terminal-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-buffer-file-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">prefer-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>

<span class="c1">;; Package Manegement</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'package</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span> <span class="o">.</span> <span class="s">&quot;http://melpa.milkbox.net/packages/&quot;</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;marmalade&quot;</span> <span class="o">.</span> <span class="s">&quot;http://marmalade-repo.org/packages/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">package-initialize</span><span class="p">)</span>

<span class="c1">;; usable evil</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'evil</span><span class="p">)</span>
<span class="p">(</span><span class="nf">evil-mode</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">;; define el-get repository</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">el-get-sources</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="p">(</span><span class="nf">:name</span> <span class="nv">evil-plugins</span>
               <span class="nv">:type</span> <span class="nv">github</span>
               <span class="nv">:pkgname</span> <span class="s">&quot;tarao/evil-plugins&quot;</span><span class="p">)</span>
        <span class="p">))</span>

<span class="c1">;; el-get basic setting</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'load-path</span> <span class="s">&quot;~/.emacs.d/el-get/el-get&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">require</span> <span class="ss">'el-get</span> <span class="nv">nil</span> <span class="ss">'noerror</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">with-current-buffer</span>
      <span class="p">(</span><span class="nf">url-retrieve-synchronously</span>
       <span class="s">&quot;https://raw.github.com/dimitri/el-get/master/el-get-install.el&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">(</span><span class="nf">el-get-master-branch</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">eval-print-last-sexp</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">el-get</span> <span class="ss">'sync</span><span class="p">)</span>

<span class="c1">;; auto install package.el</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'cl</span><span class="p">)</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">installing-package-list</span>
  <span class="o">'</span><span class="p">(</span>
    <span class="c1">;; package list</span>
    <span class="nv">evil</span>
    <span class="nv">evil-leader</span>
    <span class="nv">evil-numbers</span>
    <span class="nv">evil-nerd-commenter</span>
    <span class="p">))</span>
<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">not-installed</span> <span class="p">(</span><span class="nf">loop</span> <span class="nv">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">installing-package-list</span>
                            <span class="nv">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">package-installed-p</span> <span class="nv">x</span><span class="p">))</span>
                            <span class="nv">collect</span> <span class="nv">x</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">when</span> <span class="nv">not-installed</span>
    <span class="p">(</span><span class="nf">package-refresh-contents</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">dolist</span> <span class="p">(</span><span class="nf">pkg</span> <span class="nv">not-installed</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">package-install</span> <span class="nv">pkg</span><span class="p">))))</span>

<span class="c1">;; auto install el-get.el</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">my/el-get-packages</span>
  <span class="o">'</span><span class="p">(</span>
    <span class="nv">evil-plugins</span>
    <span class="p">)</span>
  <span class="s">&quot;A list of packages to install from el-get at launch.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nf">el-get</span> <span class="ss">'sync</span> <span class="nv">my/el-get-packages</span><span class="p">)</span>

<span class="c1">;;</span>
<span class="c1">;; Plugin</span>
<span class="c1">;;</span>
</pre></div>
</div>
</div>
</div>]]></description>
             <pubDate>Sun, 14 Jul 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/07/12/emacs_evil.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/07/12/emacs_evil.html</guid>
            <title><![CDATA[Emacs Evilという新しいエディタ]]></title>
            <description><![CDATA[<div class="section" id="emacs-evil">
<h1>Emacs Evilという新しいエディタ</h1>
<p>emacsに入門して早６時間。</p>
<p>そろそろVimキーバインドが恋しくなってくる頃でしょうか。</p>
<p>Ctrlキーを押している小指が心配でそわそわしてくる頃ですね。</p>
<p>そんなEmacsをダークサイドに落とすことのできるプラグイン。それがEvil。</p>
<div class="section" id="install">
<h2>Install</h2>
<p>package.elを搭載したemacs24ならすぐにダークサイドに落とすことが出来る。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>emacs
M-x list-package
C-s evil
</pre></div>
</div>
<p>evilにカーソルが当たっている状態でixと打ち込むとインストールされる。</p>
<p>そのままC-x C-f ~/emacs.d/init.elと打ち込んで以下を追加する。</p>
<div class="highlight-scm"><div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="ss">'evil</span><span class="p">)</span>
<span class="p">(</span><span class="nf">evil-mode</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Emacsを再起動するとCtrlの呪縛から開放されていることがわかります。</p>
<p>普段慣れていたVimのキーバインドに安らぎを感じるでしょう。</p>
<p>もしかしたら、モードがあることに喜びを感じてしまうかもしれません。</p>
</div>
<div class="section" id="evil">
<h2>Evilなプラグイン</h2>
<p>公式</p>
<ul class="simple">
<li>evil-surround</li>
<li>evil-number</li>
<li>evil-leader</li>
<li>evil-rails</li>
<li>evil-nerd-commenter</li>
</ul>
<p>taraoさんのEvilプラグイン</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/tarao/evil-plugins">tarao/evil-plugins · GitHub</a></li>
</ul>
<p>などなど色々あるようです。</p>
<p>しかし、まだまだEmacs力が足りずにプラグインを入れるのに四苦八苦しているので、まだ今度ということで。</p>
</div>
</div>]]></description>
             <pubDate>Fri, 12 Jul 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/07/10/emacs_24_3.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/07/10/emacs_24_3.html</guid>
            <title><![CDATA[emacs入門 - 24.3 & 設定ファイル]]></title>
            <description><![CDATA[<div class="section" id="emacs-24-3">
<h1>emacs入門 - 24.3 &amp; 設定ファイル</h1>
<p>emacsでテキストの編集ができるようになりましたが、まだメモ帳程度のEmacs力しかないのでもう少し高みを目指します。</p>
<div class="section" id="install-emacs-24-3">
<h2>Install emacs 24.3</h2>
<p>いつもの如く、wget -&gt; ./configure -&gt; make &amp;&amp; make install</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>yum install gcc make ncurses-devel giflib-devel libjpeg-devel libtiff-devel
<span class="nv">$ </span><span class="nb">cd</span> /ダウンロードするフォルダ
<span class="nv">$ </span>wget http://ftp.gnu.org/pub/gnu/emacs/emacs-24.3.tar.gz
<span class="nv">$ </span>tar zxvf emacs-24.3.tar.gz
<span class="nv">$ </span><span class="nb">cd </span>emacs-24.3.tar.gz
<span class="nv">$ </span>./configure --without-x --without-selinux
<span class="nv">$ </span>make
<span class="nv">$ </span>sudo make install
</pre></div>
</div>
<p>すんなり24.3にバージョンアップした。</p>
<p>今のところ以下の変化を感じた。</p>
<ul class="simple">
<li>emacs -nwとしなくても端末上で起動する。(GUI版がインストールされていないから?–without-xの効果かも?)</li>
<li>チュートリアルが読みやすい。21は見切れてたりしてた。</li>
<li>色が付いてる。</li>
</ul>
</div>
<div class="section" id="id1">
<h2>設定ファイル</h2>
<p>調べたところによると以下の構成がいい感じらしい。</p>
<div class="highlight-bash"><div class="highlight"><pre>~/.emacs.d/
  elpa/
  init.el
</pre></div>
</div>
<p>~/.emacsに設定を書くのは時代遅れらしい。</p>
<div class="section" id="init-el">
<h3>init.el</h3>
<p>設定はここに書き記しておく。きっと.vimrcのようなものだろう。</p>
<p>色んな人のinit.elを眺めてみてはじめはコピペから始めるといいだろう。</p>
<p>参考にさせて頂いたinit.el</p>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/hyuki/20110116/p1">Emacsの環境整備(~/.emacs.d/init.el) - 結城浩のはてな日記</a></li>
<li><a class="reference external" href="http://keisanbutsuriya.blog.fc2.com/blog-entry-43.html">計算物理屋の研究備忘録 |Emacs 24のpackage管理機能を使う</a></li>
<li><a class="reference external" href="http://moya-notes.blogspot.jp/2013/02/emacs24-config-on-mac.html">まあそのうち: Emacs 設定いろいろ [Emacs24 (Cocoa Emacs) on Mac OS X]</a></li>
</ul>
<div class="highlight-scm"><div class="highlight"><pre><span class="c1">;;</span>
<span class="c1">;; init.el</span>
<span class="c1">;;</span>

<span class="c1">;; Language.</span>
<span class="p">(</span><span class="nf">set-language-environment</span> <span class="ss">'Japanese</span><span class="p">)</span>

<span class="c1">;; Coding system.</span>
<span class="p">(</span><span class="nf">set-default-coding-systems</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-keyboard-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-terminal-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-buffer-file-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nf">prefer-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>

<span class="c1">;; Package Manegement</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'package</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span> <span class="o">.</span> <span class="s">&quot;http://melpa.milkbox.net/packages/&quot;</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'package-archives</span> <span class="o">'</span><span class="p">(</span><span class="s">&quot;marmalade&quot;</span> <span class="o">.</span> <span class="s">&quot;http://marmalade-repo.org/packages/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">package-initialize</span><span class="p">)</span>
</pre></div>
</div>
<p>日本語設定とパッケージの追加を書いただけ。</p>
<p>プラグインは.emacs.d/elpa/にインストールされる。</p>
<p>知ってるプラグインはanythinとevilなのでそのあたりについての記事でも書こう。</p>
</div>
</div>
</div>]]></description>
             <pubDate>Wed, 10 Jul 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/07/10/start_emacs.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/07/10/start_emacs.html</guid>
            <title><![CDATA[emacs入門 - Tutorial]]></title>
            <description><![CDATA[<div class="section" id="emacs-tutorial">
<h1>emacs入門 - Tutorial</h1>
<p>身の回りにemacs使いがほとんどいなく、新人にemacsマジ使ったほうがいいとか言って、emacs使いにしようとしているが一向にならないので自分が人柱になってみる。</p>
<p>yumで入れた21.4.1を使ってみる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>emacs
</pre></div>
</div>
<p>と打ち込んでもGUIのほうが起動してしまってうざ。。。ってなっても</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>emacs -nw
</pre></div>
</div>
<p>とすれば、端末上で起動してくれる。</p>
<div class="section" id="id1">
<h2>チュートリアル</h2>
<div class="section" id="c-h-c-h">
<h3>C-h C-h</h3>
<p>ヘルプのヘルプ。</p>
<p>いろんなヘルプ機能があるが今はスルー。</p>
<p>C-h tがチュートリアルだとわかるのでやってみる。</p>
</div>
<div class="section" id="c-h-t">
<h3>C-h t</h3>
<p>CtrlとAltを良く使う。AltはMetaキーと呼ぶらしい。略表記はM-。</p>
<p>emacsから逃げ出したいときはC-x C-cをタイプする。</p>
<p>チュートリアルの途中では、C-zでサスペンドするのがオススメされている。fgで復活できる。</p>
</div>
<div class="section" id="c-v-m-v">
<h3>C-v M-v</h3>
<p>１ページ進む、戻る。(vimでいうC-f C-b)</p>
</div>
<div class="section" id="c-b-c-p-c-n-c-f">
<h3>C-b C-p C-n C-f</h3>
<p>カーソル移動。覚えられないので矢印キーを使う。</p>
</div>
<div class="section" id="c-g">
<h3>C-g</h3>
<p>緊急停止。emacsのコマンドがハングしたときなどにC-g。</p>
</div>
<div class="section" id="c-k-c-y">
<h3>C-k C-y</h3>
<p>文末まで削除＆その削除内容のコピー。</p>
</div>
<div class="section" id="c-x-u">
<h3>C-x u</h3>
<p>Undo</p>
</div>
</div>
<div class="section" id="id2">
<h2>ファイル操作</h2>
</div>
<div class="section" id="c-x-c-f">
<h2>C-x C-f</h2>
<p>ファイルをミニバッファから開けます。</p>
<p>C-x C-f newfile.txtとするとnewfile.txtが新規作成されます。</p>
</div>
<div class="section" id="c-x-c-s">
<h2>C-x C-s</h2>
<p>現在のバッファのファイルを保存します。</p>
</div>
<div class="section" id="id3">
<h2>バッファ</h2>
<div class="section" id="c-x-c-b">
<h3>C-x C-b</h3>
<p>バッファの一覧が見れます。</p>
<p>C-x C-fではバッファ一覧からtabキーで補完ができます。</p>
</div>
<div class="section" id="c-x-b">
<h3>C-x b</h3>
<p>バッファからファイルを開きます。</p>
</div>
</div>
<div class="section" id="id4">
<h2>検索</h2>
<div class="section" id="c-s-c-r">
<h3>C-s C-r</h3>
<p>前方検索、後方検索。</p>
<p>エコーエリアに”l-search”と表示されて文字を打ち込むとインクリメンタルサーチできる。</p>
</div>
</div>
<div class="section" id="id5">
<h2>複数ウィンドウ</h2>
<div class="section" id="c-x-2">
<h3>C-x 2</h3>
<p>現在のバッファを２つ目のバッファにも表示します。</p>
</div>
<div class="section" id="c-x-o">
<h3>C-x o</h3>
<p>別のウィンドウで開いているバッファにカーソルを移動します。</p>
<p>tmuxのキーバインドはemacsからきていたのか。</p>
</div>
<div class="section" id="c-m-v">
<h3>C-M-v</h3>
<p>他のウィンドウで開いているバッファのページを進めます。</p>
<p>別ウィンドウで開いているバッファを参照しながらの作業をするときに便利。</p>
</div>
<div class="section" id="c-x-1">
<h3>C-x 1</h3>
<p>現在カーソルのあるウィンドウ以外を閉じます。</p>
</div>
<div class="section" id="c-x-4-c-f">
<h3>C-x 4 C-f</h3>
<p>このコマンドの後に続くファイルを横分割で開きます。</p>
</div>
</div>
<div class="section" id="id6">
<h2>感想とか</h2>
<p>Ctrl無理。。。</p>
<p>emacsの最新版は24.3だとか。24.3にはデフォルトでパッケージ管理ツールが入っているらしいので、きっと自前でmakeしないといけないんだろうな。</p>
<p>もう少しemacsがんばってみる。</p>
</div>
</div>]]></description>
             <pubDate>Wed, 10 Jul 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/07/08/sakura_setup.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/07/08/sakura_setup.html</guid>
            <title><![CDATA[さくらVPSで適度に環境を整える]]></title>
            <description><![CDATA[<div class="section" id="vps">
<h1>さくらVPSで適度に環境を整える</h1>
<div class="section" id="centos">
<h2>CentOSのバージョン確認</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># cat /etc/redhat-release</span>
CentOS release 6.4 <span class="o">(</span>Final<span class="o">)</span>
<span class="c"># arch</span>
x86_64
</pre></div>
</div>
</div>
<div class="section" id="epel">
<h2>EPELリポジトリの追加</h2>
<p><a class="reference external" href="http://www.tooyama.org/yum-addrepo-epel.html">CentOS 外部レポジトリの追加(EPEL)</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># wget http://ftp-srv2.kddilabs.jp/Linux/distributions/fedora/epel/6/x86_64/epel-release-6-8.noarch.rpm</span>
<span class="c"># rpm -ivh epel-release-6-8.noarch.rpm</span>
package epel-release-6-8.noarch is already installed
</pre></div>
</div>
<p>デフォルトであるんですか、まさか、</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># git --version</span>
git version 1.7.1
</pre></div>
</div>
<p>git入ってる。いろいろ確認してみる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># make --version</span>
GNU Make 3.81
<span class="c"># automake --version</span>
automake <span class="o">(</span>GNU automake<span class="o">)</span> 1.11.1
<span class="c"># autoconf --version</span>
autoconf <span class="o">(</span>GNU Autoconf<span class="o">)</span> 2.63
<span class="c"># python --version</span>
Python 2.6.6
</pre></div>
</div>
<p>欲しいけど入ってないリスト。</p>
<ul class="simple">
<li>zsh</li>
<li>screen</li>
<li>vim 7.3(+python, +ruby)</li>
<li>ruby</li>
<li>easy_install</li>
</ul>
</div>
<div class="section" id="easy-installpip">
<h2>easy_installとpip入れる</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># yum install python-devel</span>
<span class="c"># yum install python-setuptools</span>
<span class="c"># easy_install pip</span>
</pre></div>
</div>
</div>
<div class="section" id="zsh">
<h2>zshにする</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># yum install zsh</span>
<span class="c"># chsh</span>
Changing shell <span class="k">for </span>root.
New shell <span class="o">[</span>/bin/bash<span class="o">]</span>: /bin/zsh
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>ユーザー追加する</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># useradd hoge</span>
<span class="c"># passwd hoge</span>
<span class="c"># su hoge</span>
<span class="nv">$ </span>mkdir ~/.ssh
<span class="nv">$ </span>chmod 700 ~/.ssh
<span class="nv">$ </span><span class="nb">exit</span>
<span class="c"># exit</span>
% scp ~/.ssh/id_rsa.pub hoge@xxx.xxx.xxx.xxx:~/.ssh/authorized_keys
% vim ~/.ssh/config
Host sakura
  HostName xxx.xxx.xxx.xxx
  User hoge
% ssh sakura
</pre></div>
</div>
<p>hogeユーザーでsshログインできる。</p>
</div>
<div class="section" id="root">
<h2>rootログイン禁止</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># vim /etc/ssh/sshd_config</span>
  下記の２箇所を変更
  <span class="c">#PermitRootLogin yes</span>
  PermitRootLogin no
  <span class="c">#PasswordAuthentication yes</span>
  PasswordAuthentication no
<span class="c"># /etc/init.d/sshd restart</span>
</pre></div>
</div>
</div>
<div class="section" id="sudossh">
<h2>sudoを使ってsshポート番号を変更</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>which sudo
/usr/bin/sudo
<span class="nv">$ </span>su
<span class="c"># visudo</span>
  コメントアウトを解除する
  <span class="c">## Allows people in group wheel to run all commands</span>
  %wheel  <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>       ALL
<span class="c"># vim /etc/group</span>
  wheel:x:10:hoge
<span class="c"># exit</span>
<span class="nv">$ </span>sudo vim /etc/ssh/sshd_config
  <span class="c">#Port 22</span>
  Port XXXXXX
<span class="nv">$ </span>sudo /etc/init.d/sshd restart
<span class="nv">$ </span><span class="nb">exit</span>
% vim ~/.ssh/config
  変更したポート番号を追加する
  Port XXXXX
% ssh sakura
<span class="nv">$ </span>chsh
  /bin/zsh
% <span class="nb">echo</span> <span class="nv">$SHELL</span>
/bin/zsh
</pre></div>
</div>
</div>
<div class="section" id="ssh">
<h2>他のマシンからssh</h2>
<p>鍵を追加する。</p>
<div class="highlight-bash"><div class="highlight"><pre>% scp id_rsa_other.pub sakura:~/
% ssh sakura
<span class="nv">$ </span>cat id_rsa_other.pub &gt;&gt; ~/.ssh/authorized_keys
</pre></div>
</div>
</div>
<div class="section" id="zshrc">
<h2>zshrc</h2>
<p><a class="reference external" href="https://gist.github.com/yymm/22078c9c5ded4717e64b">zshrc</a></p>
<p>コピペ。</p>
<div class="highlight-bash"><div class="highlight"><pre>% vim ~/.zshrc
% <span class="nb">source</span> ~/.zshrc
</pre></div>
</div>
</div>
<div class="section" id="ruby-rbenv">
<h2>ruby - rbenv</h2>
<div class="highlight-bash"><div class="highlight"><pre>% sudo yum install ruby
% ruby --version
ruby 1.8.7 <span class="o">(</span>2011-06-30 patchlevel 352<span class="o">)</span> <span class="o">[</span>x86_64-linux<span class="o">]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://yymm.bitbucket.org/blog/html/2013/05/30/my_first_ruby.html">はじめてのRuby — MemoBlog</a></p>
<p>そのままやって1.9.3-p429入れる。</p>
</div>
<div class="section" id="python-pythonbrew-virtualenv">
<h2>python - pythonbrew / virtualenv</h2>
<p><strong>pythonbrew</strong></p>
<p><a class="reference external" href="https://github.com/utahta/pythonbrew">utahta/pythonbrew · GitHub</a></p>
<div class="highlight-bash"><div class="highlight"><pre>% curl -kL http://xrl.us/pythonbrewinstall | bash
% vim ~/.zshrc
  <span class="c"># pythonbrew</span>
  <span class="o">[[</span> -s <span class="nv">$HOME</span>/.pythonbrew/etc/bashrc <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> <span class="nv">$HOME</span>/.pythonbrew/etc/bashrc
  <span class="nb">export </span><span class="nv">PYTHONBREW_ROOT</span><span class="o">=</span><span class="nv">$HOME</span>/.pythonbrew
% curl -kLO http://xrl.us/pythonbrewinstall
% chmod +x pythonbrewinstall
% <span class="nb">source</span> ~/.zshrc
% ./pythonbrewinstall
</pre></div>
</div>
<p><strong>virtualenv/virtualenvwrapper</strong></p>
<div class="highlight-bash"><div class="highlight"><pre>% python --version
Python 2.6.6
% sudo pip install virtualenv virtualenvwrapper
% which virtualenvwrapper.sh
/usr/bin/virtualenvwrapper.sh
% vim ~/.zshrc
  <span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span><span class="nv">$HOME</span>/.pythonenvs
  <span class="nb">source</span> /usr/bin/virtualenvwrapper.sh
% <span class="nb">source</span> ~/.zshrc
</pre></div>
</div>
</div>
<div class="section" id="vim73-python-ruby">
<h2>vim73 +python +ruby</h2>
<p>ソースコードからビルドする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pip install mercurial
<span class="nv">$ </span>yum install ncurses-devel
<span class="nv">$ </span>yum install python-devel -y
<span class="nv">$ </span>yum install ruby-devel -y
<span class="nv">$ </span>hg clone https://vim.googlecode.com/hg/ vim73
<span class="nv">$ </span><span class="nb">cd </span>vim73
<span class="nv">$ </span>./configure <span class="se">\</span>
--with-features<span class="o">=</span>huge <span class="se">\</span>
--enable-multibyte <span class="se">\</span>
--disable-selinux <span class="se">\</span>
--disable-nls <span class="se">\</span>
--disable-gui <span class="se">\</span>
--without-x <span class="se">\</span>
--enable-pythoninterp <span class="se">\</span>
--enable-rubyinterp
<span class="nv">$ </span>make
<span class="nv">$ </span>sudo ake install
</pre></div>
</div>
<p>参考記事</p>
<blockquote>
<div><a class="reference external" href="http://d.hatena.ne.jp/thinca/20080815/1218789734">vimをソースからコンパイルしてインストールしてみた - 永遠に未完成</a>
<a class="reference external" href="http://deris.hatenablog.jp/entry/20120804/1344080402">CentOSで最新ソースからvimをインストール - derisの日記</a>
<a class="reference external" href="http://qiita.com/items/4785ad6400186f820d46">CentOS6.3にvim7.3入れたのでメモ #Vim #CentOS - Qiita [キータ]</a></div></blockquote>
</div>
<div class="section" id="screen-4-01">
<h2>screen 4.01</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>git clone git://git.savannah.gnu.org/screen.git
<span class="nv">$ </span><span class="nb">cd </span>screen/src
<span class="nv">$ </span>./autogen.sh
<span class="nv">$ </span>./configure --prefix<span class="o">=</span>/usr/local --enable-pam --enable-locale --enable-telnet --enable-colors256 --enable-rxvt_osc
<span class="nv">$ </span>make
<span class="nv">$ </span>sudo make install
</pre></div>
</div>
<p>開発用の環境はできたので、次はwebサーバの設定とかを。</p>
</div>
</div>]]></description>
             <pubDate>Mon, 08 Jul 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/13/challenge_fortran.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/13/challenge_fortran.html</guid>
            <title><![CDATA[FORTRANコードを動かしてみる on Cygwin]]></title>
            <description><![CDATA[<div class="section" id="fortran-on-cygwin">
<h1>FORTRANコードを動かしてみる on Cygwin</h1>
<p>計算科学系の文献ではFortranソースを見ることが時々あリます。</p>
<p>自分も時々見かけるのでそんな時のためにメモを残しておこうかと。</p>
<p>環境: Cygwin, Vim, Fortran90</p>
<p>Let’s FORTRAN!</p>
<p>「！」以外で始まる各行は先頭に６文字以上スペースを入れてください。</p>
<p>!?</p>
<p>「！」以外で始まる各行は先頭に６文字以上スペースを入れてください。</p>
<p>!!??</p>
<div class="highlight-vim"><div class="highlight"><pre>autocmd <span class="nb">FileType</span> fortran <span class="k">setl</span> <span class="nb">textwidth</span><span class="p">=</span><span class="m">6</span>
</pre></div>
</div>
<p>どこかにあったFortranソース。</p>
<div class="highlight-fortran"><div class="highlight"><pre>      <span class="nv">W</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span><span class="p">)</span>
      <span class="nv">SIG</span><span class="o">=</span><span class="mi">2</span>
      <span class="k">DO </span><span class="mi">30</span> <span class="nv">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
      <span class="k">IF</span><span class="p">(</span><span class="nv">SIG</span><span class="ow">.GT.</span><span class="nv">W</span><span class="p">(</span><span class="nv">J</span><span class="p">))</span> <span class="k">GOTO </span><span class="mi">30</span>
      <span class="k">PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">J</span>
      <span class="nv">SIG</span><span class="o">=</span><span class="nv">W</span><span class="p">(</span><span class="nv">J</span><span class="p">)</span>
<span class="mi">30</span>    <span class="k">CONTINUE</span>
</pre></div>
</div>
<p>Error: Unexpected end of file in ‘/path/to/sample.f90’</p>
<p>なんかだめ。</p>
<p>さらっとGoogle先生で調べたけどわからなかったが、FortranソースにはPROGRAMとかいう記述が必要だったような。。。</p>
<div class="highlight-fortran"><div class="highlight"><pre>      <span class="k">PROGRAM </span><span class="nv">SAMPLE</span>
      <span class="kt">INTEGER </span><span class="nv">W</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
      <span class="nv">W</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span><span class="p">)</span>
      <span class="nv">SIG</span><span class="o">=</span><span class="mi">2</span>
      <span class="k">DO </span><span class="mi">30</span> <span class="nv">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
      <span class="k">IF</span><span class="p">(</span><span class="nv">SIG</span><span class="ow">.GT.</span><span class="nv">W</span><span class="p">(</span><span class="nv">J</span><span class="p">))</span> <span class="k">GOTO </span><span class="mi">30</span>
      <span class="k">PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">J</span>
      <span class="nv">SIG</span><span class="o">=</span><span class="nv">W</span><span class="p">(</span><span class="nv">J</span><span class="p">)</span>
<span class="mi">30</span>    <span class="k">CONTINUE</span>
<span class="k">      END PROGRAM </span><span class="nv">SAMPLE</span>
</pre></div>
</div>
<p>2,3,4,5と表示されたということで実行できた。PROGRAMが必要なのね。</p>
<p>quickrun.vimを使って実行しています。quickrun便利(使いこなせてないけど)</p>
<div class="section" id="id1">
<h2>型</h2>
<table border="1" class="docutils">
<colgroup>
<col width="49%"/>
<col width="51%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>INTEGER</td>
<td>整数型</td>
</tr>
<tr class="row-odd"><td>REAL</td>
<td>実数型</td>
</tr>
<tr class="row-even"><td>DOUBLE PRECISION</td>
<td>倍精度浮動小数点型</td>
</tr>
<tr class="row-odd"><td>COMPLEX</td>
<td>複素数型</td>
</tr>
<tr class="row-even"><td>LOGICAL</td>
<td>論理型</td>
</tr>
<tr class="row-odd"><td>CHARACTER</td>
<td>文字型</td>
</tr>
</tbody>
</table>
<div class="section" id="id2">
<h3>倍精度実数の使用</h3>
<div class="highlight-fortran"><div class="highlight"><pre><span class="kt">REAL</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">x</span><span class="p">,</span> <span class="nv">y</span><span class="p">,</span> <span class="nv">z</span>
</pre></div>
</div>
<p>implicitであらかじめa-h, o-zで始まる変数名は倍精度実数とする指定をすることが多い。</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">IMPLICIT </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span> <span class="p">(</span><span class="nv">A</span><span class="o">-</span><span class="nv">H</span><span class="p">,</span> <span class="nv">O</span><span class="o">-</span><span class="nv">Z</span><span class="p">)</span>
</pre></div>
</div>
<p>implicitはプログラムの先頭で行う。</p>
</div>
<div class="section" id="id3">
<h3>0.0の扱い</h3>
<div class="highlight-fortran"><div class="highlight"><pre><span class="c">! 単精度0.0で初期化(小数点7桁以下の精度は保証されない)</span>
<span class="kt">REAL </span><span class="nb">SUM</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c">! 精度が重要である場合には倍精度で初期化する</span>
<span class="nb">SUM</span> <span class="o">=</span> <span class="mf">0.0</span><span class="nv">D0</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>暗黙の約束</h3>
<p>i, j, k, l, m, nで始まる変数は整数型でそれ以外は実数型と扱われる。</p>
<p>この約束を取り消すには</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">IMPLICIT NONE</span>
</pre></div>
</div>
<p>とする。</p>
</div>
</div>
<div class="section" id="id5">
<h2>演算子</h2>
<table border="1" class="docutils">
<colgroup>
<col width="42%"/>
<col width="58%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>+</td>
<td>+</td>
</tr>
<tr class="row-odd"><td>-</td>
<td>-</td>
</tr>
<tr class="row-even"><td>*</td>
<td>*</td>
</tr>
<tr class="row-odd"><td>/</td>
<td>/</td>
</tr>
<tr class="row-even"><td>x**n</td>
<td>x <sup>n</sup></td>
</tr>
<tr class="row-odd"><td>sin(x)</td>
<td>sin(x)</td>
</tr>
<tr class="row-even"><td>cos(x)</td>
<td>con(x)</td>
</tr>
<tr class="row-odd"><td>tan(x)</td>
<td>tan(x)</td>
</tr>
<tr class="row-even"><td>atan(x)</td>
<td>atan(x)</td>
</tr>
<tr class="row-odd"><td>exp(x)</td>
<td>e <sup>x</sup></td>
</tr>
<tr class="row-even"><td>log(x)</td>
<td>log(x)</td>
</tr>
<tr class="row-odd"><td>sqrt(x)</td>
<td>sqrt(x)</td>
</tr>
<tr class="row-even"><td>abs(x)</td>
<td>abs(x)</td>
</tr>
<tr class="row-odd"><td>sign(x)</td>
<td>x / |x|</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id6">
<h2>入出力</h2>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>
</pre></div>
</div>
<p>*はフォーマット指定。*を指定すると適当な書式が選択される。(コンパイラ依存)</p>
<p>WRITEで同じ事ができますが、冗長になってしまうのでPRINTを使う。</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">READ</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">,</span> <span class="nv">C</span>
</pre></div>
</div>
<p>PRINTと同様に*を指定すると、適切な書式が自動で指定されます。</p>
<ul class="simple">
<li>ENTERが入力されるまで読み込みます</li>
<li>複数並べると、スペース区切りで読み込みを行います</li>
</ul>
</div>
<div class="section" id="id7">
<h2>配列</h2>
<ul class="simple">
<li>インデックスはデフォルトでは1から</li>
<li>メモリ上にはColumn Majorの順で配置される</li>
</ul>
<div class="highlight-fortran"><div class="highlight"><pre><span class="kt">REAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">A</span>
<span class="kt">REAL </span><span class="nv">B</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nv">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">D</span>
</pre></div>
</div>
<p>インデックスを0から指定したい場合は以下のように宣言する。</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="kt">REAL </span><span class="nv">A</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id8">
<h3>配列の初期化</h3>
<div class="highlight-fortran"><div class="highlight"><pre><span class="c">! 全て0に初期化</span>
<span class="kt">REAL</span> <span class="kd">::</span> <span class="nv">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c">! 多次元配列も同様</span>
<span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">b</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>配列構成子</h3>
<p>/(ここに配列の構成を記述)/</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="kt">INTEGER </span><span class="nv">A</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nv">A</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span><span class="p">)</span>
<span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nv">B</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span><span class="p">)</span>
<span class="kt">REAL</span> <span class="kd">::</span> <span class="nv">C</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.</span> <span class="o">/</span><span class="p">)</span>
<span class="c">! 1,2,3,4,5 : DO型反復</span>
<span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nv">D</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="p">(</span><span class="nv">i</span><span class="p">,</span><span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="c">! 5,10,15,20,25,30</span>
<span class="kt">REAL</span> <span class="kd">::</span> <span class="nv">E</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="p">(</span><span class="nv">i</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
</pre></div>
</div>
<p>reshape関数を使うことによって更に柔軟な指定が可能になります</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="c">! 1,3,5</span>
<span class="c">! 2,4,6</span>
<span class="kt">REAL</span> <span class="kd">::</span> <span class="nv">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">RESHAPE</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="o">/</span><span class="p">),</span> <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span> <span class="p">)</span>
<span class="kt">REAL</span> <span class="kd">::</span> <span class="nv">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">RESHAPE</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="o">/</span><span class="p">),</span> <span class="nb">SHAPE</span><span class="p">(</span><span class="nv">a</span><span class="p">)</span> <span class="p">)</span>
<span class="c">! DO型反復も使用可能</span>
<span class="c">! 1,5,9</span>
<span class="c">! 2,6,10</span>
<span class="c">! 3,7,11</span>
<span class="c">! 4,8,12</span>
<span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nv">C</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">RESHAPE</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span> <span class="p">(</span><span class="nv">i</span><span class="p">,</span><span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="o">/</span><span class="p">),</span> <span class="nb">SHAPE</span><span class="p">(</span><span class="nv">b</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>一括代入</h3>
<div class="highlight-fortran"><div class="highlight"><pre><span class="kt">INTEGER </span><span class="nv">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c">! 10,10,10</span>
<span class="nv">A</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c">! 11,11,11</span>
<span class="nv">A</span> <span class="o">=</span> <span class="nv">A</span> <span class="o">+</span> <span class="mi">1</span>
<span class="kt">INTEGER </span><span class="nv">B</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nv">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nv">B</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nv">C</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c">! 20,20,20</span>
<span class="nv">A</span> <span class="o">=</span> <span class="nv">B</span> <span class="o">+</span> <span class="nv">C</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id11">
<h2>ループ</h2>
<div class="highlight-fortran"><div class="highlight"><pre>     <span class="k">DO </span><span class="mi">20</span> <span class="nv">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nv">M</span>
       <span class="k">DO </span><span class="mi">10</span> <span class="nv">J</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nv">N</span>
         <span class="nv">a</span><span class="p">(</span><span class="nv">I</span><span class="p">,</span><span class="nv">J</span><span class="p">)</span> <span class="o">=</span> <span class="nv">I</span><span class="o">*</span><span class="nv">M</span>
<span class="mi">10</span>     <span class="k">CONTINUE</span>
<span class="mi">20</span>   <span class="k">CONTINUE</span>
</pre></div>
</div>
</div>
<div class="section" id="goto">
<h2>GOTO文</h2>
<div class="highlight-fortran"><div class="highlight"><pre>    <span class="k">GOTO </span><span class="mi">10</span>
    <span class="nv">GO</span> <span class="nv">TO</span> <span class="mi">10</span>
<span class="mi">10</span>  <span class="k">IF </span><span class="nv">A</span><span class="ow">.LT.</span><span class="nv">B</span> <span class="k">PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>
</pre></div>
</div>
</div>
<div class="section" id="if">
<h2>if文</h2>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">IF</span><span class="p">(</span><span class="nv">A</span><span class="ow">.LT.</span><span class="nv">B</span><span class="p">)</span> <span class="k">PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>

<span class="k">IF</span><span class="p">(</span><span class="nv">A</span><span class="ow">.GT.</span><span class="nv">B</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">  PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">B</span>
<span class="k">ELSE</span>
<span class="k">  PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>

<span class="k">IF</span><span class="p">(</span><span class="nv">A</span><span class="ow">.EQ.</span><span class="nv">B</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">  PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>
<span class="k">ELSE IF</span><span class="p">(</span><span class="nv">A</span><span class="ow">.LT.</span><span class="nv">B</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">  PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">A</span>
<span class="k">ELSE</span>
<span class="k">  PRINT</span> <span class="o">*</span> <span class="p">,</span> <span class="nv">B</span>
</pre></div>
</div>
<div class="section" id="id12">
<h3>比較演算子</h3>
<table border="1" class="docutils">
<colgroup>
<col width="19%"/>
<col width="19%"/>
<col width="62%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">or</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>A.LT.B</td>
<td>A &lt; B</td>
<td>Less Than</td>
</tr>
<tr class="row-odd"><td>A.LE.B</td>
<td>A &lt;= B</td>
<td>Less than over Eaual to</td>
</tr>
<tr class="row-even"><td>A.EQ.B</td>
<td>A == B</td>
<td>EQual to</td>
</tr>
<tr class="row-odd"><td>A.NE.B</td>
<td>A /= B</td>
<td>Not Equal to</td>
</tr>
<tr class="row-even"><td>A.GT.B</td>
<td>A &gt; B</td>
<td>Greater Than</td>
</tr>
<tr class="row-odd"><td>A.GE.B</td>
<td>A &gt;= B</td>
<td>Greater than over Equal to</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id13">
<h3>論理演算子</h3>
<table border="1" class="docutils">
<colgroup>
<col width="20%"/>
<col width="34%"/>
<col width="46%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
<th class="head">Usage</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>.NOT.</td>
<td>not</td>
<td>.NOT. A.EQ.B</td>
</tr>
<tr class="row-odd"><td>.AND.</td>
<td>and</td>
<td>A.EQ.B .AND. A.EQ.C</td>
</tr>
<tr class="row-even"><td>.OR.</td>
<td>or</td>
<td>A.LT.B .OR. A.LT.C</td>
</tr>
<tr class="row-odd"><td>.EQV.</td>
<td>logical eq</td>
<td>A&lt;0 .EQV. B&lt;0</td>
</tr>
<tr class="row-even"><td>.NEQV.</td>
<td>logical not eq</td>
<td>A&lt;0 .NEQV. B&lt;0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id14">
<h2>関数</h2>
<p>PROGRAMではなくSUBROUTINEで宣言する</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">SUBROUTINE </span><span class="nv">HOGE</span><span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">,</span> <span class="nv">C</span><span class="p">)</span>
  <span class="kt">INTEGER </span><span class="nv">A</span>
  <span class="kt">REAL </span><span class="nv">B</span>
  <span class="kt">CHARACTER </span><span class="nv">C</span>
<span class="k">END SUBROUTINE</span>
</pre></div>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 13 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/07/new_tinkerer_theme.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/07/new_tinkerer_theme.html</guid>
            <title><![CDATA[Tinkerer 1.2 Release!]]></title>
            <description><![CDATA[<div class="section" id="tinkerer-1-2-release">
<h1>Tinkerer 1.2 Release!</h1>
<p>Tinkererのテーマをいじろうかどうか迷っていた矢先にバージョンアップが。</p>
<p>しかも新テーマflatが。</p>
<p><a class="reference external" href="http://tinkerer.me/index_flat.html">Home — Tinkerer</a> かっけぇ。</p>
<p>シンプルで良い感じ。</p>
<p>即conf.pyをいじった。</p>
<p>pipでパッケージを更新するのはなにげに初めてだった。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>workon Tinker
<span class="nv">$ </span>pip install tinkerer -U
<span class="nv">$ </span>vim conf.py
dark -&gt; flat
<span class="nv">$ </span>tinker -b
<span class="nv">$ </span>hg add
<span class="nv">$ </span>hg ci -m <span class="s2">&quot;use flat!&quot;</span>
<span class="nv">$ </span>hg push
</pre></div>
</div>
<p>pip updateかあるのかと思ったけど、-U(or –upgrade)オプションを付ければいい。</p>
</div>]]></description>
             <pubDate>Fri, 07 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean4.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean4.html</guid>
            <title><![CDATA[Maclean4 - Dev3]]></title>
            <description><![CDATA[<div class="section" id="maclean4-dev3">
<h1>Maclean4 - Dev3</h1>
<p>MacTips的な。</p>
<ol class="arabic simple">
<li>システム環境設定</li>
<li>キーボード</li>
<li>修飾キー...</li>
<li>Caps Lock キー</li>
<li>Controlに変更</li>
</ol>
<p>この5ステップでCapsLockキーをControlにできる。</p>
<div class="section" id="python">
<h2>Python環境</h2>
<p>pythonbrewとvirtualenv&amp;virtualenvwrapperを入れる。</p>
<div class="section" id="pythonbrew">
<h3>pythonbrew</h3>
<p><a class="reference external" href="https://github.com/utahta/pythonbrew">utahta/pythonbrew · GitHub</a></p>
<p>README通りに行えばインストールは簡単に完了する。</p>
<p>pathは$HOME/.pythonbrew</p>
</div>
<div class="section" id="virtualenv">
<h3>virtualenv</h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install virtualenv virtualenvwrapper
</pre></div>
</div>
<p>.zshrcに以下を書き込む</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># virtualenv setting</span>
<span class="nv">VIRTUALENVWRAPPER_PYTHON</span><span class="o">=</span>/usr/local/bin/python
<span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span><span class="nv">$HOME</span>/.pythonenvs
<span class="nb">source</span> /usr/local/share/python/virtualenvwrapper.sh
</pre></div>
</div>
<p>Macの場合、virtualenvwrapper.shは/usr/local/share/pythonにある。</p>
<p>Linuxとかだと、/usr/local/bin。</p>
</div>
</div>
<div class="section" id="vim">
<h2>Vim</h2>
<p><a class="reference external" href="https://gist.github.com/yymm/ddf1798af3c0ce253e3e">my vimrc</a></p>
<p>をコピペして:NeoBundleInstallで完成。</p>
<p>日本語を使うのであれば、iTerm2のPreferencesのProfiles/Textにある</p>
<p>Double-Width Characters: Treat ambigous-width characters as double widthにチェックを入れておく。(でないと時々とんでもなくずれたりする)</p>
</div>
<div class="section" id="sublime-text-2">
<h2>Sublime Text 2</h2>
<p><a class="reference external" href="http://www.sublimetext.com">Sublime Text: The text editor you’ll fall in love with</a></p>
<p>なんかあった時のためのGUIエディタはSublimeにする。</p>
<p>プラグインやら設定やらできるみたいだが、やる気が出た時のためにとっておこう。</p>
</div>
<div class="section" id="mercurial">
<h2>Mercurial</h2>
<p>gitよりもhgを愛用中。Python環境もできてやっとインストール。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install mercurial
<span class="nv">$ </span>vim ~/.hgrc
<span class="o">[</span>ui<span class="o">]</span>
<span class="nv">username</span> <span class="o">=</span> hoge hogeo &lt;hoge@hoge.com&gt;
</pre></div>
</div>
<p>pipでインストールしたものは/usr/local/share/pythonに入るのでパスを通しておかないとhgコマンドが叩けない。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>vim ~/.zshrc
<span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/local/share/python:<span class="nv">$HOME</span>/.rbenv/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p>MacではPATHをこんな感じに設定しておくことにする。</p>
</div>
<div class="section" id="ssh">
<h2>SSH</h2>
<p>サーバとかGithubやらBitbucketを使う際にsshが必要。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ssh-keygen
</pre></div>
</div>
<p>とりあえず、作成されたid_rsa.pubをコピーしてGithub、Bitbucketに登録。</p>
</div>
<div class="section" id="mac">
<h2>完成したMac</h2>
<ul class="simple">
<li>Firefox<ul>
<li>Vimperator</li>
<li>LastPass</li>
<li>Firebug</li>
<li>MyBookmarks</li>
</ul>
</li>
<li>iTerm2<ul>
<li>zsh 4.3.9</li>
<li>screen 4.01.00devel 2-May-06</li>
<li>vim 7.3.p923 +python +ruby</li>
<li>Python 2.7.5<ul>
<li>pythonbrew</li>
<li>virtualenv</li>
</ul>
</li>
<li>Ruby 1.9.3<ul>
<li>rbenv</li>
</ul>
</li>
<li>Git 1.8.3</li>
<li>Mercurial 2.6.2</li>
</ul>
</li>
<li>Sublime Text 2</li>
<li>Mozc</li>
<li>Alfred</li>
</ul>
</div>
</div>]]></description>
             <pubDate>Thu, 06 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean3.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean3.html</guid>
            <title><![CDATA[Maclean3 - Dev2]]></title>
            <description><![CDATA[<div class="section" id="maclean3-dev2">
<h1>Maclean3 - Dev2</h1>
<p>zsh + screen + vim(+python +ruby)な環境を作る。</p>
<div class="section" id="id1">
<h2>ビルド環境</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>automake --version
automake <span class="o">(</span>GNU automake<span class="o">)</span> 1.10
Written by Tom Tromey &lt;tromey@redhat.com&gt;
       and Alexandre Duret-Lutz &lt;adl@gnu.org&gt;.

Copyright 2006 Free Software Foundation, Inc.
This is free software; see the <span class="nb">source </span><span class="k">for </span>copying conditions.  There is NO
warranty; not even <span class="k">for </span>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
<span class="nv">$ </span>autoconf --version
autoconf <span class="o">(</span>GNU Autoconf<span class="o">)</span> 2.61
Copyright <span class="o">(</span>C<span class="o">)</span> 2006 Free Software Foundation, Inc.
This is free software.  You may redistribute copies of it under the terms of
the GNU General Public License &lt;http://www.gnu.org/licenses/gpl.html&gt;.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille.
</pre></div>
</div>
<p>ちょっと古い。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>brew install automake
<span class="nv">$ </span>brew install autoconf
<span class="nv">$ </span>automake --version
automake <span class="o">(</span>GNU automake<span class="o">)</span> 1.10
Written by Tom Tromey &lt;tromey@redhat.com&gt;
       and Alexandre Duret-Lutz &lt;adl@gnu.org&gt;.

Copyright 2006 Free Software Foundation, Inc.
This is free software; see the <span class="nb">source </span><span class="k">for </span>copying conditions.  There is NO
warranty; not even <span class="k">for </span>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</pre></div>
</div>
<p>変わってねーし。</p>
<p>どうにかせねば。</p>
</div>
<div class="section" id="brew">
<h2>brewを使いこなす</h2>
<p><a class="reference external" href="http://takuya-1st.hatenablog.jp/entry/20111224/1324750111">ＨｏｍｅＢｒｅｗの仕組みについてまとめておく - それマグで！</a></p>
<p>HomeBrewについてはこのエントリが詳しかった。</p>
<p>brewでinstallしたパッケージは</p>
<div class="highlight-bash"><div class="highlight"><pre>/usr/local/Celler
</pre></div>
</div>
<p>にインストールされて、/usr/local/binにシンボリックリンクが作成される。</p>
<p>gitは良い感じにインストールされてたけど、automakeとautoconfはシンボリック作成されてなかった。</p>
<p>/binとか/usr/binとかに先に入ってたらダメなのか？</p>
<p>試しにwget入れてみたけど、/usr/local/binにシンボリックリンクある。そういうことなのか・・・</p>
<div class="section" id="id2">
<h3>シンボリックリンクない場合</h3>
<p>シンボリックリンク作成されてなかった場合、以下のコマンドを実行する。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> /usr/local/bin
<span class="nv">$ </span>lndir ../Cellar/&lt;package-name&gt;/&lt;version&gt;/bin/ ./
</pre></div>
</div>
</div>
<div class="section" id="path">
<h3>PATHの優先順位を変更</h3>
<p>/binや/usr/binより/usr/local/binを優先させる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>vim ~/.zshrc
<span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/local/sbin:<span class="nv">$PATH</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="zsh">
<h2>Zsh</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>zsh --version
zsh 4.3.9 <span class="o">(</span>i386-apple-darwin10.0<span class="o">)</span>
<span class="nv">$ </span>which zsh
/bin/zsh
<span class="nv">$ </span>chsh
変更 /bin/bash -&gt; /bin/zsh
</pre></div>
</div>
<p>デフォルトで入ってるのでok</p>
</div>
<div class="section" id="screen">
<h2>Screen</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>screen --version
Screen version 4.00.03 <span class="o">(</span>FAU<span class="o">)</span> 23-Oct-06
</pre></div>
</div>
<p>縦分割はできたほうがやる気でるので4.01を使う。</p>
<p>前の自分の記事で最新版screenを入れる方法についてまとめてある。</p>
<p><a class="reference external" href="http://yymm.bitbucket.org/blog/html/2013/03/29/screen.html">GNU Screen — MemoBlog</a></p>
<p>2013/06/03現在ではパッチを当てていた部分は修正されているので、パッチ当てなくてもいい。</p>
<p>HomeBrewのパッケージ内には入らないので注意する。</p>
</div>
<div class="section" id="python">
<h2>Python</h2>
<p>Python 2.7.5を標準にする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>brew install python
</pre></div>
</div>
<p>以下のパッケージがインストールされる</p>
<ul class="simple">
<li>pkg-config</li>
<li>readline</li>
<li>sqlite3.7.17(デフォルトが入っているので/usr/local/binにシンボリックリンクは作成されない)</li>
<li>gdbm</li>
<li>python2.7.5</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python --version
Python 2.7.5
</pre></div>
</div>
</div>
<div class="section" id="ruby">
<h2>Ruby</h2>
<p>Ruby 1.9.3を標準にする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>brew install ruby-build
<span class="nv">$ </span>brew install rbenv
</pre></div>
</div>
<p>readlineが必要だがpythonの時の依存関係でインストール済みなので入れなくてもいい。</p>
<p>あとは自分のエントリにも書いてあるように.zshrcの設定とruby-buildプラグインを入れる。</p>
<p><a class="reference external" href="http://yymm.bitbucket.org/blog/html/2013/05/30/my_first_ruby.html">はじめてのRuby — MemoBlog</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ruby --version
ruby 1.9.3p429 <span class="o">(</span>2013-05-15 revision 40747<span class="o">)</span> <span class="o">[</span>x86_64-darwin10.8.0<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="vim">
<h2>Vim</h2>
<p>+python +rubyのVimを作る。(なので際にPythonとRuby入れた)</p>
<p><a class="reference external" href="http://rochefort.hatenablog.com/entry/20100913/p1">vim-ruby入れようとしてbrewのvimで嵌った - rochefort’s blog</a></p>
<p>ここのFormulaを参考にする。</p>
<p>/usr/local/Library/Formula/vim.rbの./configureのオプションに以下を追加。</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="s2">&quot;--disable-nls&quot;</span><span class="p">,</span>
<span class="s2">&quot;--enable-pythoninterp&quot;</span><span class="p">,</span>
<span class="s2">&quot;--enable-rubyinterp&quot;</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>brew install vim
<span class="nv">$ </span><span class="nb">source</span> ~/.zshrc
<span class="nv">$ </span>vim --version
VIM - Vi IMproved 7.3 <span class="o">(</span>2010 Aug 15, compiled Jun  3 2013 22:51:14<span class="o">)</span>
MacOS X <span class="o">(</span>unix<span class="o">)</span> version
Included patches: 1-923
</pre></div>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 06 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean2.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/06/maclean2.html</guid>
            <title><![CDATA[Maclean2 - Dev]]></title>
            <description><![CDATA[<div class="section" id="maclean2-dev">
<h1>Maclean2 - Dev</h1>
<p>前回のは基本的な設定のみしかしてないのでいろいろ詳細を設定する。</p>
<div class="section" id="homebrew">
<h2>HomeBrew</h2>
<p>MacPortよりHomeBrew。</p>
<ul class="simple">
<li><a class="reference external" href="http://mxcl.github.io/homebrew">http://mxcl.github.io/homebrew/</a></li>
<li><a class="reference external" href="http://tech.caph.jp/2011/04/06/homebrew%E3%81%AE%E5%B0%8E%E5%85%A5%E3%81%A8%E4%BD%BF%E3%81%84%E6%96%B9">http://tech.caph.jp/2011/04/06/homebrew%E3%81%AE%E5%B0%8E%E5%85%A5%E3%81%A8%E4%BD%BF%E3%81%84%E6%96%B9/</a></li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ruby -e <span class="s2">&quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</span>
<span class="nv">$ </span>brew install git
<span class="nv">$ </span>brew doctor
<span class="nv">$ </span>brew update
</pre></div>
</div>
<p>開発系なパッケージ管理はHomeBrewからやろう。</p>
</div>
<div class="section" id="growl">
<h2>Growl</h2>
<p><a class="reference external" href="http://growl.info">Growl</a></p>
<p>Mac用のポップアップ通知システム。</p>
<p>1.3から有料になってしまっている。</p>
<p>1.2なら無料。<a class="reference external" href="https://code.google.com/p/growl">growl - A notification system for Mac OS X. - Google Project Hosting</a></p>
<p>というわけで1.2.2をインストール。</p>
<p>最新版との違いは調べていないので分からないが、なんか不具合があってから調べるで問題ないかな。</p>
<p>コードをhgで落としてビルドするという荒業を使えば1.3以降のバージョン(最新版)も使えるみたい。</p>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/shigemk2/20111125/1322210387">Growl 1.3を無料でインストールする - by shigemk2</a></li>
<li><a class="reference external" href="http://veadardiary.blog29.fc2.com/blog-entry-3609.html">有料になってしまったGrowl 1.3を無料でインストールする方法 - Macの手書き説明書</a></li>
</ul>
<p>Lionからは標準の通知システムが有るらしい。いいな。</p>
</div>
<div class="section" id="firefox">
<h2>Firefox</h2>
<p>プラグイン</p>
<ul class="simple">
<li>vimperator</li>
<li>lastpass</li>
<li>firebug</li>
<li>mybookmarks</li>
</ul>
<p>アドオンで検索すれば全部見つかるのでインストールからの再起動。</p>
<p>テーマはこれ。</p>
<p><a class="reference external" href="https://addons.mozilla.org/ja/firefox/addon/monokuro-boo-pigs">Monokuro Boo Pigs :: Add-ons for Firefox</a></p>
<p>モノクロのブタさんを愛用。</p>
<div class="section" id="vimperator">
<h3>vimperator</h3>
<p>Vimmerの必需品。もう普通のFirefoxには戻れない。</p>
<p><a class="reference external" href="https://gist.github.com/yymm/3000407">vimperator setting file</a></p>
<p>~/.vimperatorrcに配置。</p>
<p>カラースキーム、プラグインのフォルダ配置。</p>
<p>プラグインはリポジトリから落として、必要に応じてコピーする。</p>
<p><a class="reference external" href="https://github.com/vimpr/vimperator-plugins">vimpr/vimperator-plugins · GitHub</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> ~/.vimperator
<span class="nv">$ </span>git clone https://github.com/vimpr/vimperator-plugins
</pre></div>
</div>
<p>とりあえずこれだけ入れる。</p>
<ul class="simple">
<li>_libly.js</li>
<li>_smooziee.js</li>
<li><a class="reference external" href="https://gist.github.com/yymm/f36d681650015cd216c0">vimperator_copy.js</a></li>
</ul>
<p>Firefox20からjsまわりが変更になってるのでちょくちょくプラグイン更新したほうがいいかも。</p>
<p>カラースキームはGistに。</p>
<p><a class="reference external" href="https://gist.github.com/yymm/5689022">yymm_sweets.vimp</a></p>
<p>フォルダ構成はこうなる。</p>
<div class="highlight-bash"><div class="highlight"><pre>&gt; .vimperator
  &gt; colors
  &gt; info
  &gt; plugin
  &gt; vimperator-plugins
</pre></div>
</div>
<p>結果こんなFirefoxになる。</p>
<img alt="../../../_images/firefox_img.png" src="http://yymm.bitbucket.org/blog/html/_images/firefox_img.png"/>
</div>
</div>
<div class="section" id="id2">
<h2>ゆたぽん</h2>
<p><a class="reference external" href="http://net2.system.to/pc/font.html">font　ゆたぽん（コーディング）　フォント</a></p>
<p>フォントがゆたぽんじゃないと体調が悪くなってくるので早く入れないと。</p>
<p>Macに.ttc投げてもダメっぽいので(試してないけど)、otfに変換してインストールする。</p>
<p>otfのゆたぽんをシェアウェアとしてリリースしてあった。ただじゃないと嫌なので頑張る。(ベータ版はタダ)</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/kitchan_jp/20110418/1303140241">Macにフォント「ゆたぽん（コーディング）」をインストールしてみた。 - Life is Over</a></p>
<p>このエントリで紹介している方法は以下の感じ</p>
<ol class="arabic simple">
<li>Windowsにゆたぽんをダウンロード</li>
<li>UniteTTCなるアプリでttfに分離</li>
<li>OTEditなるアプリ(無料は30日間)でttfをotfに変換 -&gt; よくわからなかったらここ <a class="reference external" href="http://opentype.jp/ttf2otf.htm">TrueTypeフォントからOpenTypeフォントへの変換方法</a></li>
<li>Macにotfを移動して、otfファイルをダブルクリックでFontBookに追加</li>
<li>iTerm2のPreferencesでフォントをゆたぽんに</li>
</ol>
<img alt="../../../_images/yutapon_iterm.png" src="http://yymm.bitbucket.org/blog/html/_images/yutapon_iterm.png"/>
</div>
</div>]]></description>
             <pubDate>Thu, 06 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/03/cutest.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/03/cutest.html</guid>
            <title><![CDATA[CuTest]]></title>
            <description><![CDATA[<div class="section" id="cutest">
<h1>CuTest</h1>
<p>C言語軽量テストフレームワーク。</p>
<p>CuTest.hとCuTest.cで構成されるフレームワーク。</p>
<p>機能は最小限だが、ソースで提供されているのでプロジェクトに気軽に組み込める。</p>
<p>というわけなのでダウンロードするだけで使える。</p>
<p><a class="reference external" href="http://sourceforge.net/projects/cutest/files/latest/download">Download CuTest: C Unit Testing Framework from SourceForge.net</a></p>
<div class="section" id="assert-macro">
<h2>Assert Macro</h2>
<p>Assertマクロは以下の13個。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#define CuFail(tc, ms)</span>
<span class="cp">#define CuAssert(tc, ms, cond)</span>
<span class="cp">#define CuAssertTrue(tc, cond)</span>
<span class="cp">#define CuAssertStrEquals(tc,ex,ac)</span>
<span class="cp">#define CuAssertStrEquals_Msg(tc,ms,ex,ac)</span>
<span class="cp">#define CuAssertIntEquals(tc,ex,ac)</span>
<span class="cp">#define CuAssertIntEquals_Msg(tc,ms,ex,ac)</span>
<span class="cp">#define CuAssertDblEquals(tc,ex,ac,dl)</span>
<span class="cp">#define CuAssertDblEquals_Msg(tc,ms,ex,ac,dl)</span>
<span class="cp">#define CuAssertPtrEquals(tc,ex,ac)</span>
<span class="cp">#define CuAssertPtrEquals_Msg(tc,ms,ex,ac)</span>
<span class="cp">#define CuAssertPtrNotNull(tc,p)</span>
<span class="cp">#define CuAssertPtrNotNullMsg(tc,msg,p)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>引数の説明</h3>
<dl class="docutils">
<dt>tc</dt>
<dd>CuTest*型、CuTest構造体のインスタンスを入れる。すべて共通。</dd>
<dt>ms</dt>
<dd>メッセージ(char*)</dd>
<dt>cond</dt>
<dd>True(1) or False(0)</dd>
<dt>ex</dt>
<dd>expectedの略、期待される値</dd>
<dt>ac</dt>
<dd>actualの略、実際の値</dd>
<dt>dl</dt>
<dd>deltaの略、double比較の際に用いる誤差</dd>
<dt>p</dt>
<dd>pointer</dd>
</dl>
</div>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<p>このCuTestはmake_tests.shというスクリプトが同封されていて、テストコードが入ったフォルダで実行する。</p>
<p>今回サンプルとしてtest.cを作成した。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdlib.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>
<span class="cp">#include &quot;CuTest.h&quot;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">Lens</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Lens</span><span class="p">;</span>

<span class="k">static</span> <span class="n">Lens</span><span class="o">*</span> <span class="n">lens</span><span class="p">;</span>



<span class="kt">void</span> <span class="nf">Test_setup</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lens</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Lens</span><span class="p">));</span>
	<span class="n">lens</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="mi">256</span><span class="p">);</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">lens</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;SiO2&quot;</span><span class="p">);</span>
	<span class="n">lens</span><span class="o">-&gt;</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
	<span class="cm">/*CuAssert(tc, &quot;Setup&quot;, 1);*/</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_teardown</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">free</span><span class="p">(</span><span class="n">lens</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">lens</span><span class="p">);</span>
	<span class="cm">/*CuAssert(tc, &quot;Teardown&quot;, 0);*/</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_lens</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CuAssertStrEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">lens</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;Si02&quot;</span><span class="p">);</span>
	<span class="n">CuAssertIntEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">lens</span><span class="o">-&gt;</span><span class="n">radius</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_Fail</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CuFail</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;失敗する&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_Assert</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cond</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">CuAssert</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;cond=0でアサートする&quot;</span><span class="p">,</span> <span class="n">cond</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertTrue</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cond</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">CuAssertTrue</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">cond</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertStr</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">actual</span> <span class="o">=</span> <span class="s">&quot;Helle&quot;</span><span class="p">;</span>
	<span class="n">CuAssertStrEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
	<span class="c1">// １つのテストメソッドに複数のAssertマクロを入れる場合</span>
	<span class="c1">// 先に失敗すると次まで流れない。</span>
	<span class="n">CuAssertStrEquals_Msg</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;Helloじゃないじゃん！Typoじゃね？&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertStrMsg</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">actual</span> <span class="o">=</span> <span class="s">&quot;Helle&quot;</span><span class="p">;</span>
	<span class="n">CuAssertStrEquals_Msg</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;Helloじゃないじゃん！Typoじゃね？&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertInt</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CuAssertIntEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertDbl</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CuAssertDblEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertDblMsg</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CuAssertDblEquals_Msg</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="s">&quot;Delta=0.001(こんな感じに誤差を書いたほうがいいかも)&quot;</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Test_AssertPtr</span><span class="p">(</span><span class="n">CuTest</span><span class="o">*</span> <span class="n">tc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">);</span>
	<span class="n">CuAssertPtrEquals</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">CuSuite</span><span class="o">*</span> <span class="nf">StrUtilGetSuite</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">CuSuite</span><span class="o">*</span> <span class="n">suite</span> <span class="o">=</span> <span class="n">CuSuiteNew</span><span class="p">();</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_setup</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_Fail</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_Assert</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertTrue</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertStr</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertStrMsg</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertInt</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertDbl</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_AssertPtr</span><span class="p">);</span>
	<span class="n">SUITE_ADD_TEST</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">Test_teardown</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">suite</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>テストコードの作成は以下のように行う。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>./make-tests.sh test.c &gt; main.c
<span class="nv">$ </span>gcc main.c test.c CuTest.c
<span class="nv">$ </span>./a.exe or ./a.out
FFFFFFFFF

There were 9 failures:
1<span class="o">)</span> Test_Fail: test.c:6: 失敗する
2<span class="o">)</span> Test_Assert: test.c:12: <span class="nv">cond</span><span class="o">=</span>0でアサートする
3<span class="o">)</span> Test_AssertTrue: test.c:18: assert failed
4<span class="o">)</span> Test_AssertStr: test.c:24: expected &lt;Hello&gt; but was &lt;Helle&gt;
5<span class="o">)</span> Test_AssertStrMsg: test.c:32: Helloじゃないじゃん！Typoじゃね？: expected &lt;Hello&gt; but was &lt;Helle&gt;
6<span class="o">)</span> Test_AssertInt: test.c:37: expected &lt;5&gt; but was &lt;6&gt;
7<span class="o">)</span> Test_AssertDbl: test.c:42: expected &lt;1.010000&gt; but was &lt;1.020000&gt;
8<span class="o">)</span> Test_AssertDblMsg: test.c:47: <span class="nv">Delta</span><span class="o">=</span>0.001<span class="o">(</span>こんな感じに誤差を書いたほうがいいかも<span class="o">)</span>: expected &lt;1.010000&gt; but was &lt;1.020000&gt;
9<span class="o">)</span> Test_AssertPtr: test.c:53: expected pointer &lt;0x0x0&gt; but was &lt;0x0x80011e20&gt;

!!!FAILURES!!!
Runs: 9 Passes: 0 Fails: 9
</pre></div>
</div>
<p>今回はすべて失敗するコード。</p>
</div>
<div class="section" id="custom">
<h2>Custom</h2>
<p>ソースコードもテスト生成用のスクリプトも非常にシンプルで自分好みにカスタムするのは簡単そう。</p>
<p>例えば自分の場合こんなカスタマイズをするかもしれない。</p>
<ul class="simple">
<li>main文じゃなくてテスト関数をジェネレートする</li>
<li>doubleの配列についてテストをしたいのでCuAssertDblArrayマクロを作成する</li>
<li>setup/teardownを実装する</li>
<li>シェルスクリプト以外の言語でテストを生成してもいいかもしれない</li>
</ul>
</div>
<div class="section" id="license">
<h2>License</h2>
<p>ライセンスはzlib License</p>
<ul class="simple">
<li><a class="reference external" href="http://ja.wikipedia.org/wiki/Zlib_License">zlib License - Wikipedia</a></li>
<li><a class="reference external" href="http://opensource.org/licenses/zlib-license.html">The zlib/libpng License (Zlib) | Open Source Initiative</a></li>
</ul>
<p>このライセンスは以下の項目を守る必要がある</p>
<ul class="simple">
<li>原作者名を正しく表記する(義務はない)</li>
<li>改変版のソースコードは、オリジナルのソフトウェアと混同しないものとする</li>
<li>ライセンスファイルを削除してはならない</li>
</ul>
<p>現在sourceforge上にZIPファイルが置かれているが、自分でカスタマイズすることを考えるとGithub上に乗せて管理したい。</p>
<p><a class="reference external" href="http://sourceforge.net/projects/cutest/files/latest/download">Download CuTest: C Unit Testing Framework from SourceForge.net</a></p>
</div>
<div class="section" id="repos">
<h2>Repos</h2>
<p><a class="reference external" href="https://github.com/zigusoul/CuTest">zigusoul/CuTest</a></p>
<p>リポジトリを作成した。</p>
<p>自分以外にもGithub上で管理してカスタマイズしているみたい。</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/asheidan/CuTest">asheidan/CuTest · GitHub</a></li>
<li><a class="reference external" href="https://github.com/oasynnoum/mod_cutest">oasynnoum/mod_cutest · GitHub</a></li>
</ul>
</div>
</div>]]></description>
             <pubDate>Mon, 03 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/06/03/mysql_flask_sqlalchemy.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/06/03/mysql_flask_sqlalchemy.html</guid>
            <title><![CDATA[MySQL-SQLAlchemyなFlask]]></title>
            <description><![CDATA[<div class="section" id="mysql-sqlalchemyflask">
<h1>MySQL-SQLAlchemyなFlask</h1>
<p>環境 : CentOS 5.3</p>
<div class="section" id="mysql">
<h2>MySQLの準備</h2>
<p>yumで必要な物を揃える。</p>
<div class="highlight-bash"><div class="highlight"><pre>% sudo yum install mysql-devel
% sudo yum install mysql-server
</pre></div>
</div>
<p>初期設定</p>
<div class="highlight-bash"><div class="highlight"><pre>% mysql_secure_installation
</pre></div>
</div>
<p>色々聞かれるので答えたり、空エンターしたりする。詳しくは以下のリンク参照。</p>
<p><a class="reference external" href="http://centossrv.com/mysql.shtml">データベースサーバー構築(MySQL) - CentOSで自宅サーバー構築</a></p>
<p>MySQLサーバ起動</p>
<div class="highlight-bash"><div class="highlight"><pre>% sudo /etc/init.d/mysqld start
</pre></div>
</div>
</div>
<div class="section" id="python">
<h2>Pythonの準備</h2>
<p>MySQLdbがないと使えないのでpipする。</p>
<div class="highlight-bash"><div class="highlight"><pre>% pip install mysql-python
</pre></div>
</div>
<p>mysql-develが入ってないと失敗します。</p>
</div>
<div class="section" id="sqlalchemy">
<h2>SQLAlchemyな準備</h2>
<p>これで、create_engineするときにmysqlを指定できるようになった。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">'mysql+mysqldb://root:&lt;password&gt;@localhost/&lt;db_name&gt;'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>
</pre></div>
</div>
<p>自分の場合これをFlaskアプリ内で使ってみた。</p>
<p>SQLAlchemyでMySQLを使う場合、MySQLのAPIを使うことができるような。</p>
<p><a class="reference external" href="http://docs.sqlalchemy.org/en/rel_0_8/dialects/mysql.html">MySQL — SQLAlchemy 0.9 Documentation</a></p>
</div>
</div>]]></description>
             <pubDate>Mon, 03 Jun 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/30/my_first_ruby.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/30/my_first_ruby.html</guid>
            <title><![CDATA[はじめてのRuby]]></title>
            <description><![CDATA[<div class="section" id="ruby">
<h1>はじめてのRuby</h1>
<p>Rubyの勉強をするわけではない、Ruby環境を整える話。</p>
<p>こんな願望からRuby環境について考えてみることにした。</p>
<ul class="simple">
<li>1.9系がいい</li>
<li>古いRubyでgem使って痛い思いしたくない</li>
<li>もしかしたら1.8系も使いたいんじゃ…</li>
</ul>
<p>rubyワカンネ。</p>
<div class="section" id="rvm-rbenv">
<h2>rvm?rbenv?なにそれ</h2>
<div class="highlight-bash"><div class="highlight"><pre>:open google rvm rvenv
</pre></div>
</div>
<p>bとvを間違えてもGoogle先生は丁寧に間違えたことを教えてくれる。</p>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/sandmark/20121122/1353625485">今更だけどrvmからrbenvに乗り換えるときの個人用メモ - === SANDmark 19106 === beginning stress test</a></li>
<li><a class="reference external" href="http://spring-mt.tumblr.com/post/18486237491/rvm-rbenv">rvmやめてrbenvにしました - CubicLouve</a></li>
</ul>
<p>rvmがすごくディスられてるのがわかった。</p>
<p>違い -&gt; <a class="reference external" href="http://passingloop.tumblr.com/post/10512902196/difference-between-rbenv-and-rvm">passingloop • rbenv と RVM との違い</a></p>
<p>なんとなくわかったが、Bundlerってなんだ？</p>
<p>調べて分かったことを書いておく。</p>
<div class="section" id="rvm">
<h3>rvm</h3>
<p>= Ruby Version Manager</p>
<p>古い、重い、すごい。</p>
</div>
<div class="section" id="rbenv">
<h3>rbenv</h3>
<p>新しい、軽い、イケてる、必要最小限機能。</p>
</div>
<div class="section" id="gem">
<h3>gem</h3>
<p><a class="reference external" href="http://ja.wikipedia.org/wiki/RubyGems">RubyGems - Wikipedia</a></p>
<p>Rubyのパッケージ管理システム。</p>
<p>1.9からは標準のライブラリになった。</p>
<p>Centos5.3にも入ってた。1.8.5だけど。</p>
</div>
<div class="section" id="bundler">
<h3>Bundler</h3>
<p>gemのラッパー。以下の様な悩みを抱えている方に役に立つのだとか。</p>
<ul class="simple">
<li>本番環境に必要なアノgemが入っていない...だと...</li>
<li>gem入れまくってたら、どのgemがこのアプリに必要なのかわからなくなっちゃった。テヘ☆</li>
</ul>
<p>アプリ環境ごとにgem listがもてるようになるスグレモノらしい。</p>
<p>導入してみたいのであれば、以下のエントリを参考にするといいのかも。</p>
<p><a class="reference external" href="http://blog.mirakui.com/entry/20100703/1278165723">gem管理の新標準ツール”Bundler”のTips - 昼メシ物語</a></p>
<p>Rails3では標準搭載しているみたい。</p>
</div>
</div>
<div class="section" id="id1">
<h2>rbenv入れてみよう</h2>
<p>あんまりRubyわかんないので、軽いほうを使う。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>git clone https://github.com/sstephenson/rbenv ~/.rbenv
<span class="nv">$ </span>vim ~/.zshrc
<span class="c"># rbenv setting</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/.rbenv/bin:<span class="nv">$PATH</span>
<span class="nb">eval</span> <span class="s2">&quot;$(rbenv init - zsh)&quot;</span>
<span class="nv">$ </span>mkdir ~/.rbenv/plugins
<span class="nv">$ </span><span class="nb">cd</span> ~/.rbenv/plugins
<span class="nv">$ </span>git clone https://github.com/sstephenson/ruby-build
<span class="nv">$ </span><span class="nb">source</span> ~/.zshrc
</pre></div>
</div>
<p>MacだとHomeBrewから入れれるみたい。</p>
<ul class="simple">
<li>libyaml</li>
<li>openssl</li>
<li>autoconf, readline</li>
</ul>
<p>このへんのツールが必要なようだ。Macには今度入れてみよう。</p>
<p>上の例ではCentos5.3に入れているが最新のautomakeとかautoconfじゃないとあとあと困るのかもしれない。</p>
<p><a class="reference external" href="http://blog.tk84.net/PgqD">RVMをさくらVPS（CentOS-5.6）にインストール - CMS専門 Web開発者ブログ</a></p>
<p>どうでもいいがrvmを削除するときの</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gem explode
<span class="nv">$ </span>gem seppuku
</pre></div>
</div>
<p>とか面白い。</p>
</div>
<div class="section" id="id2">
<h2>rbenv使ってみよう</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>rbenv install 1.9.3-p429 --verbose
</pre></div>
</div>
<p>Rubyワカンネので、1.9.3系の一番新しいパッチを選択。</p>
<p>通常1.9.3を使いたいのでその設定をする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>rbenv global 1.9.3-p429
<span class="nv">$ </span><span class="nb">source</span> ~/.zshrc
<span class="nv">$ </span>ruby -v
ruby 1.9.3p429 <span class="o">(</span>2013-05-15 revision 40747<span class="o">)</span> <span class="o">[</span>x86_64-linux<span class="o">]</span>
<span class="nv">$ </span>gem -v
1.8.23
</pre></div>
</div>
<p>キタコレ。</p>
<p>proxylocalが欲しかったのでgemる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gem install proxylocal
<span class="nv">$ </span>gem list
</pre></div>
</div>
<p>proxylocalが入ってる。ok。</p>
</div>
<div class="section" id="python">
<h2>ちょっとPythonいじったことある人感想。</h2>
<p>あってるかわかんないけどRuby環境っぽいものができた。</p>
<p>自分視点だが、RubyとPythonの環境構築(2013年での)ではこんな感じに対応しているのかもしれない。</p>
<p>なんか違う気がするけど。</p>
<ul class="simple">
<li>gem - pip (easy_install)</li>
<li>rbenv/rvm - pythonbrew/pythonz</li>
<li>bundler - virtualenv (venv -&gt; python3)</li>
</ul>
<p>個人的にはvirtualenvが調子いい。仮想環境を作るという発想が良い感じ。</p>
</div>
</div>]]></description>
             <pubDate>Thu, 30 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/28/as_rst.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/28/as_rst.html</guid>
            <title><![CDATA[AsakusaSatellite on heroku]]></title>
            <description><![CDATA[<div class="section" id="asakusasatellite-on-heroku">
<h1>AsakusaSatellite on heroku</h1>
<p>最近会社でAsakusaSatelliteにお世話になっているので色々いじって見ようかなって思ったり。</p>
<div class="section" id="as">
<h2>自分用AS</h2>
<p>Rubyって何？自分でも爆速でherokuにASを立てる事ができた。スバラシイ！</p>
<p><a class="reference external" href="http://docs.asakusa-satellite.org/en/latest/heroku.html">Heroku へのデプロイ — AsakusaSatellite 0.8.1 documentation</a></p>
<p>動いてる。</p>
<p><a class="reference external" href="http://fierce-savannah-1084.herokuapp.com">AsakusaSatellite</a></p>
</div>
<div class="section" id="bot">
<h2>Botがほしい</h2>
<p><a class="reference external" href="http://docs.asakusa-satellite.org/en/latest/api.html">API — AsakusaSatellite 0.8.1 documentation</a></p>
<p>何やらDockWatcherといふのもがあるらしい。</p>
<p><a class="reference external" href="https://github.com/codefirst/duck-watcher">codefirst/duck-watcher · GitHub</a></p>
<p>ソースコードも短いのでいじれるかも。</p>
</div>
</div>]]></description>
             <pubDate>Tue, 28 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/28/pyqt4.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/28/pyqt4.html</guid>
            <title><![CDATA[PyQt4 install for Cygwin]]></title>
            <description><![CDATA[<div class="section" id="pyqt4-install-for-cygwin">
<h1>PyQt4 install for Cygwin</h1>
<p>きっとCygwinユーザーがCygwinでmakeするのはもう嫌と感じるのはもう運命だと思う。</p>
<p>というわけで、PyQt4は欲しくなったのでインストールする。</p>
<p>欲しくなった原因はMkdPreview.vim。</p>
<p>先に書いておくが、全部自前makeしないといけない。</p>
<div class="section" id="qt4">
<h2>1. Qt4入ってる？</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ls /usr/lib | grep qt
</pre></div>
</div>
<p>qt4があれば入ってる。自分は入ってた。フルインストールしたら多分入ってるっぽい。</p>
</div>
<div class="section" id="sip">
<h2>2. sip</h2>
<p>PyQt4を入れる前に、sipなるものを入れる必要がある。</p>
<p><a class="reference external" href="http://www.riverbankcomputing.co.uk/software/sip/intro">Riverbank | Software | SIP | What is SIP?</a></p>
<p>読んでみると、C/C++のライブラリ、ここではQtとPythonのバインディングをするツールであることがわかる。</p>
<p>tarファイルをダウンロード(<a class="reference external" href="http://www.riverbankcomputing.co.uk/software/sip/download">Riverbank | Software | SIP | SIP Download</a>)してmakeする。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tar -zxvf sip-4.14.6.tar.bz
<span class="nv">$ </span><span class="nb">cd </span>sip-4.14.6
<span class="nv">$ </span>python configure.py
<span class="nv">$ </span>make
<span class="nv">$ </span>make install
</pre></div>
</div>
<p>意外とすんなり。</p>
</div>
<div class="section" id="pyqt4">
<h2>3. PyQt4</h2>
<p>後は、PyQt4をダウンロードしてmakeするだけ。</p>
<p><a class="reference external" href="http://www.riverbankcomputing.co.uk/software/pyqt/download">Riverbank | Software | PyQt | PyQt4 Download</a></p>
<p>Linux, UNIX sourceを選択。</p>
<p>その前に、qmakeのパスが通っているか確認。通ってなければPATHに追加。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>qmake
<span class="nb">command </span>not found.
<span class="nv">$ </span>vim ~/.zshrc
<span class="nv">PATH</span><span class="o">=(</span>自分の設定<span class="o">)</span>:<span class="nv">$PATH</span>:/usr/lib/qt4/bin
<span class="nv">$ </span><span class="nb">source</span> ~/.zshrc
</pre></div>
</div>
<p>使ってるシェルは人によって違う。自分はzsh。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tar -zxvf PyQt-x11-gpl-4.10.1.tar.gz
<span class="nv">$ </span><span class="nb">cd </span>PyQt-x11-gpl-4.10.1
<span class="nv">$ </span>python configure.py -g
<span class="nv">$ </span>make
<span class="nv">$ </span>make install
</pre></div>
</div>
<p>ここでの注意点は２つあって</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line">python configure.py に-gオプションをつける。</div>
<div class="line">オプションなして実行すると-gか-kのどちらかつけろといわれるので、-gをつける。</div>
</div>
</li>
<li><p class="first">めっっっっっっっっっちゃ時間かかる。ちょっと焦るくらい終わらないので、時間のあるときにやる。</p>
</li>
</ol>
<p>というわけで１時間後。</p>
<div class="highlight-bash"><div class="highlight"><pre>recipe for target `_qt.dll' failed
</pre></div>
</div>
<p>ん？</p>
<div class="highlight-bash"><div class="highlight"><pre>recipe for target `_qt.dll' failed
</pre></div>
</div>
<p>ん？</p>
<p>見たくない現実が。１時間返せ。返してくれCygwin。</p>
<p>-g / -kオプションを適当に選択してしまったのが悪いっぽい。と言うかなんだこのオプション。</p>
<p>-g / -k -&gt; なんかGNOMEかKDEっぽいな。(調べてないので本当にどうかは知りません)</p>
<p>CygwinのQtってGNOME？KDE？setup.exeを見てみよう。</p>
<img alt="../../../_images/cygkde.png" src="http://yymm.bitbucket.org/blog/html/_images/cygkde.png"/>
<p>QtはKDEの中にしかありません。</p>
<p>オプションを-kにして再度チャレンジ。</p>
<p>小一時間後うまいことmakeできたのでmake install。</p>
</div>
<div class="section" id="import-pyqt4">
<h2>4. import PyQt4</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python
&gt;&gt;&gt; import PyQt4
&gt;&gt;&gt;
</pre></div>
</div>
<p>キマシタワー。</p>
</div>
<div class="section" id="cygwin">
<h2>5. Cygwin以外 &amp; 雑記</h2>
<p>Ubuntuではapt-getでインストール出来るみたい。</p>
<p><a class="reference external" href="http://squalo22-diary.blogspot.jp/2011/09/pyqt4ubuntu.html">Wind And Tide: PyQt4をubuntuにインストールする</a></p>
<p>pip search pyqtしたところPyPiにあるみたいだった。。。</p>
<p>まさかとは思うが、自前makeしなくても良かったの。。。ってなった。今度試してみよう。</p>
<p>PySideをpipでインストールしようとしたらhogehogeという記事があったので何かしら参考になるかもしれない。</p>
<p><a class="reference external" href="http://kk6.hateblo.jp/entry/20110815/1313405197">Pythonbrew環境下にPySideをインストールしようとしたらはまった - kk6のメモ帳*</a></p>
<p>個人的に使うならPySide使ってみたかったから今度やってみよう。</p>
</div>
</div>]]></description>
             <pubDate>Tue, 28 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/27/maclean1.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/27/maclean1.html</guid>
            <title><![CDATA[Maclean1 - Mac clean install]]></title>
            <description><![CDATA[<div class="section" id="maclean1-mac-clean-install">
<h1>Maclean1 - Mac clean install</h1>
<p>２年前に購入した。Mac Book Pro Early 2011 - Mac OS X 10.6。</p>
<p>当時筋金入りの情弱(使ったことのあるOS:Windows Vista)の自分が購入して素の状態でそのまま使っていたが、最近なんか調子悪いのでクリーンインストールしてみた。</p>
<p>Macを手にしてから１年目くらいに、クリーンインストールしたい衝動にかられていたのでちょうど良かった。</p>
<ul class="simple">
<li>Pythonista志望、Vimmer見習いなので偏った設定になります。</li>
<li>Mountain Lionにはしません。Snow Leopardです。</li>
</ul>
<div class="section" id="os-install">
<h2>OS Install</h2>
<p>付属のインストールDVD(Mac OS X Install DVD)よりインストールする。</p>
<p>今回は以前まで使っていたパーティションをすべてぶちこわして再構成する感じでいく。</p>
<ol class="arabic simple">
<li>DVD入れる</li>
<li>“c”または”option”を押しながら起動するとDVDからブートされる</li>
<li>インストールウィザードが出てくるがスルーして、上部のステータスバーにあるディスクユーティリティーを起動</li>
<li>使用するディスクを選択して、パーティションタブを選択</li>
<li>オプションで「GUID」を選択</li>
<li>ボリュームの方式で「1パーティション」を選択</li>
<li>フォーマットは「Mac OS 拡張(ジャーナリング)」を選択</li>
<li>「適用」で今までのパーティションとお別れ</li>
<li>インストールウィザードに戻り、インストール(質問は簡単なので省略)</li>
<li>無事に起動</li>
</ol>
<div class="section" id="os-update">
<h3>OS Update</h3>
<p>DVDからインストールしたOSのバージョンは10.6.6と古いのでアップデートする。</p>
<p>右上のりんごから「ソフトウェアアップデート」</p>
<p>再起動をしてバージョンを確認すると、10.6.8になっている。</p>
</div>
<div class="section" id="application-install-dvd">
<h3>Application Install DVD</h3>
<p>っていう名前の付属DVDを入れて、インストール。</p>
<p>iLifeアプリケーションが入りいます(iPhotoとかiMovieとか、Garagebandも入ってる)</p>
</div>
<div class="section" id="mac-setting">
<h3>Mac Setting</h3>
<p>何となく自分のこだわり。</p>
<ol class="arabic simple">
<li>トラックパッドの「タップでクリック」にチェック。</li>
<li>壁紙はこちら(<a class="reference external" href="http://tokuna.blog40.fc2.com/blog-entry-2068.html">http://tokuna.blog40.fc2.com/blog-entry-2068.html</a>)</li>
<li>Dockを画面の左 + サイズを最小</li>
<li>「ExposeとSpaces」のSpaces。Spacesを有効にして、操作スペースの切り替えをCommand+矢印キーにする。個人的に1行4列。</li>
</ol>
</div>
</div>
<div class="section" id="neeeeed-app">
<h2>Neeeeed App</h2>
<p>これを入れないと始まらないものたち。</p>
<div class="section" id="firefox">
<h3>Firefox</h3>
<p>safariをゴミ箱に入れる前に、Firefoxと検索する。</p>
<p>むしろ、Safariを起動するのはFirefoxを検索するためだけにあるんじゃないか？</p>
<p>一緒にAdobe Flash Playerも入れるといい。</p>
<p>あと、safariは捨てません。すみませんでした。</p>
</div>
<div class="section" id="alfred">
<h3>Alfred</h3>
<p>QuickSilverじゃないランチャー。ないと作業効率が著しく低下するので早い段階でインストール。</p>
</div>
<div class="section" id="iterm2">
<h3>iTerm2</h3>
<p>TerminalよりiTerm2。</p>
</div>
<div class="section" id="mozc">
<h3>Mozc</h3>
<p>Google日本語入力(<a class="reference external" href="http://www.google.co.jp/ime">http://www.google.co.jp/ime/</a>)</p>
<p>インストーラーからインストール。</p>
<p>システム環境設定の「言語とテキスト」でGoogle日本語入力にチェックが入っていることを確認、ことえりをOFFにする。</p>
</div>
<div class="section" id="xcode">
<h3>Xcode</h3>
<p>Macにはデフォルトでgcc入ってない。めっちゃ不便。</p>
<p>DeveloperサイトからXcodeを入手できる(<a class="reference external" href="https://developer.apple.com/downloads/index">https://developer.apple.com/downloads/index</a>.action#)</p>
<p>Snow Leopardでは多分「Xcode 3.2.6 and iOS SDK 4.3 for Snow Leopard」を選択すればいい。</p>
<p>4Gくらいあるのでダウンロードに時間がかかる。</p>
</div>
</div>
</div>]]></description>
             <pubDate>Mon, 27 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/13/rake.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/13/rake.html</guid>
            <title><![CDATA[rake]]></title>
            <description><![CDATA[<div class="section" id="rake">
<h1>rake</h1>
<p><a class="reference external" href="http://www.oreilly.co.jp/books/9784873116143">O’Reilly Japan - テスト駆動開発による組み込みプログラミング</a> で紹介されているテストフレームワークUnityはrakeでビルドできるということなので使ってみよう。</p>
<div class="section" id="install-for-cygwin">
<h2>Install for Cygwin</h2>
<p>Windowsで作業するときはもっぱらCygwinなのでめんどくさいがCygwinに入れてみる。</p>
<p>デフォルトのCygwinにはgemが入っていないので</p>
<ol class="arabic simple">
<li>wget gem &amp; tar</li>
<li>gemのインストール</li>
<li>gemでrakeインストール</li>
</ol>
<p>の流れでインストールする。</p>
<div class="highlight-bash"><div class="highlight"><pre>$ wget http://rubyforge.org/frs/download.php/76729/rubygems-1.8.25.tgz
$ cd rubygems-1.8.25
$ ruby --version
ruby 1.9.3p327 (2012-11-10 revision 37606) [i386-cygwin]
$ ruby setup.rb

RubyGems 1.8.25 installed
unable to convert U+0160 from UTF-8 to Windows-31J for History.txt, skipping
unable to convert U+0160 from UTF-8 to Windows-31J for History.txt, skipping

== 1.8.25/ 2013-01-24

* 6 bug fixes:

  * Added 11627 to setup bin_file location to protect against errors. Fixes #328 by ConradIrwin
  * Specification#ruby_code didn't handle Requirement with multiple
  * Fix error on creating a Version object with a frozen string.
  * Fix incremental index updates
  * Fix missing load_yaml in YAML-related requirement.rb code.
  * Manually backport encoding-aware YAML gemspec


------------------------------------------------------------------------------

RubyGems installed the following executables:
        /usr/bin/gem

$ gem --version
1.8.25
$ gem install rake

Fetching: rake-10.0.4.gem (100%)
Successfully installed rake-10.0.4
1 gem installed
Installing ri documentation for rake-10.0.4...
Installing RDoc documentation for rake-10.0.4...

$ rake --version
rake, version 10.0.4
</pre></div>
</div>
<p>ok!</p>
</div>
</div>]]></description>
             <pubDate>Mon, 13 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/05/08/centos_continue.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/05/08/centos_continue.html</guid>
            <title><![CDATA[centos 5.3 使えるようにする]]></title>
            <description><![CDATA[<div class="section" id="centos-5-3">
<h1>centos 5.3 使えるようにする</h1>
<p>Vim, Zsh, Screen, Pythonの設定。</p>
<div class="section" id="vim">
<h2>Vim</h2>
<p>.vimrcはGist -&gt;</p>
<p>使ってるプラグイン達</p>
<div class="highlight-vim"><div class="highlight"><pre>NeoBundle <span class="s1">'/Shougo/neocomplcache.git'</span>
NeoBundle <span class="s1">'/Shougo/neosnippet.git'</span>
NeoBundle <span class="s1">'/Shougo/vimshell.git'</span>
NeoBundle <span class="s1">'/Shougo/vimproc.git'</span>
NeoBundle <span class="s1">'/Shougo/vimfiler.git'</span>
NeoBundle <span class="s1">'/Shougo/unite.vim.git'</span>
NeoBundle <span class="s1">'/thinca/vim-quickrun.git'</span>
NeoBundle <span class="s1">'/mattn/multi-vim.git'</span>
NeoBundle <span class="s1">'/mattn/zencoding-vim.git'</span>
NeoBundle <span class="s1">'/scrooloose/nerdcommenter.git'</span>
NeoBundle <span class="s1">'/scrooloose/nerdtree.git'</span>
NeoBundle <span class="s1">'/scrooloose/syntastic.git'</span>
NeoBundle <span class="s1">'/vim-scripts/YankRing.vim.git'</span>
NeoBundle <span class="s1">'/rstacruz/sparkup.git'</span>
NeoBundle <span class="s1">'/Lokaltog/vim-easymotion.git'</span>
</pre></div>
</div>
<p>今後の増殖に期待。</p>
<p>今回導入したプラグインについてコメント。</p>
<div class="section" id="sparkup">
<h3>Sparkup</h3>
<p><a class="reference external" href="https://github.com/rstacruz/sparkup">rstacruz/sparkup · GitHub</a></p>
<p>zencodingバリにhtmlをさくっと書けるプラグイン。</p>
<p>使い方はREADME &amp; ここ参照 -&gt; <a class="reference external" href="http://www.serendip.ws/archives/4353">Vim の Sparkup プラグインで HTML タグを Zen Coding 風に簡単入力 : Serendip - Webデザイン・プログラミング</a></p>
</div>
<div class="section" id="syntastic">
<h3>Syntastic</h3>
<p><a class="reference external" href="https://github.com/scrooloose/syntastic">scrooloose/syntastic · GitHub</a></p>
<p>導入すると:w時になんとSyntastic!</p>
</div>
<div class="section" id="easy-motion">
<h3>Easy-Motion</h3>
<p><a class="reference external" href="https://github.com/Lokaltog/vim-easymotion">Lokaltog/vim-easymotion · GitHub</a></p>
<p>いきたいところ簡単にいけるeasy-motion!</p>
<p>vimrcと使い方は以下の記事で勉強。</p>
<p><a class="reference external" href="http://blog.remora.cx/2012/08/vim-easymotion.html">【Vim】目的の行に素早く移動する（相対行番号と easymotion プラグイン） | blog.remora.cx</a></p>
</div>
<div class="section" id="neosnippet">
<h3>NeoSnippet</h3>
<p>ちょっと前にneocomをupdateした後に突然補間にめっちゃ時間が掛かる現象に遭遇して以来、分離前のネオコンを使っていたのだが今回使ってみる。</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/Shougo/neocomplcache">Shougo/neocomplcache · GitHub</a></li>
<li><a class="reference external" href="https://github.com/Shougo/neosnippet">Shougo/neosnippet · GitHub</a></li>
</ul>
<p>vimrcはそのまま使わせてもらってます。良い感じに動いているようだ。</p>
</div>
<div class="section" id="id1">
<h3>修正, その他</h3>
<div class="section" id="popup-color">
<h4>1. popup color</h4>
<p><a class="reference external" href="http://vim-users.jp/2009/05/hack9">Vim-users.jp - Hack #9: Insert mode補完　設定編</a></p>
<p>ネオコンのポップアップが何も見えなかったのでポップアップの色を変更。変える方法を初めて知る。</p>
<div class="highlight-vim"><div class="highlight"><pre><span class="k">hi</span> Pmenu ctermbg<span class="p">=</span><span class="m">8</span>
<span class="k">hi</span> PmenuSel ctermbg<span class="p">=</span><span class="m">4</span>
<span class="k">hi</span> PmenuSbar ctermbg<span class="p">=</span><span class="m">0</span>
</pre></div>
</div>
<p><a class="reference external" href="http://h2plus.biz/hiromitsu/entry/674">VimLで色指定する数値の一覧 | Inhale n’ Exhale</a></p>
</div>
<div class="section" id="nerdtree">
<h4>2. nerdtree</h4>
<p><a class="reference external" href="http://stackoverflow.com/questions/9927217/vim-nerdtree-suddenly-broke">vim - nerdtree suddenly broke - Stack Overflow</a></p>
<p>?~V?みたいなのが表示されたときはvimrcに以下を設定。</p>
<div class="highlight-vim"><div class="highlight"><pre><span class="k">let</span> <span class="k">g</span>:NERDTreeDirArrows<span class="p">=</span><span class="m">0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ctrl-v">
<h3>3. ctrl+v</h3>
<p>ctrl + vで矩形選択モードになる。チョー使えそう！</p>
<p>何で知らなかったのorz</p>
</div>
<div class="section" id="multiple-cursors">
<h3>4. multiple-cursors</h3>
<p><a class="reference external" href="https://github.com/terryma/vim-multiple-cursors">terryma/vim-multiple-cursors · GitHub</a></p>
<p>これ使ってみたい。</p>
</div>
</div>
<div class="section" id="zsh">
<h2>Zsh</h2>
<p><a class="reference external" href="http://ama-ch.hatenablog.com/entry/20090109/1231526834">zsh入門してみたら便利すぎて鼻息が抑えられない - はてブロ@ama-ch</a></p>
<p>Zshrcの設定ファイルは良い感じのをコピーして勝手に使っていただけなのでまじめに考えてみる。</p>
<p>その結果こうなった。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">export </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;ja_JP.UTF-8&quot;</span>
<span class="c"># The following lines were added by compinstall</span>
zstyle <span class="s1">':completion:*'</span> completer _expand _complete _ignored _correct _approximate
zstyle <span class="s1">':completion:*'</span> list-colors <span class="s1">''</span>
zstyle <span class="s1">':completion:*'</span> list-prompt %SAt %p: Hit TAB <span class="k">for </span>more, or the character to insert%s
zstyle <span class="s1">':completion:*'</span> menu <span class="k">select</span><span class="o">=</span>2
zstyle <span class="s1">':completion:*'</span> <span class="k">select</span>-prompt %SScrolling active: current selection at %p%s
zstyle <span class="s1">':completion:*'</span> verbose <span class="nb">true</span>
autoload -Uz compinit
compinit
<span class="c"># End of lines added by compinstall</span>
<span class="c"># Lines configured by zsh-newuser-install</span>
<span class="nv">HISTFILE</span><span class="o">=</span>~/.zsh_history
<span class="nv">HISTSIZE</span><span class="o">=</span>5000
<span class="nv">SAVEHIST</span><span class="o">=</span>5000
setopt appendhistory extendedglob notify
setopt hist_ignore_dups     <span class="c"># ignore duplication command history list</span>
setopt share_history        <span class="c"># share command history data</span>
<span class="c"># history search Ctrl+s or Ctrl+S</span>
autoload <span class="nb">history</span>-search-end
zle -N <span class="nb">history</span>-beginning-search-backward-end <span class="nb">history</span>-search-end
zle -N <span class="nb">history</span>-beginning-search-forward-end <span class="nb">history</span>-search-end
bindkey <span class="s2">&quot;^P&quot;</span> <span class="nb">history</span>-beginning-search-backward-end
bindkey <span class="s2">&quot;^N&quot;</span> <span class="nb">history</span>-beginning-search-forward-end
<span class="c"># End of lines configured by zsh-newuser-install</span>
autoload colors
colors
<span class="c">#Prompt</span>
<span class="nb">export </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s2">&quot;[%F{magenta}%B%n%b%f%F{cyan}@%M%f]{%~}%# &quot;</span>
<span class="nb">export </span><span class="nv">RPROMPT</span><span class="o">=</span><span class="s2">&quot;[%F{yellow}%*%f]&quot;</span>
<span class="nb">alias </span><span class="nv">ls</span><span class="o">=</span><span class="s1">'ls -G'</span>
<span class="c"># PATH</span>
<span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/sbin:/bin:<span class="nv">$PATH</span>
<span class="c"># no beep</span>
setopt nolistbeep
<span class="c"># useful functions</span>
setopt auto_cd
setopt auto_pushd
setopt correct
setopt list_packed
<span class="c"># virtualenv setting</span>
<span class="nv">VIRTUALENVWRAPPER_PYTHON</span><span class="o">=</span>/usr/bin/python26
<span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span><span class="nv">$HOME</span>/.pythonenvs
<span class="nb">source</span> /usr/bin/virtualenvwrapper.sh
</pre></div>
</div>
<p>注意したいのは先頭に追加したLANG変数の設定。</p>
<p>/etc/sysconfig/i18nに設定されているのにzshで読み込まれていなかったようだ。</p>
<p>このせいで文字化けに時間を取られてしまったのが残念。。。</p>
<p>nerdtreeの表示がおかしくなるのもこれが原因。</p>
</div>
<div class="section" id="python">
<h2>Python</h2>
<p><a class="reference external" href="http://yymm6.hatenablog.com/entry/2013/01/05/182750">Python Version Manage - memomemo</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pip install virtualenv virtualenvwrapper
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/utahta/pythonbrew">utahta/pythonbrew · GitHub</a></p>
<p>pythonbrewも入れよう。</p>
<p>python3のvenvを使ってみようかと思ったりもするが、virtualenvがまだ便利なのでそのまま。</p>
</div>
<div class="section" id="other">
<h2>Other</h2>
<p><a class="reference external" href="http://d.hatena.ne.jp/Loups-garous/20120917/1347900472">CentOS6でポート開放をする - 見果てぬ夢</a></p>
<p>特定のポートを開放したいときは/etc/sysconfig/iptablesを編集する。</p>
<div class="highlight-bash"><div class="highlight"><pre>-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT
</pre></div>
</div>
<p>80番ポートを開いている例。</p>
</div>
</div>]]></description>
             <pubDate>Wed, 08 May 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/04/30/centos_setup.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/04/30/centos_setup.html</guid>
            <title><![CDATA[centosはじめました]]></title>
            <description><![CDATA[<div class="section" id="centos">
<h1>centosはじめました</h1>
<p>CentOS 5.3を使うことになったので自分好みのCentOSになるように設定してみた。</p>
<p>sakuraもデフォルトCentOSなのでそのまま同じ設定でいけるかも。</p>
<div class="section" id="install">
<h2>Install</h2>
<p>下記の記事を参考にインストール。</p>
<p>※ net-install版ではない。</p>
<ul class="simple">
<li><a class="reference external" href="http://itpro.nikkeibp.co.jp/article/COLUMN/20090403/327762/?ST=oss&amp;P=1">インストール完全ガイド - CentOS 5.3：ITpro</a></li>
<li><a class="reference external" href="http://policy.jugem.cc/?eid=285">CentOS 5.3 のインストール (グラフィカル モード) | POLICY.JUGEM.CC</a></li>
</ul>
<p>設定した項目は以下。</p>
<ol class="arabic simple">
<li>ネットワーク : DHCP IPv4 IPv6 (デフォルト変更なし)</li>
<li>用途 : Server - GUI (Server用パッケージとGNOME)</li>
<li>ファイアウォール : 有効、sshを許可</li>
</ol>
<p># ネットワーク</p>
<p>起動した段階でLANケーブルに繋がっていなかったりすると、eth0が停止状態になっているので下記の方法で起動する。</p>
<ul class="simple">
<li>システム -&gt; 管理 -&gt; ネットワーク</li>
<li>ネットワーク管理画面でeth0が停止中になっている</li>
<li>起動ボタンをクリック</li>
<li>再起動を要求される場合があるので、必要に応じて再起動する</li>
</ul>
</div>
<div class="section" id="packages-setting">
<h2>Packages Setting</h2>
<p>何はともあれ下記のコマンドを始めに実行する。CentOS始めました感が出てくる。</p>
<div class="highlight-python"><div class="highlight"><pre>$ yum update
</pre></div>
</div>
<p>yumとrpmがあるが基本的にはyumを使用する。</p>
<p># すぐさま入れたいものリスト</p>
<ul class="simple">
<li>vim7.3</li>
<li>hg(mercurial)</li>
<li>git</li>
<li>screen</li>
<li>zsh</li>
<li>python</li>
<li>gcc</li>
<li>g++</li>
<li>make</li>
<li>automake</li>
</ul>
<div class="section" id="gcc">
<h3>1. gcc</h3>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># yum install gcc</span>
<span class="o">...</span>
<span class="c"># rpm -qa | grep gcc</span>
</pre></div>
</div>
</div>
<div class="section" id="g">
<h3>2. g++</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/plasticscafe/20080930/1222778825">CentOSへのg++の追加方法 - Reinvention of the Wheel</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># yum install gcc-c++</span>
</pre></div>
</div>
</div>
<div class="section" id="screen">
<h3>3. screen</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/kuchida123/20110710/p2">screen入れてみる - CentOS＠さくらVPSで構築するサーバ管理・運用メモ</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># yum install screen</span>
</pre></div>
</div>
</div>
<div class="section" id="mercurial">
<h3>3. mercurial</h3>
<p><a class="reference external" href="http://blog.santalinux.net/?p=341">Logwatch for santa » CentOS 5.4 に mercurial をインストール</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># yum install python-devel</span>
<span class="c"># yum install python-setuptools</span>
<span class="c"># easy_install mercurial</span>
<span class="c"># hg --version</span>
<span class="o">...</span> <span class="mf">2.6</span><span class="o">-</span><span class="n">rc</span> <span class="o">...</span>
</pre></div>
</div>
<p>versionが2.6.rc。最新は2.5.4とかじゃなかったっけ？</p>
<p><a class="reference external" href="http://troter.hatenablog.jp/entry/20130421/1366543906">Mercurial-2.6-rcの並列になったupdateを試す - 放牧日記</a></p>
<p>まさかの最新版である。rc版について知らなかったので↓</p>
<p><a class="reference external" href="http://www.sophia-it.com/content/RC%E7%89%88">RC版とは (Release Candidate version) アールシーばん： - IT用語辞典バイナリ</a></p>
</div>
<div class="section" id="zsh">
<h3>4. zsh</h3>
<div class="highlight-python"><div class="highlight"><pre># yum install zsh
# zsh --version
zsh 4.2.6
</pre></div>
</div>
<p>必要に応じてバージョンアップする。</p>
<ul class="simple">
<li><a class="reference external" href="http://please-sleep.cou929.nu/build-zsh-on-centos5.html">CentOS 5.6 で zsh をバージョンアップ - Please Sleep</a></li>
<li><a class="reference external" href="http://d.hatena.ne.jp/amari3/20110817/1313595431">さくらのVPSの CentOS5.6 に最新版の zsh を入れてみた - amari3のはてなダイアリー</a></li>
</ul>
</div>
<div class="section" id="zlib">
<h3>5. zlib</h3>
<p>自前でmakeするときなどなどで時々なくて失敗ということがあるので先に入れる。</p>
<div class="highlight-python"><div class="highlight"><pre># rpm -qa | grep zlib
なかったら
# yum install zlib
# rpm -qa | grep zlib-devel
なかったら
# yum install zlib-devel
</pre></div>
</div>
</div>
<div class="section" id="make">
<h3>6. make</h3>
<div class="highlight-python"><div class="highlight"><pre># rpm -qa | grep make
なかったら
# yum install make
</pre></div>
</div>
</div>
<div class="section" id="python">
<h3>6. python</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/cu39/20120110/1326209060">CentOS 5.7 に Python 2.6 を入れて pip で MoinMoin をインストール - キュウリのように落ち着いて</a></p>
<div class="highlight-python"><div class="highlight"><pre># python
Python 2.4.3...
...
&gt;&gt;&gt;
</pre></div>
</div>
<p>古すぐる。</p>
<div class="highlight-python"><div class="highlight"><pre># easy_install pip
TrackBackの文字が。。。
# pip
失敗＼(^o^)／ｵﾜﾀ
</pre></div>
</div>
<p>由々しき事態である。これはなんとしても回避する。(pipが使えない環境では呼吸ができないのと同然、生きていけない。。。)</p>
<p>そう、そして外部リポジトリに手を出すのである。EPELはfedoraのリポジトリ。</p>
<ul class="simple">
<li><a class="reference external" href="http://www.tooyama.org/yum-addrepo-epel.html">CentOS 外部レポジトリの追加(EPEL)</a></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre># wget http://ftp-srv2.kddilabs.jp/Linux/distributions/fedora/epel/5/x86_64/epel-release-5-4.noarch.rpm
# rpm -ivh epel-release-5-4.noarch.rpm
# yum --enablerepos=epel search python26
# yum --enablerepos=epel install python26
# python26
Python 2.6.8...
...
&gt;&gt;&gt;
</pre></div>
</div>
<p>次は2.6のeasy_installを使えるようにする。</p>
<div class="highlight-python"><div class="highlight"><pre># yum --enablerepos=epel install python26-distribute
# which easy_install-2.6
/usr/bin/easy_install-2.6
# easy_install-2.6 pip
# pip-2.6 --version
pip 1.3.1 .......
# pip --version
pip 1.3.1 .......(同じバージョンなのでpipのみでも2.6のpipコマンドが実行可能)
</pre></div>
</div>
<p>ok!</p>
</div>
<div class="section" id="git">
<h3>7. git</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/mrgoofy33/20110206/1296952248">CentOS5.5にgitをインストールする(yumを使用) - hogehoge foobar Blog Style5</a></p>
<p># yum install gitができない。easy_install mercurialでインストールできるhgは素晴らしい。</p>
<p>上記記事にはyum.repos.dにgit.reposを追加してhogehogeと書いてあるが、先ほどpythonでepelリポジトリを追加してしまったのでそこにgitがある。</p>
<div class="highlight-python"><div class="highlight"><pre># yum list | grep git
gitがあるのを確認
# yum install git
</pre></div>
</div>
<p>今はデフォルトで–enablerepo=epelになっているが、この状態はあまり良くないかもしれないのでデフォルトでは見つからないように設定する。</p>
</div>
<div class="section" id="automake">
<h3>8. automake</h3>
<p><a class="reference external" href="http://blog.tk84.net/PgqD">RVMをさくらVPS（CentOS-5.6）にインストール - CMS専門 Web開発者ブログ</a></p>
<p>yumで入れられるautomakeはバージョンが古いらしくruby環境を構築する際にえらい面倒なことになるようなので自前makeした方がいい。</p>
</div>
<div class="section" id="vim7-3">
<h3>9. vim7.3</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/hosikiti/20100910/1284079341">CentOS 5.5 にVim7.3をソースからインストール - ITコンサルタント成長録</a></p>
<p>2013/04現在の最新版は7.3.3。以下のコマンドを実行していけばインストール完了。</p>
<div class="highlight-python"><div class="highlight"><pre># yum install ncurses-devel -y
# wget http://ftp.vim.org/pub/vim/unix/vim-7.3.tar.bz2
# tar jxfv vim-7.3.tar.bz2
# mkdir vim73/patches
# cd vim73/patches
# seq -f http://ftp.vim.org/pub/vim/patches/7.3/7.3.%03g 3 | xargs wget
# cd ..
# cat patches/7.3.* | patch -p0
# ./configure --prefix=/usr --enable-multibyte --with-features=huge --disable-selinux
# make
# make install
# vim
vim 7.3.3
</pre></div>
</div>
<p>ok!</p>
</div>
</div>
<div class="section" id="security">
<h2>Security</h2>
<div class="section" id="wheel">
<h3>wheelユーザー</h3>
<p>CentOSではwheelユーザーはデフォルトでonになっていないので下記の設定を行う。</p>
<p>/etc/login.defsの末尾に以下の行を追加</p>
<div class="highlight-python"><div class="highlight"><pre># Login is whell only
#
SU_WHEEL_ONLY yes
</pre></div>
</div>
<p>/etc/pam.d/suを編集</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Uncomment the following line to require a user to be in the &quot;wheel&quot; group.</span>
<span class="c">#auth       required     /lib/security/$ISA/pam_wheel.so use_uid</span>
</pre></div>
</div>
<p>2行目のauth...のコメントアウトを外す。</p>
<p>/etc/groupでsuが使えるユーザーを設定。</p>
<div class="highlight-python"><div class="highlight"><pre># vim /etc/group
下記の行に
old : wheel:x:10:root
ユーザーhogeを追加
new : wheel:x:10:root,hoge
</pre></div>
</div>
</div>
<div class="section" id="root">
<h3>rootへのログイン</h3>
<p><a class="reference external" href="http://wdsdx.com/book/export/html/71">CentOS 設定編</a></p>
<p>CentOSに限らずかもしれないが、/etc/ssh/sshd_configで</p>
<div class="highlight-python"><div class="highlight"><pre>PermitRootLogin yes
</pre></div>
</div>
<p>となっているのはセキュリティ上問題がある。(Linuxに**必ず**存在するrootユーザーは格好の的になってしまう)</p>
<p>なので、rootはパスワード認証でログイン出来ないようにする。公開鍵認証はログイン可。</p>
<p>rootへの公開鍵認証を行いたいホスト(localhost)で鍵生成、鍵コピー。</p>
<div class="highlight-python"><div class="highlight"><pre>(localhost)$ ssh-keygen
(localhost)$ ssh-copy-id root@XXX.XXX.XXX.XXX
パスワードを要求される(まだパスワード認証は出来る状態)
(localhost)$ ssh root@XXX.XXX.XXX.XXX
[root@xxxxx ~]#
ssh公開鍵認証でrootにログイン出来るのを確認
</pre></div>
</div>
<p>rootでログインして/etc/ssh/sshd_configを書き換える。</p>
<div class="highlight-python"><div class="highlight"><pre># PermitRootLoginを以下に書き換える
PermitRootLogin without-password
</pre></div>
</div>
<p>もはやsshではログインできなくするという少しワイルドな方法もある。</p>
<p><a class="reference external" href="http://kazmax.zpp.jp/linux/lin_ssh.html">sshのrootログインを禁止する</a></p>
<p>設定は簡単で、/etc/ssh/sshd_configのPermitRootLoginをnoにする</p>
<div class="highlight-python"><div class="highlight"><pre>PermitRootLogin no
</pre></div>
</div>
</div>
</div>
<div class="section" id="tips">
<h2>Tips</h2>
<div class="section" id="id2">
<h3>覚えておきたいシステムコマンド</h3>
<p><a class="reference external" href="http://linux.kororo.jp/cont/intro/abso_com_sys.php">覚えておきたい必須コマンド[ システム編 ]</a></p>
<ul class="simple">
<li>uname -a</li>
<li>df -h</li>
<li>who (“w” でも可)</li>
<li>last</li>
<li>free -tm</li>
<li>ps aux | grep sshd</li>
<li>pstree</li>
<li>lsof -i:ssh (-i:hoge hogeはポート番号又はプロセス名)</li>
</ul>
</div>
<div class="section" id="usr-usr-local">
<h3>/usrと/usr/local</h3>
<p><a class="reference external" href="http://mylinux.g.hatena.ne.jp/teraco/20081114/1226637835">/usr/binと/usr/local/binの違いについて - 今日も元気にlinux - mylinuxグループ</a></p>
</div>
<div class="section" id="centos-version">
<h3>CentOS –version</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/yokococon/20070206">CentOSのバージョン確認 - yokococonの日記</a></p>
</div>
<div class="section" id="rpmyum">
<h3>rpmとyumの違い</h3>
<p><a class="reference external" href="http://d.hatena.ne.jp/inouetakuya/20111006/1317900802">初心者の頃に知っておきたかった rpm と yum の違いと使い分け - 彼女からは、おいちゃんと呼ばれています</a></p>
</div>
<div class="section" id="yum">
<h3>yumのオプション</h3>
<p><a class="reference external" href="http://kajuhome.com/gossip_thread/200.shtml">yum -y の -y は必要ですか?</a></p>
<p>-yオプションは(y/N)を聞かないですぐにインストールしちゃうようになるオプション。</p>
<p>困ったときはman先輩に聞こう。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># man yum</span>
</pre></div>
</div>
</div>
<div class="section" id="scp">
<h3>scp</h3>
<p><a class="reference external" href="http://cns-guide.sfc.keio.ac.jp/2004/2/6/2.html">6.2 scpコマンドを使ったファイルの転送</a></p>
<p>ftpよりscp。</p>
</div>
</div>
</div>]]></description>
             <pubDate>Tue, 30 Apr 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html</guid>
            <title><![CDATA[C言語 - Testing Frameworks]]></title>
            <description><![CDATA[<div class="section" id="c-testing-frameworks">
<h1><a class="toc-backref" href="#id29">C言語 - Testing Frameworks</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#c-testing-frameworks" id="id29">C言語 - Testing Frameworks</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#servey" id="id30">Servey</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cunit" id="id31">CUnit</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cut-2-6" id="id32">CUT 2.6</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cutest" id="id33">CuTest</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cutter" id="id34">Cutter</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#mintest" id="id35">MinTest</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cmockery" id="id36">CMockery</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cspec" id="id37">CSpec</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#unity" id="id38">Unity</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/25/c_testframeworks.html#cpputest" id="id39">CppUTest</a></li>
</ul>
</li>
</ul>
</div>
<p>C言語で開発していく際にTDDまたはBDDを意識した開発を行っていこうと思う。</p>
<p>TDD : <a class="reference external" href="http://ja.wikipedia.org/wiki/%E3%83%86%E3%82%B9%E3%83%88%E9%A7%86%E5%8B%95%E9%96%8B%E7%99%BA">テスト駆動開発 - Wikipedia</a></p>
<p>BDD : <a class="reference external" href="http://ja.wikipedia.org/wiki/%E3%83%93%E3%83%98%E3%82%A4%E3%83%93%E3%82%A2%E9%A7%86%E5%8B%95%E9%96%8B%E7%99%BA">ビヘイビア駆動開発 - Wikipedia</a></p>
<div class="section" id="servey">
<h2><a class="toc-backref" href="#id30">Servey</a></h2>
<p><a class="reference external" href="http://ja.wikipedia.org/wiki/ユニットテスト・フレームワーク一覧#C">ユニットテスト・フレームワーク一覧 - Wikipedia</a></p>
<p>C言語テストフレームワークについて扱っている日本人の記事</p>
<ul class="simple">
<li><a class="reference external" href="http://softest.cocolog-nifty.com/blog/2008/02/c_394e.html">C言語の単体テスト、いろいろ: ソフトウェアテストの勉強室</a></li>
<li><a class="reference external" href="http://rui.processor.jp/2012/11/unit_test_03">ユニットテスト環境はどのようなものが存在するか | Rui Software</a></li>
<li><a class="reference external" href="http://goyoki.hatenablog.com/entry/2012/07/26/220501">C言語向けユニットテスティングフレームワーク CUT、CuTestについて - 千里霧中</a></li>
</ul>
<p>よく紹介されていて情報もありそうな、以下のフレームワークを試してみる。</p>
<ul class="simple">
<li>CUnit</li>
<li>CUT</li>
<li>Cutter</li>
<li>CuTest</li>
<li>MinUnit</li>
<li>(CMockery)</li>
<li>CSpec(BDD)</li>
<li>Unity</li>
<li>CppUTes</li>
</ul>
<p>※ ほとんどのフレームワームが2006~2008あたりで開発がストップしている。</p>
</div>
<div class="section" id="cunit">
<h2><a class="toc-backref" href="#id31">CUnit</a></h2>
<p>有名なテストフレームワーク。</p>
<p>日本語のチュートリアルがあったので実践。</p>
<p><a class="reference external" href="http://homepage3.nifty.com/kaku-chan/cunit/index.html">CUnit チュートリアル</a></p>
<div class="section" id="install">
<h3>1. Install</h3>
<p>SOURCEFORGEに圧縮ファイルがあるのでダウンロード。( <a class="reference external" href="http://sourceforge.net/projects/cunit">C Unit Testing Framework | Free software downloads at SourceForge.net</a> )</p>
<p>解凍コマンド( <a class="reference external" href="http://uguisu.skr.jp/Windows/tar.html">tarコマンドで解凍・圧縮するlinux一覧まとめ（tg、zgz、zipなど）</a> )</p>
<div class="highlight-none"><div class="highlight"><pre>$ tar -jxf CUnit-2.1-2-src.tar.bz2
$ cd CUnit-2.1-2
$ ./configure --enable-curses
$ make
$ make install
</pre></div>
</div>
<p>※例によって例のごとくCygwinではエラー</p>
<p>※Linux環境ではsudo make installする必要があるかもしれない</p>
</div>
<div class="section" id="usage">
<h3>2. Usage</h3>
<div class="highlight-c"><div class="highlight"><pre><span class="n">include</span> <span class="o">&lt;</span><span class="n">CUnit</span><span class="o">/</span><span class="n">CUnit</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<span class="cp">#include &lt;CUnit/Console.h&gt;</span>

<span class="kt">int</span> <span class="n">say_two</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">test_say_two_01</span><span class="p">();</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">CU_pSuite</span> <span class="n">sort_suite</span><span class="p">;</span>
    <span class="n">CU_initialize_registry</span><span class="p">();</span>
    <span class="n">sort_suite</span> <span class="o">=</span> <span class="n">CU_add_suite</span><span class="p">(</span><span class="s">&quot;Sort&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">CU_add_test</span><span class="p">(</span><span class="n">sort_suite</span><span class="p">,</span> <span class="s">&quot;test_001&quot;</span><span class="p">,</span> <span class="n">test_say_two_01</span><span class="p">);</span>
    <span class="n">CU_console_run_tests</span><span class="p">();</span>
    <span class="n">CU_cleanup_registry</span><span class="p">();</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">test_say_two_01</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">word</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">say_two</span><span class="p">();</span>
    <span class="n">CU_ASSERT</span><span class="p">(</span><span class="n">word</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="usability">
<h3>3. Usability</h3>
<ul class="simple">
<li>古めかしい。</li>
<li>main分を自分で書かないとダメ。しかも結構多い。</li>
<li>色々とCUNIT用の設定を書かないといけないので、テスト書くの大変。</li>
<li>makeしたりと導入コストが高い。しかもCygwinではmake失敗するとかいう環境によっては使えなかったりするのがかなり困る。</li>
</ul>
</div>
</div>
<div class="section" id="cut-2-6">
<h2><a class="toc-backref" href="#id32">CUT 2.6</a></h2>
<p><a class="reference external" href="http://www.falvotech.com/content/cut">CUT 2.6 – 10th Anniversary Version!</a></p>
<p>Pythonを使っている <strong>軽量</strong> テストフレームワーク。</p>
<p>CUT, Cutterについてはこの記事を参考にしています。 <a class="reference external" href="http://goyoki.hatenablog.com/entry/2012/07/26/220501">C言語向けユニットテスティングフレームワーク CUT、CuTestについて - 千里霧中</a></p>
<div class="section" id="id5">
<h3>1. Install</h3>
<p>Linux環境では以下のコマンドでさくっとインストール</p>
<div class="highlight-none"><div class="highlight"><pre>$ wget http://www.falvotech.com/content/cut/2.6/cut-2.6.tar.gz
$ tar -zxvf cut-2.6.tar.gz
$ cd cut-2.6
$ sudo make install PREFIX=/usr/local
cc -c -o cut.o cut.c
ar r libcut.a cut.o
ar: creating libcut.a
rm -rf ./build
mkdir -p ./build/bin
mkdir -p ./build/lib
mkdir -p ./build/include/cut/2.6
cp \*.py ./build/bin
cp cutgen ./build/bin
chmod a+x ./build/bin/cutgen.py ./build/bin/cutgen
cp libcut.a ./build/lib
cp cut.h ./build/include/cut/2.6
mkdir -p /usr/local
cp -r ./build/* /usr/local
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>2. Usage</h3>
<p>残念なことにドキュメントは見当たらない。しかし、使い方はとても簡単。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;cut/2.6/cut.h&gt;</span>

<span class="kt">int</span> <span class="nf">hoge</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">__CUT__Hoge</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ASSERT</span><span class="p">(</span><span class="mi">2</span> <span class="o">==</span> <span class="n">hoge</span><span class="p">(),</span> <span class="s">&quot;Assert Message!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>テスト関数は__CUT__を接頭語としてつける。</p>
<p>テスト関数を記載したファイルを読み込んだ後は、cutgenを実行する。</p>
<p>テスト用のmain関数が書かれたファイルが出力されるのでコンパイル-&gt;実行。</p>
<div class="highlight-none"><div class="highlight"><pre>$ cutget hoge.c &gt; main.c
$ gcc hoge.c main.c -L/usr/local/lib -lcut
$ ./a.out
cut.c:10:0: 2 == hoge(): error: Assert Message.
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>3. Usability</h3>
<ul class="simple">
<li>簡単に使える。make installしているがmakeなくてもいけるんじゃないかというくらい。</li>
<li>軽量。動作も軽快。</li>
<li>テストフレームワークとして <strong>必要最小限</strong> の機能しかない。</li>
<li>pythonが入っていないとcutgenコマンドが使えない。</li>
</ul>
</div>
</div>
<div class="section" id="cutest">
<h2><a class="toc-backref" href="#id33">CuTest</a></h2>
<p><a class="reference external" href="http://cutest.sourceforge.net">CuTest: The Cutest C Unit Testing Framework</a></p>
<p>CUTのshell script版。ヘッダとソースファイルさえあればいい。</p>
<p>ドキュメントはREADME.txtのみ！そのままやってみる。</p>
<div class="section" id="id8">
<h3>1. Install</h3>
<p><a class="reference external" href="http://sourceforge.net/projects/cutest">CuTest: C Unit Testing Framework | Free Development software downloads at SourceForge.net</a></p>
<p>上記のリンクにZIPファイルが落ちているので解凍するだけ。</p>
</div>
<div class="section" id="id9">
<h3>2. Usage</h3>
<p>カレントディレクトリに(/testとかディレクトリを作ってもいい)、CuTest.h, CuTest.c, make-tests.shを配置する。</p>
<p># cutest_sample.c</p>
<div class="highlight-c"><div class="highlight"><pre>#include &lt;stdio.h&gt;
#include &quot;CuTest.h&quot;

char* StrToUpper(char* str) {
    return str;
}

void TestStrToUpper(CuTest \*tc) {
    char* input = strdup(&quot;hello world&quot;);
    char* actual = StrToUpper(input);
    char* expected = &quot;HELLO WORLD&quot;;
    CuAssertStrEquals(tc, expected, actual);
}

CuSuite* StrUtilGetSuite() {
    CuSuite* suite = CuSuiteNew();
    SUITE_ADD_TEST(suite, TestStrToUpper);
    return suite;
}
</pre></div>
</div>
<p>もちろんアサートが出るコード。</p>
<p><strong>注意</strong></p>
<blockquote>
<div><p>#include &lt;stdio.h&gt;しないと
‘NULL’ undeclared (first use in this function)のエラーメッセージが出るので注意。</p>
<p>(ここに書いてあった-&gt; <a class="reference external" href="http://snowycode.blogspot.jp/2010/05/cerror-c2065-null.html">Snowy Code: C++のエラー：error C2065: ‘NULL’ : 定義されていない識別子です。:C,C++,PHP,XCODE</a> )</p>
</div></blockquote>
<p>テストコードを作成したら次にshell script(make_test.sh)を実行して、コンパイル。</p>
<div class="highlight-none"><div class="highlight"><pre>$ sh make-tests.sh cutest_sample.c &gt; main.c
$ gcc main.c CuTest.c cutest_sample.c
$ ./a.out
There was 1 failure:
1) TestStrToUpper: cutest_sample.c:12: expected &lt;HELLO WORLD&gt; but was &lt;hello world&gt;

!!!FAILURES!!!
Runs: 1 Passes: 0 Fails: 1
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>3. Usability</h3>
<ul class="simple">
<li>CUTと同様に軽量で早い。</li>
<li>ライブラリじゃないので、ヘッダとソースを読み込むだけの簡単導入。</li>
<li>CUTよりテストフレームワークとして作りこまれている。(とりあえず、メッセージはCUTより丁寧)</li>
<li>main書かなくていい。</li>
<li>シェルスクリプトを実行するだけで簡単にテストが作れる。</li>
<li>シェルスクリプトに不具合があるような気がする。出力ファイルの変な箇所に改行が入っていた。(自分で修正)</li>
</ul>
</div>
</div>
<div class="section" id="cutter">
<h2><a class="toc-backref" href="#id34">Cutter</a></h2>
<p><a class="reference external" href="http://cutter.sourceforge.net/index.html.ja">C言語・C++言語用テスティングフレームワーク - Cutter</a></p>
<p>日本人が開発している。</p>
<p>なんとドキュメントが非常に充実している。が、逆に丁寧に書かれすぎて複雑な感じになっているorz</p>
<p>そんな不満を持ている人が他にもいた↓</p>
<p><a class="reference external" href="http://samidarehetima.blog9.fc2.com/blog-entry-149.html">凡人プログラマーの独り言 Cutterのとても簡単な使い方</a></p>
<p>簡単に使ってみよう。</p>
<div class="section" id="id12">
<h3>1. Install</h3>
<p><a class="reference external" href="http://cutter.sourceforge.net/reference/ja/install.html">プラットフォーム毎のCutterのインストール方法 - Cutter</a></p>
<p>ドキュメントがえらく丁寧なので、上記サイトの手法を使えばインストールできる(丸投げ)</p>
<p>※ cygwinだとうまくコンパイルされない?!</p>
<blockquote>
<div>自分の環境だとmake installして入れた。cutterだがコンパイルは通るものの、cutterで実行するとうまくいかない。
具体的には、テストが実行されない。空のテストが実行された事になってる。Ubuntuでは同じコードで正常に動作する。</div></blockquote>
<p>Macにインストールする場合はportでもbrewでもインストールできる。</p>
<div class="highlight-none"><div class="highlight"><pre>$ brew install cutter
$ sudo port install cutter
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3>2. Usage</h3>
<p>テストコード : cutter.c</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;cutter.h&gt;</span>

<span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">sub</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">test_add</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">test_sub</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span> <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">int</span> <span class="nf">sub</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span> <span class="k">return</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">;</span> <span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_add</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    <span class="n">cut_assert_equal_int</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_sub</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    <span class="n">cut_assert_equal_int</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">sub</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>実行してみる。Ubuntuでインストールしたところusr/localではなくusr直下にインストールされていた。インストール時にパス指定しないとなのか。</p>
<div class="highlight-none"><div class="highlight"><pre>$ gcc -shared cutter.c -o ./cutter/cutter.so -I/usr/include/cutter -L/usr/lib -lcutter
$ cutter cutter/
..

Finished in 0.006999 seconds (total: 0.000427 seconds)

2 test(s), 2 assertion(s), 0 failure(s), 0 error(s), 0 pending(s), 0 omission(s), 0 notification(s)
100% passed
.....(失敗するように編集)
$ cutter cutter/
F
===============================================================================
Failure: test_add
&lt;4 == add(1,2)&gt;
expected: &lt;4&gt;
  actual: &lt;3&gt;
cutter.c:12: test_add(): cut_assert_equal_int(4, add(1,2), )
===============================================================================
.

Finished in 0.006359 seconds (total: 0.002195 seconds)

2 test(s), 1 assertion(s), 1 failure(s), 0 error(s), 0 pending(s), 0 omission(s), 0 notification(s)
50% passed
</pre></div>
</div>
<p>cutterは.soファイルを作成-&gt;実行でテストという流れになっている。</p>
<p>テストのためにわざわざmain書かなくていいのが調子いい。</p>
</div>
<div class="section" id="id14">
<h3>3. Usability</h3>
<ul class="simple">
<li>情報が多い。日本人ユーザーも多い。</li>
<li>Windowsに導入する方法がどこにも書かれていない。いい感じにdisってる。</li>
<li>main書かなくていいので、本体のアプリケーションとの分離ができているのでテストの位置づけがわかりやすい。</li>
<li>テストコードは完結に書けて良い感じ。</li>
<li>残念なことに、本家チュートリアルが鬼。automakeとかの勉強しないと。</li>
<li>テストフレームワークとして機能が充実している。</li>
<li>本家ドキュメントが鬼なので簡単に使える方法を紹介している記事がいくつかある。<ul>
<li><a class="reference external" href="http://samidarehetima.blog9.fc2.com/blog-entry-149.html">凡人プログラマーの独り言 Cutterのとても簡単な使い方</a></li>
<li><a class="reference external" href="http://www.ne.jp/asahi/hishidama/home/tech/c/cutter.html">Cutterメモ(Hishidama’s C-lang Cutter Memo)</a> &lt;- CentOS</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="mintest">
<h2><a class="toc-backref" href="#id35">MinTest</a></h2>
<p><a class="reference external" href="http://www.jera.com/techinfo/jtns/jtn002.html">JTN002 - MinUnit – a minimal unit testing framework for C</a></p>
<div class="section" id="id16">
<h3>1. Install</h3>
<p>インストール？そんなのはいらない！？以下の3行がMinTest。</p>
<div class="highlight-c"><div class="highlight"><pre>/\* file: minunit.h \*/
#define mu_assert(message, test) do { if (!(test)) return message; } while (0)
#define mu_run_test(test) do { char \*message = test(); tests_run++; if (message) return message; } while (0)
extern int tests_run;
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h3>2. Usage</h3>
<p>本家ドキュメントにあるコード。読めばすぐわかるくらい簡単！</p>
<div class="highlight-c"><div class="highlight"><pre>/\* file minunit_example.c \*/

#include &lt;stdio.h&gt;
#include &quot;minunit.h&quot;

int tests_run = 0;

int foo = 7;
int bar = 4;

static char * test_foo() {
   mu_assert(&quot;error, foo != 7&quot;, foo == 7);
   return 0;
}

static char * test_bar() {
   mu_assert(&quot;error, bar != 5&quot;, bar == 5);
   return 0;
}

static char * all_tests() {
   mu_run_test(test_foo);
   mu_run_test(test_bar);
   return 0;
}

int main(int argc, char \*\*argv) {
   char \*result = all_tests();
   if (result != 0) {
       printf(&quot;%s\n&quot;, result);
   }
   else {
       printf(&quot;ALL TESTS PASSED\n&quot;);
   }
   printf(&quot;Tests run: %d\n&quot;, tests_run);

   return result != 0;
}
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h3>3. Usability</h3>
<ul class="simple">
<li>軽量どころか3行wwww</li>
<li>導入コストがこれより低いフレームワークを探す方が難しい。</li>
<li>そんなんなので話題性があり情報がたくさんある。</li>
<li>MinTestをForkしてGithubにリポジトリ作った人がいる。中を見たが結構改良されている。 <a class="reference external" href="https://github.com/siu/minunit">siu/minunit · GitHub</a></li>
<li>とても簡単なのでカスタマイズし放題、下記はカスタムしてある記事<ul>
<li><a class="reference external" href="http://iyukki.blog56.fc2.com/blog-entry-94.html">MinUnitでテストしてみる CodingFirst</a></li>
<li><a class="reference external" href="http://iyukki.blog56.fc2.com/blog-entry-104.html">MinUnitでテストしたその後 CodingFirst</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="cmockery">
<h2><a class="toc-backref" href="#id36">CMockery</a></h2>
<p>google製軽量テストフレームワーク。</p>
<p>なにやら、一組の.cファイルと.hファイルからなるフレームワークらしい。</p>
<p>今回は、大人の事情で実際に使ってみたりはしないが、その名の通りMock機能(will_returnとか)等があり、他のフレームワークにはないような機能があるっぽい。</p>
<p>詳しくは-&gt; <a class="reference external" href="http://goyoki.hatenablog.com/entry/2012/07/20/212242">C言語向けユニットテスティングフレームワーク Cmockeryについて - 千里霧中</a></p>
</div>
<div class="section" id="cspec">
<h2><a class="toc-backref" href="#id37">CSpec</a></h2>
<p><a class="reference external" href="https://github.com/arnaudbrejeon/cspec/wiki">CSpec : Behavior-driven development in C · arnaudbrejeon/cspec Wiki</a></p>
<p>その名の通りRSpecリスペクトなBDDフレームワーク。開発は2年前くらいで止まってる(2013/04現在)。</p>
<p>独自のDSLのようなものが実装してあって、C言語ではないかのように扱える。</p>
<div class="section" id="id20">
<h3>1. Install</h3>
<p>Githubにリポジトリがある。</p>
<div class="highlight-none"><div class="highlight"><pre>$ git clone https://github.com/toshi-kawanishi/cspec.git
$ cd src
$ make
$ cp libcspec.a /usr/local/lib/
$ cp -r ../inc/ /usr/local/include/
</pre></div>
</div>
<p>本家のほうではなくtoshi-kawanishiさんのリポジトリからcloneした。</p>
<p>本家のリポジトリにあるsrcには、Makefile.amのみが置いてあって自分でautomakeしろということですね、わかります。いやautomakeわかりません。なので、Makefileを用意してくれているこの方のリポジトリを使用する。</p>
<ul class="simple">
<li>repos : <a class="reference external" href="https://github.com/toshi-kawanishi/cspec">toshi-kawanishi/cspec · GitHub</a></li>
<li><a class="reference external" href="http://toshiyukikawanishi.net/blog/2008/12/11">Toshiyuki Kawanishi &gt;&gt; Blog &gt;&gt; 燃え上がれC言語 その1 ― CSpec</a></li>
<li><a class="reference external" href="http://toshiyukikawanishi.net/blog/2008/12/13">Toshiyuki Kawanishi &gt;&gt; Blog &gt;&gt; 燃え上がれC言語 その2 ― CSpec でのテストの書き方</a></li>
</ul>
</div>
<div class="section" id="id21">
<h3>2. Usage</h3>
<div class="highlight-c"><div class="highlight"><pre>#include &lt;cspec.h&gt;
#include &lt;cspec_output_verbose.h&gt;

int under_test_function( int a, int b )
{
      return a + b;
}

DESCRIBE(xml_long, &quot;under_test_function()&quot;)
{
      IT( &quot;return sum arguments.&quot; ) {
              SHOULD_EQUAL( under_test_function( 1, 2 ), 3 );
      } END_IT;
} END_DESCRIBE;

int main( int argc, char \*\*argv )
{
      CSpec_Run( DESCRIPTION(xml_long), CSpec_NewOutputVerbose() );
      return 0;
}
</pre></div>
</div>
<p>DESCRIBE ~ END_DESCRIBEまではcspecのコード。</p>
<p>独自のDSLで書かれていて、Cのコードの中にあると違和感しかない。</p>
<p>実行は先程のライブラリをリンクさせればコンパイル出来る。</p>
<div class="highlight-c"><div class="highlight"><pre>$ gcc cspec.c -I/usr/local/include/cspec -L/usr/local/lib -lcspec
$ ./a.out
Describe:under_test_function()
   - it return sum arguments.
       OK: (under_test_function( 1, 2 )) == (3)
</pre></div>
</div>
<p>ちなみに括弧とか;(セミコロン)とか付けなくてもちゃんと動作する。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">DESCRIBE</span><span class="p">(</span><span class="n">xml_long</span><span class="p">,</span> <span class="s">&quot;under_test_function()&quot;</span><span class="p">)</span>

      <span class="n">IT</span><span class="p">(</span> <span class="s">&quot;return sum arguments.&quot;</span> <span class="p">)</span>
              <span class="n">SHOULD_EQUAL</span><span class="p">(</span> <span class="n">under_test_function</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">),</span> <span class="mi">3</span> <span class="p">)</span>
      <span class="n">END_IT</span>

<span class="n">END_DESCRIBE</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h3>3. Usability</h3>
<ul class="simple">
<li>独自DSLとかかっこいい。</li>
<li>比較的導入が簡単。</li>
<li>テストフレームワークと比較して簡単に書けそう。(BDDなので当たり前か。。。)</li>
<li>main文でCSpec_Run呼ばないといけないのが残念。</li>
<li>C言語でもBDDを使えるというのが素晴らしい。</li>
<li>仕様自体は小さいのですぐに使える。</li>
<li>参考になる記事が割と多い。 -&gt; <a class="reference external" href="http://goyoki.hatenablog.com/entry/2012/07/24/202748">C言語向けBDDフレームワーク CSpecについて - 千里霧中</a></li>
</ul>
</div>
</div>
<div class="section" id="unity">
<h2><a class="toc-backref" href="#id38">Unity</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.ogis-ri.co.jp/otc/hiroba/OoBook/tdd4ec/index.html">[ 技術書籍紹介 ] Test Driven Development for Embedded C</a></li>
<li><a class="reference external" href="http://www.ryuzee.com/contents/blog/6623">[書評]テスト駆動開発による組み込みプログラミング | Ryuzee.com</a></li>
</ul>
<p>最近(2013/04)邦訳本が出た、この書籍で紹介されているUnityとCppUTestを取り上げてみる。</p>
<p>英語版の勉強会は盛んに行われていたようだ。</p>
<p>がしかし、情報が少ない。UnityにはUbuntuのシェルインターフェース、ゲームエンジンと有名なプロダクトの情報ばかり出てくる。</p>
<div class="section" id="id23">
<h3>1. Install</h3>
<p><a class="reference external" href="https://github.com/ThrowTheSwitch/Unity">ThrowTheSwitch/Unity · GitHub</a></p>
</div>
<div class="section" id="id24">
<h3>2. Usage</h3>
</div>
<div class="section" id="id25">
<h3>3. Usability</h3>
</div>
</div>
<div class="section" id="cpputest">
<h2><a class="toc-backref" href="#id39">CppUTest</a></h2>
<div class="section" id="id26">
<h3>1. Install</h3>
</div>
<div class="section" id="id27">
<h3>2. Usage</h3>
</div>
<div class="section" id="id28">
<h3>3. Usability</h3>
</div>
</div>
</div>]]></description>
             <pubDate>Thu, 25 Apr 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/04/05/news.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/04/05/news.html</guid>
            <title><![CDATA[Think about news site]]></title>
            <description><![CDATA[<div class="section" id="think-about-news-site">
<h1>Think about news site</h1>
<p>自分はよくY CombinatorのHackerNewを眺めているが、</p>
<p>飲み会で@ITとかITproとか見たほうがいいよ的なことを聞いたので、まずどんなニュースサイトがあるのか調べてみる。</p>
<div class="section" id="open-google-it">
<h2>:open google it情報 サイト</h2>
<ul class="simple">
<li>ITpro</li>
<li>ITmedia</li>
<li>ASCII.jp</li>
<li>CNET Japan</li>
<li>@IT</li>
<li>IT Leaders</li>
</ul>
<p>などなど。</p>
<p>他に自分が知ってるのは</p>
<ul class="simple">
<li>CodeZine</li>
<li>Publickey</li>
<li>GIGAZINE</li>
</ul>
<p>ざっと調べた限り見つかったサイトの特徴を独断と偏見で感想を述べてみる。</p>
</div>
<div class="section" id="it">
<h2>@IT</h2>
<p><a class="reference external" href="http://www.atmarkit.co.jp">ITエキスパートのための問題解決メディア - ＠IT</a></p>
<p>ひとまずはてなに尋ねる。</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/keyword/@IT">@ITとは - はてなキーワード</a></p>
<ul class="simple">
<li>IT系の会社に入った人が見てそう</li>
</ul>
</div>
<div class="section" id="itmedia">
<h2>ITmedia</h2>
<p><a class="reference external" href="http://itpro.nikkeibp.co.jp/?rt=nocnt">Tpro - エンタープライズICTの総合情報</a></p>
<p>ひとまずはてなに尋ねる。</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/keyword/ITpro">ITproとは - はてなキーワード</a></p>
<ul class="simple">
<li>IT系の会社に務めている人が見てそう</li>
</ul>
</div>
<div class="section" id="ascii-jp">
<h2>ASCII.jp</h2>
<p><a class="reference external" href="http://ascii.jp">ASCII.jp － トップ</a></p>
<p>アキバ系IT情報サイト</p>
<ul class="simple">
<li>アキバ系の情報とハードの情報が多いような気がした。(ぱっと見)</li>
</ul>
</div>
<div class="section" id="cnet-japan">
<h2>CNET Japan</h2>
<p><a class="reference external" href="http://japan.cnet.com">CNET Japan</a></p>
<ul class="simple">
<li>日本版CNET</li>
<li>一般的な情報が多い</li>
</ul>
</div>
<div class="section" id="it-leaders">
<h2>IT Leaders</h2>
<p><a class="reference external" href="http://it.impressbm.co.jp">IT Leaders | 企業情報システム担当者やITプロフェッショナルのための実践情報サイト</a></p>
<ul class="simple">
<li>マーケティングの情報を確認したい時とかはいいのかも</li>
</ul>
</div>
<div class="section" id="codegine">
<h2>CodeGine</h2>
<p><a class="reference external" href="http://codezine.jp">CodeZine：プログラミングに役立つソースコードが満載な開発者のための実装系Webマガジン</a></p>
<p>ひとまずはてなに尋ねる。</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/keyword/CodeZine">CodeZineとは - はてなキーワード</a></p>
<ul class="simple">
<li>実装系IT情報サイト</li>
<li>実装系の幅広なトピックを扱ってる</li>
<li>実装系なコードはフリーに使ってもいい</li>
</ul>
</div>
<div class="section" id="publickey">
<h2>PublicKey</h2>
<p><a class="reference external" href="http://www.publickey1.jp">Publickey － Enterprise IT × Cloud Computing × Web Technology / Blog</a></p>
<ul class="simple">
<li>なんかおしゃれ</li>
<li>Publickey Topicsというサイトも最近始まった( <a class="reference external" href="http://www.publickey2.jp">Publickey Topics</a> )</li>
<li>Junichi Niinoさんが記事を更新しています。</li>
<li>というか、これはブログ？</li>
<li><a class="reference external" href="http://www.publickey1.jp/blog/12/_publickey2012.html">ブログでメシが食えるか？ Publickeyの2012年 － Publickey</a> 飯も食えてる。</li>
</ul>
</div>
<div class="section" id="gigagine">
<h2>GIGAGINE</h2>
<p><a class="reference external" href="http://gigazine.net">GIGAZINE（ギガジン）</a></p>
<p>Wikipediaさんが教えてくれる。</p>
<p><a class="reference external" href="http://ja.wikipedia.org/wiki/GIGAZINE">GIGAZINE - Wikipedia</a></p>
<ul class="simple">
<li>面白ネタ満載</li>
<li>上げた中では一番面白い</li>
</ul>
</div>
</div>]]></description>
             <pubDate>Fri, 05 Apr 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html</guid>
            <title><![CDATA[Dive into Effective C++]]></title>
            <description><![CDATA[<div class="section" id="dive-into-effective-c">
<h1><a class="toc-backref" href="#id2">Dive into Effective C++</a></h1>
<p>C++やってますと言えるようになるために</p>
<p>Effective C++ 第3版 スコット・メイヤーズ著  小林健一郎訳</p>
<p>を読んでみる。</p>
<p>2008年くらいの書物なのでC++11対応はしていない。C++11についても色々知りたいが今はあまり背伸びしないで下記の記事で満足することにする。</p>
<p><a class="reference external" href="http://dic.nicovideo.jp/a/c%2B%2B11">C++11とは (シープラスプラスイレブンとは) [単語記事] - ニコニコ大百科</a></p>
<div class="contents topic" id="id1">
<p class="topic-title first"><strong>目次</strong></p>
<ul class="simple">
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html#dive-into-effective-c" id="id2">Dive into Effective C++</a><ul>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html#introduction" id="id3">Introduction</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html#c" id="id4">#1 C++を複数の言語の連合と見なそう</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html#defineconst-enum-inline" id="id5">#2 #defineより、const, enum, inlineを使おう</a></li>
<li><a class="reference internal" href="http://yymm.bitbucket.org/blog/html/2013/04/02/effective_c__.html#const" id="id6">#3 可能ならいつでもconstを使おう</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction</a></h2>
<p>イントロダクションなんて適当に読もうと思ったところ、そういうわけにもいかないようだ。。。。</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cm">/* 宣言 */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">numDigits</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">);</span>
<span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">GraphNode</span><span class="p">;</span>
<span class="c1">// extern宣言</span>
<span class="c1">// * 外部の変数にアクセスできるキーワード</span>

<span class="c1">// size_t</span>
<span class="c1">// * 何かを数えるときに使う「符号なし整数」をtypedefしたもの</span>


<span class="cm">/* 定義 */</span>
<span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">numDigits</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">digitsSoFar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">number</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="o">++</span><span class="n">digitsSoFar</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">digitsSoFar</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">GraphNode</span>
<span class="p">{</span>
	<span class="nl">public:</span>
		<span class="n">GraphNode</span><span class="p">();</span>
		<span class="o">~</span><span class="n">GraphNode</span><span class="p">();</span>
<span class="p">};</span>


<span class="cm">/* デフォルトコンストラクタ */</span>
<span class="k">class</span> <span class="nc">A</span>
<span class="p">{</span>
	<span class="nl">public:</span>
		<span class="n">A</span><span class="p">();</span>	<span class="c1">// デフォルトコンストラクタ</span>
<span class="p">};</span>
<span class="k">class</span> <span class="nc">B</span>
<span class="p">{</span>
	<span class="nl">public:</span>
		<span class="k">explicit</span> <span class="n">B</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">b</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>	<span class="c1">// デフォルトコンストラクタ</span>
		<span class="p">{</span>
		<span class="p">}</span>
<span class="p">};</span>
<span class="k">class</span> <span class="nc">C</span>
<span class="p">{</span>
	<span class="nl">public:</span>
		<span class="k">explicit</span> <span class="n">C</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">);</span>	<span class="c1">// デフォルトコンストラクタではない</span>
<span class="p">};</span>


<span class="cm">/* explicitキーワード */</span>
<span class="kt">void</span> <span class="nf">doSomething</span><span class="p">(</span><span class="n">B</span> <span class="n">bObject</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;B型のオブジェクトを引数に取る関数&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">B</span> <span class="n">bObj1</span><span class="p">;</span>
<span class="n">B</span> <span class="nf">bObj2</span><span class="p">(</span><span class="mi">28</span><span class="p">);</span>		<span class="c1">// int値の28からB型のオブジェクトを生成</span>
<span class="n">doSomething</span><span class="p">(</span><span class="mi">28</span><span class="p">);</span>	<span class="c1">// エラー!: intからB型オブジェクトへの暗黙の型変換はされない</span>
<span class="n">doSomething</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">28</span><span class="p">));</span>	<span class="c1">// 問題ない: B型のオブジェクトを使ってintをBに変換している</span>
<span class="c1">// explicit</span>
<span class="c1">// * 暗黙的な型変換を禁止するキーワード</span>
<span class="c1">// * explicitを付けないコンストラクタだと予想外の型変換を起こす可能性がある</span>
<span class="c1">// * 下記のコードもexplicitを付けないと暗黙的に型変換をしてしまいエラーにならず通ってしまう</span>
<span class="c1">// * 特に理由がなければ、暗黙的な型変換をしないようにコンストラクタはexplicit付きで宣言する</span>

<span class="cm">/* コピーコンストラクタ */</span>
<span class="k">class</span> <span class="nc">Widget</span>
<span class="p">{</span>
	<span class="nl">public:</span>
		<span class="n">Widget</span><span class="p">();</span>								<span class="c1">// デフォルトコンストラクタ</span>
		<span class="n">Widget</span><span class="p">(</span><span class="k">const</span> <span class="n">Widget</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>				<span class="c1">// コピーコンストラクタ</span>
		<span class="n">Widget</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Widget</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>	<span class="c1">// コピー代入演算子</span>
		<span class="o">~</span><span class="n">Widget</span><span class="p">();</span>
<span class="p">};</span>
<span class="n">Widget</span> <span class="n">w1</span><span class="p">;</span>		<span class="c1">// デフォルトコンストラクタが使われる</span>
<span class="n">Widget</span> <span class="nf">w2</span><span class="p">(</span><span class="n">w1</span><span class="p">);</span>	<span class="c1">// コピーコンストラクタが使われる</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">w2</span><span class="p">;</span>		<span class="c1">// コピー代入演算子が使われる</span>
<span class="n">Widget</span> <span class="n">w3</span><span class="o">=</span><span class="n">w2</span><span class="p">;</span>	<span class="c1">// コピーコンストラクタが使われる！ =&gt; Widget w2(w1)とWidget w2=w1は同じ動作</span>
<span class="kt">bool</span> <span class="nf">hasAcceptableQuery</span><span class="p">(</span><span class="n">Widget</span> <span class="n">w</span><span class="p">);</span>
<span class="n">Widget</span> <span class="n">aWidget</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">hasAcceptableQuery</span><span class="p">(</span><span class="n">Widget</span> <span class="n">w</span><span class="p">))</span>	<span class="c1">// コピーコンストラクタが実行</span>
<span class="p">{</span>
	<span class="c1">// ユーザー定義型を値渡しするのは良くない。一般にはconst参照渡しが良い。</span>
<span class="p">}</span>
<span class="c1">// コピーコンストラクタ</span>
<span class="c1">// * 同じ型の別のオブジェクトで初期化するときに使う</span>
<span class="c1">// コピー演算子</span>
<span class="c1">// * 同じ型の別のオブジェクトを代入するときに使う</span>

<span class="cm">/* 未定義な動作 */</span>
<span class="kt">int</span><span class="o">*</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>				<span class="c1">// pがヌルポインタ</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>		<span class="c1">// ヌルポインタが示す場所を取り出そうとすると動作は未定義になる</span>
<span class="kt">char</span> <span class="n">name</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;Hoge&quot;</span><span class="p">;</span>	<span class="c1">// 要素数は6</span>
<span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>		<span class="c1">// 無効な添字の要素にアクセスしようとすると動作は未定義になる</span>
<span class="c1">// undefined</span>
<span class="c1">// * C++ではこのような未定義な動作をかけてしまう(JavaやC#ではない)</span>
<span class="c1">// * C++では未定義な動作をするコードをできるだけ書かないようにする注意が必要</span>


<span class="cm">/* シグネチャ */</span>
<span class="c1">// * メソッドや関数の名前、戻り値、引数の型などの組み合わせのこと</span>


<span class="cm">/* インターフェース */</span>
<span class="c1">// * JavaやC#にあるInterface宣言とは違う使い方をしてます</span>
<span class="c1">// * 関数のシグネチャやクラスのアクセス可能な要素などを意味する</span>
<span class="c1">// * テンプレート型のパラメータを意味することもある</span>


<span class="cm">/* 命名法 */</span>
<span class="c1">// わかり易い名前を心がける</span>
<span class="c1">// * 略記について</span>
<span class="k">const</span> <span class="n">Rational</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>	<span class="c1">// left-hand sideとright-hand sideのこと</span>
<span class="n">Widget</span><span class="o">*</span> <span class="n">pw</span><span class="p">;</span>	<span class="c1">// ポインタ変数には接頭語に&quot;p&quot;をつける</span>
<span class="k">class</span> <span class="nc">GameCharacter</span><span class="p">;</span>
<span class="n">GameCharacter</span><span class="o">*</span> <span class="n">pgc</span><span class="p">;</span>
<span class="n">GameCharactor</span><span class="o">::</span><span class="n">move</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">mf</span> <span class="o">=</span> <span class="s">&quot;hoge&quot;</span><span class="p">;</span>	<span class="c1">// メンバ変数のことをmfと書くこともある</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="c">
<h2><a class="toc-backref" href="#id4">#1 C++を複数の言語の連合と見なそう</a></h2>
<p>C++のサブセット</p>
<ul class="simple">
<li>c</li>
<li>オブジェクト指向C++</li>
<li>テンプレートC++</li>
<li>STL</li>
</ul>
<p><em>C++で効率よくプログラミングするためのルールは、C++のどの部分を使うかで変わってくる。</em></p>
</div>
<div class="section" id="defineconst-enum-inline">
<h2><a class="toc-backref" href="#id5">#2 #defineより、const, enum, inlineを使おう</a></h2>
<p>「プリプロセッサよりコンパイラを使おう」</p>
<dl class="docutils">
<dt>プリプロセッサ</dt>
<dd>コンパイル作業において、初期段階で#define, #includeなどの内容が処理される。
その処理を行う機能(ツールなど)をプリプロセッサという。
広い意味ではコンパイルに含まれるが、狭い意味のコンパイルよりも後に実行される。</dd>
</dl>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cm">/* constを使う１ マクロの欠点 */</span>
<span class="c1">// この使い方をするとコンパイラからはASPECT_RATIOは見えない</span>
<span class="c1">// 1.653という数字になってる</span>
<span class="c1">// デバックするときに困るかもしれない</span>
<span class="cp">#define ASPECT_RATIO 1.653</span>

<span class="c1">// マクロを定数に置き換えることで解決</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">AspectRatio</span> <span class="o">=</span> <span class="mf">1.653</span><span class="p">;</span>

<span class="c1">// 利点</span>
<span class="c1">// * マクロを使うと、ASPECT_RATIOが出てくるたびに機械的にそれを1.653に置き換える(コピーが大量発生)</span>
<span class="c1">// * 一方、AspectRatioは常に１つしか存在しない</span>


<span class="cm">/* constを使う２ 定数ポインタ */</span>
<span class="c1">// char*を使った定数文字列</span>
<span class="c1">// constが２回必要(charとポインタの２回)</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">authorName</span> <span class="o">=</span> <span class="s">&quot;Nanashino Gonbe&quot;</span><span class="p">;</span>
<span class="c1">// 一般にはchar*よりstringを使ったほうが良い</span>
<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">authorName</span><span class="p">(</span><span class="s">&quot;Nanashino Gonbe&quot;</span><span class="p">);</span>


<span class="cm">/* constを使う３ クラスの持つ定数 */</span>
<span class="c1">// クラスで使う変数のスコープを限定するために、その定数をクラスのメンバにすることがある</span>
<span class="c1">// #defineでは再現不可能</span>
<span class="c1">// その定数が実際に１つだけ存在するようにstaticにする必要がある</span>
<span class="k">class</span> <span class="nc">GamePlayer</span>
<span class="p">{</span>
	<span class="nl">private:</span>
		<span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">NumTurns</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">scores</span><span class="p">[</span><span class="n">NumTurns</span><span class="p">];</span>
<span class="p">};</span>
<span class="c1">// 問題</span>
<span class="c1">// * staticな整数型定数メンバであっても宣言時に初期化できない(昔のコンパイラを使っているならば)</span>
<span class="k">class</span> <span class="nc">CostEstimate</span>
<span class="p">{</span>
	<span class="nl">private:</span>
		<span class="k">static</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">FudgeFactor</span><span class="p">;</span>	<span class="c1">// ヘッダーファイルに書かれる</span>
<span class="p">};</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">CostEstimate</span><span class="o">::</span><span class="n">FudgeFactor</span> <span class="o">=</span> <span class="mf">1.35</span><span class="p">;</span>	<span class="c1">// ソースダイルに書かれる</span>
<span class="c1">// 更に問題</span>
<span class="c1">// * GamePlayerのようにコンパイル時に「クラスの定数」が必要になった時、コンパイルエラーが出る。</span>


<span class="cm">/* enumハック */</span>
<span class="c1">// 上記の更に問題を解決する手法</span>
<span class="k">class</span> <span class="nc">GamePlayer</span>
<span class="p">{</span>
	<span class="nl">private:</span>
		<span class="k">enum</span> <span class="p">{</span> <span class="n">NumTurns</span><span class="o">=</span><span class="mi">5</span> <span class="p">};</span>	<span class="c1">// [enumハック] =&gt; NumTurnsを５として使える</span>
								<span class="c1">// constよりdefineに近い</span>
								<span class="c1">// enumハックは色々なところで利用されているので覚えておく価値有り！</span>
		<span class="kt">int</span> <span class="n">score</span><span class="p">[</span><span class="n">NumTurns</span><span class="p">];</span>	<span class="c1">// 問題なし</span>
<span class="p">};</span>

<span class="cm">/* マクロの問題点 */</span>
<span class="cp">#define CALL_WITH_MAX(a,b) f((a) &gt; (b) ? (a) : (b))</span>
<span class="c1">// このマクロの悲惨さ</span>
<span class="c1">// * 仮引数を括弧で囲う必要がある</span>
<span class="c1">// * int a=5, b=0;</span>
<span class="c1">// * CALL_WITH_MAX(++a, b);		// aが２回インクリメント</span>
<span class="c1">// * CALL_WITH_MAX(++a, b+10);	// aが１回インクリメント</span>
<span class="c1">// * 運悪く引数によって挙動が変わる事がある</span>
<span class="c1">//</span>
<span class="c1">// こんなマクロを作るくらいならインライン関数のテンプレートを作る！</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">callWithMax</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="o">?</span> <span class="n">a</span> <span class="o">:</span> <span class="n">b</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>単純な定数には、#defineよりもconstかenumを使うようにする。</em></p>
<p><em>#defineで定義されているマクロよりも、インライン関数を使おう。</em></p>
<p>※インライン関数については#30を参考に。</p>
</div>
<div class="section" id="const">
<h2><a class="toc-backref" href="#id6">#3 可能ならいつでもconstを使おう</a></h2>
</div>
</div>]]></description>
             <pubDate>Tue, 02 Apr 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/04/01/responsiveweb.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/04/01/responsiveweb.html</guid>
            <title><![CDATA[Responsive Web Design 始めました]]></title>
            <description><![CDATA[<div class="section" id="responsive-web-design">
<h1>Responsive Web Design 始めました</h1>
<p>以前から名前は聞いたことがあった”レスポンシブデザイン”。</p>
<p>今作ってるアプリがモバイル対応しないと作った意味が無いので勉強する。</p>
<div class="section" id="id1">
<h2>レスポンシブデザインはかっこいい?</h2>
<p><a class="reference external" href="http://responsive-jp.com">Responsive Web Design JP | 日本国内の秀逸なレスポンシブWebデザインを集めたギャラリーサイト</a></p>
<p>このサイトを眺める感じかっこいい。</p>
</div>
<div class="section" id="media-queries">
<h2>media queriesを使った実装</h2>
<p>Media Queruesはcss3からの機能。</p>
<p>対応する端末の解像度に合わせて設定していく。</p>
<p>端末の解像度がどの程度か知る必要がある。</p>
<p><a class="reference external" href="http://case-mobile-design.com/devices/resolution-list">case:MobileDesign! – スマートフォンサイトの制作TIPS BLOG - » スマートフォン・タブレット画面解像度一覧</a></p>
<p>この辺りを見ると何となく基準がわかるのではないかと。</p>
<p>基準を模索するのが面倒なので、下記の記事を参考にしてみる。</p>
<p><a class="reference external" href="http://www.onextrapixel.com/2012/04/23/responsive-web-design-layouts-and-media-queries">Responsive Web Design: Layouts and Media Queries</a></p>
<div class="highlight-css"><div class="highlight"><pre><span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">1200px</span><span class="o">)</span> <span class="p">{</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">980px</span><span class="o">)</span> <span class="p">{</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">750px</span><span class="o">)</span> <span class="p">{</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">540px</span><span class="o">)</span> <span class="p">{</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">380px</span><span class="o">)</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>1200, 980, 750, 540, 380の画面MaxWidthで分けている。</p>
<p>これで実装してみたところ1200を超えると、デフォルトの表示に戻ってしまうがレスポンシブになった。</p>
</div>
<div class="section" id="id2">
<h2>関連記事</h2>
<p># デザイナーさんの記事。結構詳しく書いているのでいい感じ。</p>
<ul class="simple">
<li><a class="reference external" href="http://webdesignrecipes.com/web-design-for-mobile-with-css3-media-queries">CSS3 Media Queries を使って、Webサイトをスマートフォンに対応させるときの注意書き</a></li>
</ul>
</div>
<div class="section" id="twitterbootstrap">
<h2>TwitterBootStrapを使う</h2>
<p>ツールに頼るのはいいことだが、いまいち導入の方法がわからない。。。(簡単だと思うのだが。。。)</p>
<p>responsive用のcssがあって、きっとそれを使えばいい。</p>
<p>実装はMediaクエリを使ったもの。以下のサイズで分けられている。</p>
<ul class="simple">
<li>1200px</li>
<li>980px</li>
<li>768px</li>
<li>767px</li>
<li>480px</li>
</ul>
<div class="section" id="id3">
<h3>TwitterBootStrap 入門</h3>
<p>最近入門を果たした。簡単だった。とても簡単にかっこいいデザインを手に入れられた。</p>
<p>マジすごい。</p>
<p>どのように使えるようになったかというと、下記の記事を読んだだけである。</p>
<ul class="simple">
<li><a class="reference external" href="http://php-fan.org/sample_code_demo/bootstrap.html">Twitter Bootstrap使い方-コンポーネント-v2.0.4</a> &lt;- ここが一番良い感じ</li>
<li><a class="reference external" href="http://greenapple-room.com/conc/user/TwitterBootstrap/bootstrap.html">Twitter Bootstrapの使い方</a></li>
<li><a class="reference external" href="http://php-fan.org/sample_code_demo/bootstrap-js.html">Twitter Bootstrap使い方-javascript-v2.0.4</a></li>
</ul>
<p>結局のところ本家のドキュメントを見るのがいいという話になる。</p>
<ul class="simple">
<li><a class="reference external" href="http://twitter.github.io/bootstrap/index.html">Bootstrap</a></li>
</ul>
</div>
</div>
<div class="section" id="id4">
<h2>画像をレスポンシブにする</h2>
</div>
</div>]]></description>
             <pubDate>Mon, 01 Apr 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/29/screen.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/29/screen.html</guid>
            <title><![CDATA[GNU Screen]]></title>
            <description><![CDATA[<div class="section" id="gnu-screen">
<h1>GNU Screen</h1>
<p>tmuxでもbyobuでもないscreenを愛用する。</p>
<div class="section" id="why">
<h2>Why?</h2>
<ol class="arabic simple">
<li>スタンダードな感じがする</li>
<li>気分</li>
<li>簡単に入れれるよ</li>
</ol>
</div>
<div class="section" id="sceenrc">
<h2>.sceenrc</h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># escape</span>
escape ^Tt
escape 
<span class="c"># 256 color</span>
term xterm-256color
<span class="c"># No Visual Bell</span>
vbell on
<span class="c"># AutoDetatch</span>
autodetach on
<span class="c"># Shell</span>
shell /usr/bin/zsh
<span class="c"># divide screen</span>
altscreen on
<span class="c"># Startup Message Off</span>
startup_message off
<span class="c"># For Vim</span>
altscreen on
<span class="c"># HardStatus</span>
<span class="c">#caption always “%{b RK} %y/%m/%d(%D)%c:%s %{bu dr} | %-w%{=bu CK}%n %t%{-}%+w”</span>
hardstatus alwayslastline <span class="s1">'%{=b .y}@%H %-w%{=bu cw}%n:%t%{-}%+w %= %{b .g}%Y/%m/%d %{=b.g}%c:%s'</span>
</pre></div>
</div>
<p>基本的な設定しかない。自分はこれだけで生きていくには十分だ。</p>
<p>キーバインドもそのまま。</p>
<p>VimmerなのでCtrl+hogeのキーバインドに悩む心配もない。</p>
<p>もっとすごいscreenrcを参考にしたいときはgoogle:screenrcをすればいい。</p>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<p>よく使うコマンドをメモφ</p>
<div class="section" id="id1">
<h3>起動</h3>
<dl class="docutils">
<dt># screen</dt>
<dd>普通に起動する</dd>
</dl>
</div>
<div class="section" id="id2">
<h3>起動オプション</h3>
<dl class="docutils">
<dt># screen -ls</dt>
<dd>存在しているセッションの一覧を表示</dd>
<dt># screen -r</dt>
<dd>最後にデタッチしたセッションを起動する</dd>
<dt># screen -a XXX</dt>
<dd>プロセス番号XXXを起動する</dd>
</dl>
</div>
<div class="section" id="id3">
<h3>画面</h3>
<p>Ctrl+a -&gt; ^A
とする、.screenrcでescape ^tTとか書いている人は^T</p>
<dl class="docutils">
<dt>^A + c</dt>
<dd>新しい画面を作る</dd>
<dt>^A + n or p</dt>
<dd>StatusBarに表示された画面間を移動する
nが右へ、pが左へ</dd>
<dt>^A + k</dt>
<dd>現在の画面を破棄する
y/nで聞かれる</dd>
<dt>^A + ^A</dt>
<dd>前回作業していた画面にジャンプ</dd>
<dt>^A + “</dt>
<dd>WindowListの表示。方向キーで選択できる</dd>
</dl>
<p>こっから下はほとんど使ってない。</p>
<dl class="docutils">
<dt>^A + ‘</dt>
<dd>画面の番号を聞かれるので、指定してEnterでジャンプ</dd>
<dt>^A + 数字</dt>
<dd>数字の画面にジャンプ</dd>
<dt>^A + ‘</dt>
<dd>画面の番号を聞かれるので、指定してEnterでジャンプ</dd>
</dl>
</div>
<div class="section" id="id4">
<h3>分割画面</h3>
<p>分割画面作成は、^A+S or ^A+|の後にその画面上で^A+cすると新しくセッションが作成されます。</p>
<p>^A+cをやらないとただの空っぽの画面。</p>
<dl class="docutils">
<dt>^A + S</dt>
<dd>画面を縦分割</dd>
<dt>^A + |</dt>
<dd>画面を横分割します
~A + Vでもできるという説がある。^A + |でできないときはためしてみるといいかも。</dd>
<dt>^A + Tab</dt>
<dd>分割された画面間を移動</dd>
<dt>^A + X</dt>
<dd>分割された画面を破棄する</dd>
</dl>
</div>
<div class="section" id="id5">
<h3>設定ファイル再読み込み</h3>
<dl class="docutils">
<dt>:source $HOME:.screenrc</dt>
<dd>ホームフォルダを示す” ~ “(チルダ)は使えないので注意。</dd>
</dl>
</div>
<div class="section" id="id6">
<h3>ホームフォルダを示すその他</h3>
<dl class="docutils">
<dt>^A + ?</dt>
<dd>ヘルプ</dd>
<dt>^A + [</dt>
<dd>コピーモード</dd>
</dl>
<p>コピーモードはほとんど使ったことがないので便利なのかも分からない。今度使ってみよう。</p>
</div>
</div>
<div class="section" id="gnu-screen-for-mac">
<h2>GNU Screen for Mac</h2>
<p>私の使っているMac OS X 10.6.8にはデフォルトでscreenが入っていた(と思う)。</p>
<p>しかしバージョンが4.0.3と古く、縦分割が出来い。。。</p>
<p>縦分割できないとtmuxに乗り換えてしまいそうなので、最新版をビルドすることに。</p>
<p>screenの最新版はgitリポジトリにある。</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone git://git.savannah.gnu.org/screen.git
</pre></div>
</div>
<p>Macではパッチを当てないとダメっぽい。( 2013/03/29 <a class="reference external" href="http://blog.remora.cx/2012/12/my-recent-screen-env.html">最近の（僕の）GNU Screen 事情 | blog.remora.cx</a> )</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -LO https://raw.github.com/gist/626040/be6a04f0e64c56185ba5850415ac59dad4cd62a0/screen-utf8-nfd.patch
$ cd screen
$ patch -p1 &lt; ../screen-utf8-nfd.patch
$ cd src
$ ./autogen.sh
$ ./configure --prefix=/usr/local --enable-pam --enable-locale --enable-telnet --enable-colors256 --enable-rxvt_osc
$ make &amp;&amp; make install
</pre></div>
</div>
<p>残念ながらこのままでは、./autogen.shあたりでこける。autoconfとautomakeをbrewでインストール。</p>
<div class="highlight-python"><div class="highlight"><pre>$ brew install autoconf
$ brew install automake
</pre></div>
</div>
<p>さらに残念なことにこのままではmakeでこける。</p>
<p><a class="reference external" href="http://d.hatena.ne.jp/cupnes/20130414/1365922107">GNU Screen開発版(4.1.0)でビルド時にエラー - へにゃぺんて＠日々勉強のまとめ</a></p>
<p>この記事を参考にanci.cを修正する。w_がないとかTypo。。。</p>
<p>再びmakeすると成功するのでmake installで4.1.0に更新完了。</p>
<p>Ctrl+a |で立て分割出来る。</p>
</div>
<div class="section" id="id7">
<h2>参考記事</h2>
<dl class="docutils">
<dt><a class="reference external" href="http://yskwkzhr.blogspot.jp/2011/01/gnu-screen.html#windowgroup">これからの「GNU Screen」の話をしよう - Keep It Simple, Stupid</a></dt>
<dd>この記事はかなりすごい。Screen使いこなしてる感がにじみ出ている。
ウィンドウをグループ化することも可能らしい。</dd>
<dt><a class="reference external" href="http://blog.remora.cx/2010/02/gnu-screen.html">最新版GNU Screenで縦分割（その１〜導入編〜） | blog.remora.cx</a></dt>
<dd>ブログ自体がかっこいい。</dd>
<dt><a class="reference external" href="http://blog.remora.cx/2012/12/my-recent-screen-env.html">最近の（僕の）GNU Screen 事情 | blog.remora.cx</a></dt>
<dd>上と同じ人の。</dd>
</dl>
</div>
</div>]]></description>
             <pubDate>Fri, 29 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/25/permutation_python.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/25/permutation_python.html</guid>
            <title><![CDATA[Pythonで順列作成]]></title>
            <description><![CDATA[<div class="section" id="python">
<h1>Pythonで順列作成</h1>
<p>会社の若手でやっている勉強会でこんな問題をみんなで解いてみた。</p>
<div class="highlight-python"><div class="highlight"><pre>問題文
5, 4, 3, 2, 1, 0の６つの整数の間（順番は不変）に
「+, -, *, /, =」の演算子を必ず一回ずつ使い（順番は任意）式が成立するような組み合わせを求めよ
</pre></div>
</div>
<p>開始１０分くらいで、演算子の並びの順列を求めるという問題になり考え始める。</p>
<div class="section" id="itertools">
<h2>itertoolsを使う</h2>
<p>itertoolsというモジュールにpermutationsという関数がある。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>
<span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
</pre></div>
</div>
<p>itertoolsに含まれる関数については以下の記事が詳しくていい。</p>
<p><a class="reference external" href="http://kk6.hateblo.jp/entry/20110521/1305984781">itertoolsモジュールをひと通り眺めてみた - kk6のメモ帳</a></p>
<p>イテレーション処理に便利な関数が多数含まれている。</p>
</div>
<div class="section" id="id1">
<h2>自作する</h2>
<p>アルゴリズムとして作成するにはどうするのか考える。簡単な例から何かしらの法則性を見つけることにする。</p>
<div class="highlight-python"><div class="highlight"><pre>---------------
[1, 2]

-&gt; [1, 2]
-&gt; [2, 1]

2! = 2通り

---------------
[1, 2, 3]

-&gt; [1, 2, 3]
-&gt;    [3, 2]
-&gt; [2, 1, 3]
-&gt;    [3, 1]
-&gt; [3, 2, 1]
-&gt;    [1, 2]

3! = 6通り

---------------
[1, 2, 3, 4]

-&gt; [1 ,2, 3, 4]
-&gt;       [4, 3]
-&gt;    [3, 2, 4]
-&gt;       [4, 2]
-&gt;    [4, 3, 2]
-&gt;       [2, 3]
-&gt; [2, 1, 3, 4]
-&gt; ...

4! = 24通り
</pre></div>
</div>
<p>頭から取り出していって、残り２つになったらくるっとする。</p>
<p>残り２つになったらくるっとするというより、くるっとし続けて出来なくなったら空っぽにして頭をひっくり返す。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">permutation</span><span class="p">(</span><span class="n">li</span><span class="p">):</span>
<span class="k">if</span> <span class="n">li</span> <span class="o">==</span> <span class="p">[]:</span>
  <span class="k">return</span> <span class="p">[[]]</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">return</span> <span class="p">[[</span><span class="n">h</span><span class="p">]</span><span class="o">+</span><span class="n">t</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">li</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">permutation</span><span class="p">(</span><span class="n">li</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">li</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:])]</span>
</pre></div>
</div>
<p>残り２つを意識して作ると、なんか複雑になっていく。</p>
<p>ちょっと視点を変えるのがこんなに大変だとは。。。結構時間かかった。</p>
</div>
<div class="section" id="id2">
<h2>模範解答</h2>
<p>この記事にある問題。模範解答もある。</p>
<p><a class="reference external" href="http://kiroyn.dreamlog.jp/archives/4420564.html">順列生成アルゴリズム - drecom_kiroynのブログ</a></p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">n</span><span class="o">=</span><span class="n">N</span> <span class="o">%</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="c1">//こんなに短いのに辞書順</span>
  <span class="n">N</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">N</span><span class="o">/</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>剰余とか使ってる。なんかかっこいい。</p>
<p>しかし、何かよくわからない。。。</p>
</div>
</div>]]></description>
             <pubDate>Mon, 25 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/20/sqlalchemy.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/20/sqlalchemy.html</guid>
            <title><![CDATA[SQLAlchemy]]></title>
            <description><![CDATA[<div class="section" id="sqlalchemy">
<h1>SQLAlchemy</h1>
<p>Coming Soon...</p>
</div>]]></description>
             <pubDate>Wed, 20 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/19/hg_branch.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/19/hg_branch.html</guid>
            <title><![CDATA[hg Release Branch]]></title>
            <description><![CDATA[<div class="section" id="hg-release-branch">
<h1>hg Release Branch</h1>
<p>今作ってるアプリをリリースしようと思ったが、実は未だにブランチを作成したことすらないのでブランチについてまじめに考えてみようと思う。</p>
<div class="section" id="let-s-branch">
<h2>Let’s Branch</h2>
<img alt="../../../_images/branch1.png" src="http://yymm.bitbucket.org/blog/html/_images/branch1.png"/>
<p>とりあえず、ブランチを作ってみた。</p>
<p>画像はTortoiseHgのWorkbench。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># hg branch hoge</span>
<span class="c"># hg ccmmit -m &quot;to hoge&quot;</span>
<span class="c"># hg update default</span>
<span class="c"># hg commit -m &quot;to default&quot;</span>
</pre></div>
</div>
<p>適当に作っているので、細かいところは気にしない。</p>
<p>作るのは簡単だが、ブランチ作成とは何に使うのか？というところがわからないのでバージョン管理におけるブランチの意味について考えてみる。</p>
</div>
<div class="section" id="branch">
<h2>Branch</h2>
<p>どんな時にブランチができるのか</p>
<ul class="simple">
<li>リリース</li>
<li>他の人にcloneされる</li>
<li>etc</li>
</ul>
<p>1つ目はいつはmasterにマージされる。</p>
<p>2つ目は、pull reauestをすればきっとマージしてくれる。</p>
<p>なんにせよ結局ブランチはマージされる運命にある。</p>
<p>その他にも必要に応じてブランチを作る状況があるかもしれない。知った段階で追記したい。</p>
</div>
<div class="section" id="release-branch">
<h2>Release Branch</h2>
<p>本題のリリースブランチ。</p>
<p># リリースブランチのあり方</p>
<ol class="arabic simple">
<li>ひと通り実装が終わったらリリースブランチを作成(テストはその後)</li>
<li>テストやバグ修正のコミットはリリースブランチに</li>
<li>テスト、バグ修正が終了-&gt;defaultにマージ</li>
<li>リリースブランチの先頭にTagをつける</li>
</ol>
<p>このようなワークフローが一般的なようだ。</p>
<p>GithubやBitbucketにあるリポジトリのコミットログを見たりして勉強するのが一番いいのかもしれない。
(ちらっと見てみた限りだとこんなようなワークフローが多い気が)</p>
<ul class="simple">
<li>この記事を参考 <a class="reference external" href="http://www.eiplab.com/2011/06/git-release-branch">Gitにおけるリリースブランチのつかいかた | EIPラボ</a></li>
<li>ちなみにこの記事は”入門git - オーム社”を参考にしてある</li>
</ul>
<p>hgでは以下のようにtagをつける。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># hg tag hoge</span>
</pre></div>
</div>
</div>
<div class="section" id="function-branch">
<h2>Function Branch</h2>
<p>開発中からブランチを切っていくという発想もある。</p>
<p>新しい機能を実装しようという時にmasterから、その機能実装用にブランチを切ってそこでその機能を作成する。</p>
<p>機能ブランチについてメリット・デメリットを考えてみた。</p>
<p># merit</p>
<ul class="simple">
<li>masterが綺麗なまま保たれる(いつでもリリース可能)</li>
<li>ブランチがマイルストーン的な役割を果たしてくれる</li>
<li>その機能を追加した時の作業分が明確にわかる</li>
</ul>
<p># demerit</p>
<ul class="simple">
<li>機能実装中に他の機能実装依頼があった時困りそう</li>
<li>ブランチを作ることに慣れていない人はめんどい<ul>
<li>今どのブランチにいるとか気にしたことすらないのでどこにコミットしているのかわかんなくなるかもしれない</li>
</ul>
</li>
</ul>
<p># 使う場面</p>
<p>他人のプロジェクトをForkした際に、pull requestを送るとき。</p>
<ol class="arabic simple">
<li>Forkした段階でbranchを切る。</li>
<li>何らかの修正をする</li>
<li>この機能取り入れてほしいな。と思う。</li>
<li>pull requestを送る</li>
<li>branchを切ってあると、どこまで修正してあるのかわかりやすい</li>
<li>branchを取り込めば、pull requestを送った人の環境で簡単にテスト可能</li>
<li>気に入ったら、branchをマージするだけでいい</li>
</ol>
<p>マナー的にpull requestをするときはbranchを切ったほうが良好な人間関係が作れる気がする。</p>
</div>
<div class="section" id="merge">
<h2>Merge</h2>
<p>ブランチといえばマージがついてくる。Conflictがあった時にマージしないといけない。</p>
<p>デフォルトのマージはかなり残念なコトになっているので</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;local
default
==========
ver other
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;other
</pre></div>
</div>
<p>これをいちいちエディタで修正するのは無駄。</p>
<p>Vimmerはhgrcに以下を設定しよう。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">ui</span><span class="p">]</span>
<span class="n">merge</span> <span class="o">=</span> <span class="n">vimdiff</span>
</pre></div>
</div>
<p>vimdiffでは画面が以下のように分割して出現する。</p>
<div class="highlight-python"><div class="highlight"><pre>マージ結果 | local | other
</pre></div>
</div>
<p>マージもしてみた感じはこんなん。</p>
<img alt="../../../_images/branch2.png" src="http://yymm.bitbucket.org/blog/html/_images/branch2.png"/>
<p>私事だが、最近vim .hg/hgrcとして設定をちまちまいじっていたが、~/.hgrcに書けばメシウマということに気づいた。</p>
</div>
<div class="section" id="id1">
<h2>参考記事</h2>
<p># ブランチにもっと詳しくなりたい時</p>
<p>以下の記事を見てみるといいかもしれない</p>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/wyukawa/20101205/1291549247">MercurialとGitのブランチの違い - wyukawa’s blog</a></li>
</ul>
</div>
</div>]]></description>
             <pubDate>Tue, 19 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/18/restructuretext.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/18/restructuretext.html</guid>
            <title><![CDATA[Tinkerer - Sphinx]]></title>
            <description><![CDATA[<div class="section" id="tinkerer-sphinx">
<h1>Tinkerer - Sphinx</h1>
<div class="section" id="restructuredtext">
<h2>reStructuredText</h2>
<p>Sphinxで使われている軽量マークアップ。</p>
<p>Markdownより洗練されている感じ。</p>
<p>ReSTとかRSTとか呼ばれたりしてる。</p>
</div>
<div class="section" id="pygments">
<h2>Pygments</h2>
<p>コードハイライトにはPygmentsが使われています。</p>
<p>Sphinxのドキュメントに詳しく書いてある。</p>
<p><a class="reference external" href="http://sphinx-users.jp/doc10/markup/code.html">コードサンプルの表示 — Sphinx v1.0.6 documentation</a></p>
</div>
<div class="section" id="contents">
<h2>Contents</h2>
<p>Sphinxで目次を付けれる。</p>
<div class="highlight-cpp"><div class="highlight"><pre>.. contents:: 目次のタイトル？
     :depth: 2
</pre></div>
</div>
<p>Sphinxは色々なことを叶えてくれる。</p>
<p><a class="reference external" href="http://sphinx-users.jp/reverse-dict/writing/contents.html">ページ内の目次を作りたい :: ドキュメンテーションツール スフィンクス Sphinx-users.jp</a></p>
</div>
<div class="section" id="rest">
<h2>ReST</h2>
<p>reStructuredTextの基本だけならSphinxのドキュメントにある。</p>
<p><a class="reference external" href="http://sphinx.shibu.jp/rest.html">reStructuredText入門 — Sphinx v1.0 (hg) documentation</a></p>
<p>reStructuredTextについての詳細については日本語全訳があった。</p>
<p><a class="reference external" href="http://www.planewave.org/translations/rst/quickref.html">はやわかり reStructuredText</a></p>
</div>
<div class="section" id="error-report">
<h2>Error Report</h2>
<ul class="simple">
<li>1行目の見出し以外に”=”下線による見出しを作るとエラーが出てtinkerer -bが終了できないので注意。</li>
</ul>
</div>
</div>]]></description>
             <pubDate>Mon, 18 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
        <item>
            <link>http://yymm.bitbucket.org/blog/html/2013/03/18/start_tinkerer.html</link>
            <guid>http://yymm.bitbucket.org/blog/html/2013/03/18/start_tinkerer.html</guid>
            <title><![CDATA[Start Tinkerer]]></title>
            <description><![CDATA[<div class="section" id="start-tinkerer">
<h1>Start Tinkerer</h1>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># pip install tinkerer</span>
<span class="c"># mkdir blog</span>
<span class="c"># cd blog</span>
<span class="c"># tinker -s</span>
<span class="c"># vim conf.py</span>
<span class="c"># tinker -p &quot;hoge&quot;</span>
<span class="c"># vim YYYY/MM/DD/hoge.rst</span>
<span class="c"># tinker -b</span>
<span class="c"># hg init</span>
<span class="c"># vim .hg/hgrc</span>
<span class="c"># hg add .</span>
<span class="c"># hg commit -m 'add hoge'</span>
<span class="c"># hg push</span>
</pre></div>
</div>
<div class="section" id="description">
<h2>Description</h2>
<ul class="simple">
<li><strong>mkdirで作成するフォルダ名は何でもいい</strong></li>
<li><strong>conf.pyの編集</strong></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">tinkerer</span>
<span class="kn">import</span> <span class="nn">tinkerer.paths</span>

    <span class="c"># **************************************************************</span>
    <span class="c"># TODO: Edit the lines below</span>
    <span class="c"># **************************************************************</span>

    <span class="c"># Change this to the name of your blog</span>
    <span class="n">project</span> <span class="o">=</span> <span class="s">'ブログタイトル'</span>

    <span class="c"># Change this to the tagline of your blog</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="s">'タイトルの下に書かれる説明'</span>

    <span class="c"># Change this to the description of your blog</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s">'説明'</span>

    <span class="c"># Change this to your name</span>
    <span class="n">author</span> <span class="o">=</span> <span class="s">'Hoge Hogeo'</span>

    <span class="c"># Change this to your copyright string</span>
    <span class="n">copyright</span> <span class="o">=</span> <span class="s">'2013, '</span> <span class="o">+</span> <span class="n">author</span>

    <span class="c"># Change this to your blog root URL (required for RSS feed)</span>
    <span class="n">website</span> <span class="o">=</span> <span class="s">'http://&lt;username&gt;.bitbucket.org/'</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>BitBucketリポジトリ</strong></li>
</ul>
<p>&lt;username&gt;.bitbucket.org という名前のリポジトリを作っておく必要がある。</p>
<p>.hg/hgrcには、そのリポジトリを参照するようにpathsを書き込む。</p>
<div class="highlight-python"><div class="highlight"><pre>[paths]
default = ssh://hg@bitbucket.org/&lt;username&gt;/&lt;username&gt;.bitbucket.org
</pre></div>
</div>
<ul class="simple">
<li><strong>ビルド</strong></li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># vim YYYY/MM/DD/hoge.rst</span>
<span class="c"># tinker -b</span>
</pre></div>
</div>
<p>記事編集-&gt;Tinkererビルドが記事更新のサイクルになります。</p>
<p>編集途中で内容を確認したいときは、ビルドしてblog/html以下にあるindex.htmlをブラウザで見ればいい。</p>
<p>後は、pushすれば勝手にアップロードされる。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># hg add .</span>
<span class="c"># hg commit -m &quot;edit hoge&quot;</span>
<span class="c"># hg push</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>参考記事</h2>
<p># r_rudiさん</p>
<p>そこはかとなく～はPythonやってる人なら一度は見たことがあるような気がするブログ。</p>
<p><a class="reference external" href="https://github.com/pyspa/pyfes/blob/develop/201303.rst">Python Developers Festa 2013.03</a> のr_rudiさんの発表がTinkererだったのがこのブログを作ろうと思ったそもそもの始まり。</p>
<p>はてブのは旧ブログなのでPowered by Tinkererな新しいブログを参照のこと。 <a class="reference external" href="http://tdoc.info/blog">そこはかとなく書くよん。</a></p>
<ul class="simple">
<li><a class="reference external" href="http://d.hatena.ne.jp/rudi/20120106/1325861293">Tinkererを使ってbitbucketでblogはじめました - そこはかとなく書くよ。</a></li>
<li><a class="reference external" href="http://r_rudi.bitbucket.org/blog/html/2012/01/04/blogging_using_tinkerer_on_bitbucket.html">Blogging using tinkerer on bitbucket — Sokohaka</a></li>
</ul>
<p># Else</p>
<ul class="simple">
<li><a class="reference external" href="http://blog.shomah4a.net/2013/02/26/setup_tinkerer.html">Tinkererを使ってブログを作るまでのメモ プログラマのネタ帳 二冊目</a></li>
<li><a class="reference external" href="http://akirakw.github.com/2012/09/12/create_blog_with_tinkerer.html">TinkererでSphinxなブログ環境を構築する — An Artisan’s Build Act</a></li>
<li><a class="reference external" href="http://yosisa.github.com/blog/2012/02/21/sphinx_blog_using_tinkerer_and_github.html">Tinkerer と GitHub ではじめる Sphinx blog — log.randomly</a></li>
<li><a class="reference external" href="http://pekopeko1.bitbucket.org/blog/html/2012/11/25/getting_start.html">はじめにーTinkererの使い方 — ぼくのかんがえたさいきょうの</a></li>
</ul>
</div>
</div>]]></description>
             <pubDate>Mon, 18 Mar 2013 00:00:00 +0900</pubDate>
        </item>
    
    </channel>
</rss>